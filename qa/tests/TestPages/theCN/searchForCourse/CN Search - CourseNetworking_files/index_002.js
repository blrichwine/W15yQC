/**
 * jquery.Jcrop.min.js v0.9.12 (build:20130202)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2013 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */

define("tools/view/search",["jquery","underscore"],function(e,t){return function(){return{defaults:{type:"all",keyword:""},encodeURIComponent:function(n){var i=e.extend({},this.defaults,n),o={};return t.each(i,function(e,t){o[t]=e?encodeURIComponent(e):""}),o},decodeURIComponent:function(n){var i=e.extend({},this.defaults,n),o={};return t.each(i,function(e,t){o[t]=e?decodeURIComponent(e):""}),o}}}()}),define("text!templates/common/home-head/search-box.html",[],function(){return'<input class="search_input always_allow" type="text" placeholder="Search..." />\r\n<a id="search_bt" class="text-hide bt-search always_allow" href="javascript:;">Search</a>'}),define("views/common/home-head/search-box",["jquery","underscore","backbone","controller","tools/view/search","text!templates/common/home-head/search-box.html"],function(e,t,n,i,o,r){return n.View.extend({className:"block-search",template:r,events:{"keypress .search_input":"enterSearch","click #search_bt":"search"},enterSearch:function(e){13==e.keyCode&&this.search()},search:function(){var e=this.$(".search_input").val(),t=o.encodeURIComponent({keyword:e});return i.go("search",t.type,"keyword",t.keyword),!1}})}),define("modules/course/course",["jquery","underscore","backbone","tools/string-help"],function(e,t,n,i){return n.Model.extend({urlRoot:"api/course/",defaults:function(){return t.extend({type:"school_based",name:"",country_id:"",school_id:"",level:1,course_category_name:"",start_course_date:"",end_course_date:"",access_setting_id:"open",logo_url:"img/common/avatar/logo/default.png",country:{id:""},user_position:"",school:{url:""},instructors:[],instructional_users:[],user_score:{sub_total:0},create_from:"",tasks:[],allow_mooc:!1,enable_mooc:!1,is_end:!1},this.defaults_())},defaults_:function(){},initDefaults:function(){var n=this,o=["instructor","creater","assistant","coordinator","teaching_assistant","graduate_assistant","external_reviewer","instructional_designer","librarian"],r=n.get("user_score");r=t.extend(r,{display_sub_total:i.addCommas(r.sub_total)});var a={user_score:r},s=this.get("school");t.isString(s.url)&&s.url.length>0&&(s.url="http://"+s.url.replace(/http:\/\//,""));var l=e.inArray(n.get("user_position"),o)>-1,c=this.get("name");return t.extend({display_name:c,access_setting_string:n.displayAccessSetting(n.get("access_setting_id")),school:s,has_task:n.get("tasks").length>0,has_join:n.get("user_position").length>0,has_instructor:n.get("instructors").length>0,display_instructors_string:n.getDisplayInstructorsString(),has_instructional_users:n.get("instructional_users").length>0,can_manager:l,display_user_position:n.displayUserPosition(n.get("user_position")),display_user_position_sentence:n.displayUserPositionSentence(n.get("user_position")),is_open_type:"open"===n.get("access_setting_id"),is_email_type:"email"===n.get("access_setting_id"),is_code_type:"code"===n.get("access_setting_id"),is_no_one_type:"no_one"===n.get("access_setting_id"),is_fee_type:"fee"===n.get("access_setting_id"),is_not_available:!n.get("is_start")&&!n.get("is_end"),has_auth_read:n.get("user_position").length>0||"open"===n.get("access_setting_id"),can_invite:n.get("enable_mooc")||l},a)},getDisplayInstructorsString:function(){var e=this.get("instructors"),t="";if(e.length>0)for(var n in e)t+=e[n].display_name+", ";return t.substr(0,t.lastIndexOf(","))},initDefaults_:function(){},displayUserPosition:function(e){var t={instructor:"Instructor",student:"Student",coordinator:"Course Coordinator",teaching_assistant:"Teaching Assistant",graduate_assistant:"Graduate Assistant",external_reviewer:"External Reviewer",instructional_designer:"Instructional Designer",librarian:"Librarian",observer:"Observer"};return t[e]?t[e]:"Member"},displayUserPositionSentence:function(e){var t={instructor:"You're an Instructor in this Course",student:"You're a Student in this Course",coordinator:"You're a Course Coordinator in this Course",teaching_assistant:"You're a Teaching Assistant in this Course",graduate_assistant:"You're a Graduate Assistant in this Course",external_reviewer:"You're an External Reviewer in this Course",instructional_designer:"You're an Instructional Designer in this Course",librarian:"You're a Librarian in this Course",observer:"You're an Observer in this Course"};return t[e]?t[e]:"You're an Member in this Course"},displayAccessSetting:function(e){var t={code:"PIN",email:"Email request",no_one:"No one",open:"Any CN member"};return t[e]?t[e]:""}})}),define("collections/course/user-collection",["jquery","underscore","backbone","modules/course/course"],function(e,t,n,i){return n.Collection.extend({model:i,urlRoot:"api/user_course/",comparator:function(e){var n=e.get("display_name");return t.first(n.toLowerCase().split(""))}})}),define("modules/conexus/conexus",["jquery","underscore","backbone","tools/string-help"],function(e,t,n,i){return n.Model.extend({urlRoot:"api/conexus/",defaults:function(){return{name:"",country_id:"",about:"",logo_attachment_id:"",logo_url:"img/common/avatar/conexus/default.png",country:{id:""},user_position:"",moderators:[],user_score:{sub_total:0},is_end:!1,is_open_type:!0}},initDefaults:function(){var n=this,o=["moderator","creater"],r=n.get("user_score");r=t.extend(r,{display_sub_total:i.addCommas(r.sub_total)});var a={user_score:r};return t.extend({display_name:n.get("name"),has_join:n.get("user_position").length>0,has_moderator:n.get("moderators").length>0,can_manager:e.inArray(n.get("user_position"),o)>-1,display_user_position:n.get("user_position").ucfirst(),is_new:n.isNew(),display_user_sub_total:i.addCommas(n.get("user_score").sub_total),display_moderators_string:n.getDisplayModeratorsString()},a)},getDisplayModeratorsString:function(){var e=this.get("moderators"),t="";if(e.length>0)for(var n in e)t+=e[n].display_name+", ";return t.substr(0,t.lastIndexOf(","))},validateFields:function(){var e=[],t=this.validateName();t&&e.push(t);var n=this.validateCountry();return n&&e.push(n),{errors:e,result:!e.length}},validateName:function(){var e=this.get("name");return t.isUndefined(e)||!e.length?"Please input Conexus name.":void 0},validateCountry:function(){var e=this.get("country_id");return t.isUndefined(e)||!e.length?"Please select your country.":void 0}})}),define("views/common/home-head/master-menu/item",["jquery","underscore","backbone","modules/course/course","modules/conexus/conexus"],function(e,t,n,i,o){return n.View.extend({tagName:"li",initialize:function(){var e="",t="";this.model instanceof i&&(t="course",e=this.model.get("course_id")),this.model instanceof o&&(t="conexus",e=this.model.get("conexus_id"));var n=this.model.get("display_name"),r=this.model.get("can_manager")?'<a class="icon-img-1-edit-gray  r-float" href="'+t+"/edit/"+e+'">Edit</a>':"",a=r.length>0?"edit-side":"";this.$el.html('<a class="text l-float '+a+'" href="'+e+'" title="'+n+'">'+n+"</a>"+r+'<div class="clear"></div>')}})}),define("text!templates/common/loading/view.html",[],function(){return'<img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n'}),define("views/common/loading/view",["jquery","underscore","backbone","text!templates/common/loading/view.html"],function(e,t,n,i){return n.View.extend({className:"block-loading block-horizontal-loading",template:i})}),define("views/common/home-head/master-menu/list",["jquery","underscore","backbone","views/common/home-head/master-menu/item","views/common/loading/view"],function(e,t,n,i){return n.View.extend({className:"list-two",tagName:"ol",initialize:function(){t.bindAll(this,"addAll","addOne"),this.collection.on("fetch",this.addAll,this),this.collection.on("add",this.addOne,this),this.collection.trigger("fetch")},addAll:function(){this.$el.empty(),this.collection.each(this.addOne)},addOne:function(e){this.$el.append(new i({model:e}).render().view.el)}})}),define("text!templates/common/home-head/master-menu/main.html",[],function(){return'<div class="head _head">\r\n\r\n</div>\r\n<div class="main _main">\r\n\r\n</div>\r\n<div class="foot _foot">\r\n    \r\n</div>'}),define("views/common/home-head/master-menu/main",["jquery","underscore","backbone","views/common/home-head/master-menu/list","views/common/loading/view","collections/course/user-collection","text!templates/common/home-head/master-menu/main.html"],function(e,t,n,i,o,r,a){return n.View.extend({className:"block-wrap-club-list",template:a,afterRender:function(){var e=this;this.$("._main").html((new o).render().view.el),this.collection.addUrlParam({limit:999}),this.collection.fetch({silent:!0,resultTrue:function(n){e.$("._main").empty();var o=n.groupBy(function(e){return e.get("is_end")}),a=o["false"],s=o["true"];t.isArray(a)&&a.length>0&&e.$("._head").html(new i({collection:new r(a)}).render().view.el),t.isArray(s)&&s.length>0&&(e.$("._main").html("----------  Ended  ----------"),e.$("._foot").html(new i({collection:new r(s)}).render().view.el))},resultFalse:function(n){var i="";t.each(n,function(e){i+=e+"<br />"}),e.$el.html(i)}})}})}),define("text!templates/common/home-head/master-menu-my-courses.html",[],function(){return'<div class="head">\n    <h4>My Courses</h4>\n</div>\n<div class="main">\n    <ul class="list-one">\n        <li>\n            <a href="course/create">Create a Course</a>\n        </li>\n        <li>\n            <a href="search/course">Search for Course</a>\n        </li>\n    </ul>\n    <div class="list-wrap">\n        <div class="main" id="block_master_menu_course_list">\n            <div class="block-loading block-horizontal-loading">\n                <img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("views/common/home-head/master-menu-my-courses",["jquery","underscore","backbone","collections/course/user-collection","views/common/home-head/master-menu/main","text!templates/common/home-head/master-menu-my-courses.html"],function(e,t,n,i,o,r){return n.View.extend({className:"block-master-menu-my-courses",template:r,beforeRender:function(){this.setViews({"#block_master_menu_course_list":new o({collection:new i,type:"courses"})})}})}),define("text!templates/common/home-head/master-menu-my-settings.html",[],function(){return'<div class="head">\n    <h4>Settings</h4>\n</div>\n<div class="main">\n    <ul>\n        <li>\n            <a class="" href="user/courses">My Courses</a>\n        </li>\n        <li>\n            <a class="" href="user/conexus">My Conexus</a>\n        </li>\n    </ul>\n    <ul>\n        <li>\n            <a class="" href="course/create">Create a Course</a>\n        </li>\n        <li>\n            <a class="" href="conexus/create">Create a Conexus</a>\n        </li>\n    </ul>\n    <ul>\n        <li>\n            <a href="user/settings">Email Notifications</a>\n        </li>\n        <li>\n            <a class="" href="user/password">Change Password</a>\n        </li>\n        <li>\n            <a class="" href="user/edit">Edit Profile</a>\n        </li>\n    </ul>\n    <ul>\n        <li>\n            <a id="logout" class="" href="user/logout">Logout</a>\n        </li>\n    </ul>\n</div>\n'}),define("views/common/home-head/master-menu-my-settings",["jquery","underscore","backbone","text!templates/common/home-head/master-menu-my-settings.html"],function(e,t,n,i){return n.View.extend({className:"block-master-menu-my-settings",template:i})}),define("tools/auto-close-element-window",["jquery"],function(e){return function(t,n,i){var o="data-autoclose-status";e(n).hover(function(){e(this).attr(o,"in")},function(){e(this).attr(o,"out")});var r=function(){setTimeout(function(){e(document).one("click",function(){"in"!=e(n).attr(o)&&("function"==typeof i?i.call(e(n)):e(n).remove())})},100)};r(),e(n).click(function(){r()}),t&&t.stopPropagation()}}),define("text!templates/common/float-box/_master.html",[],function(){return'<span class="text-hide arrow icon-float-tip-arrow">Arrow</span>\n<a class="text-hide bt-close-17 hide_float_box always_allow" href="javascript:;" title="close">Close</a>\n<div class="main">\n    <div class="center">\n\n    </div>\n</div>'}),define("views/common/float-box/_master",["jquery","underscore","backbone","tools/auto-close-element-window","text!templates/common/float-box/_master.html"],function(e,t,n,i,o){return n.View.extend({className:"block float-box",template:o,initialize:function(n){t.bindAll(this,"initialize_","beforeRender_","afterRender_");var i={arrow:{direction:"top",width:16},delay:"",display:{style:"show",afterShow:function(){},afterClose:function(){},showSpeed:1,closeSpeed:1},extraCss:{},isBindButtonElement:!1},n=n||{};this.options=e.extend(!0,i,n),this.initialize_(this.options)},initialize_:function(){},serialize:function(){},events:{"click .hide_float_box":"close"},beforeRender:function(){this.options.view&&"string"!=typeof this.options.view&&(this.setViews({".center":this.options.view}),this.beforeRender_())},beforeRender_:function(){},afterRender:function(){var t=this;this.options.view&&"string"==typeof this.options.view&&this.$(".center").html(this.options.view),t.setWrapPosition();var n=0,i=function(){setTimeout(function(){this.$(".arrow").length>0?t.setArrowPosition():100>n&&(++n,i())},10)};i(),e(window).resize(function(){t.setWrapPosition()}),e(window).keydown(function(e){27===e.keyCode&&t.close()}),this.options.delay&&setTimeout(function(){t.setWrapPosition()},this.options.delay),this.afterRender_()},afterRender_:function(){},getArrowPosition:function(){var e=this.options.arrow.direction,t=this.$(".arrow"),n=t.position(),i=this.options.arrow||{};return"top"===e?{top:i.top===void 0?n.top:n.top+i.top,left:i.offset===void 0?n.left:n.left+i.offset}:"left"===e?{top:i.offset===void 0?n.top:n.top+i.offset,left:i.left===void 0?n.left:n.left+i.left}:"right"===e?{top:i.offset===void 0?n.top:n.top+i.offset,right:i.left===void 0?n.left:n.left+i.left}:void 0},setArrowPosition:function(){this.$(".arrow").css(this.getArrowPosition())},getWrapPosition:function(){var t=this.options.arrow.width,n=this.options.arrow.height,i=this.options.arrow.direction,o=e(this.options.target),r=o.width(),a=o.height(),s=o.offset(),l=this.options.arrow||{};if("top"===i)return{top:l.top===void 0?s.top+a:s.top+a+l.top,left:l.offset===void 0?s.left+r/2-t/2:s.left+r/2-t/2-l.offset};if("left"===i){t=8,n=16;var c=8;return{top:l.offset===void 0?s.top-c:s.top-c-l.offset,left:l.left===void 0?s.left+r+t:s.left+r+t+l.left}}if("right"===i){t=8,n=16;var c=8,d=e(window).width();return{top:l.offset===void 0?s.top-c:s.top-c-l.offset,right:l.left===void 0?d-s.left+t-8:d-s.left+t-8+l.left}}},setWrapPosition:function(){this.$el.css(e.extend(!0,{},this.getWrapPosition(),this.options.extraCss))},initShow:function(t){var n=this;"show"===n.options.display.style?e(t).show(n.options.display.showSpeed,function(){"function"==typeof n.options.display.afterShow&&n.options.display.afterShow()}):"fade"===n.options.display.style?e(t).fadeIn(n.options.display.showSpeed,function(){"function"==typeof n.options.display.afterShow&&n.options.display.afterShow()}):"slide"===n.options.display.style&&e(t).slideDown(n.options.display.showSpeed,function(){"function"==typeof n.options.display.afterShow&&n.options.display.afterShow()})},initClose:function(t){var n=this;"show"===n.options.display.style?e(t).hide(n.options.display.closeSpeed,function(){"function"==typeof n.options.display.afterClose&&n.options.display.afterClose()}):"fade"===n.options.display.style?e(t).fadeOut(n.options.display.closeSpeed,function(){"function"==typeof n.options.display.afterClose&&n.options.display.afterClose()}):"slide"===n.options.display.style&&e(t).slideUp(n.options.display.closeSpeed,function(){"function"==typeof n.options.display.afterClose&&n.options.display.afterClose()})},show:function(t){var n=this;if(e(n.options.target).length>0&&!e(n.options.target).attr("locked")){var o=n.options.isBindButtonElement?t:"",r=this.render().view;n.viewElement=r.$el,e(n.options.target).attr("locked","locked"),e(n.viewElement).hide(),e("#wrapper").append(e(n.viewElement)),n.initShow(n.viewElement),i(o,r.$el,function(){n.close()})}},close:function(){var t=this;this.initClose(t.viewElement),e(t.options.target).removeAttr("locked"),setTimeout(function(){t.remove()},300)}})}),define("text!templates/common/home-head/master-menu.html",[],function(){return'<div class="item item-course">\r\n    <div class="title">\r\n        <a class="show_my_courses icon-arrow-down sub-menu sub-course always_allow" href="javascript:;">\r\n            Courses\r\n        </a>\r\n    </div>\r\n</div>\r\n<div class="item">\r\n    <div class="title">\r\n        <a href="user">\r\n            Home\r\n        </a>\r\n    </div>\r\n</div>\r\n<div class="item item-settings">\r\n    <div class="title">\r\n        <a class="show_my_settings icon-arrow-down sub-menu sub-set always_allow" href="javascript:;">\r\n            {{display_name}}\r\n        </a>\r\n    </div>\r\n</div>\r\n<div class="clear"></div>'}),define("views/common/home-head/master-menu",["jquery","underscore","backbone","views/common/home-head/master-menu-my-courses","views/common/home-head/master-menu-my-settings","views/common/float-box/_master","text!templates/common/home-head/master-menu.html"],function(e,t,n,i,o,r,a){return n.View.extend({className:"block-master-menu",template:a,events:{"click .show_my_courses":"showMyCourses","click .show_my_settings":"showMySettings"},initialize:function(){},serialize:function(){return this.model.toJSON()},showMyCourses:function(e){new r({view:new i,target:e.currentTarget,arrow:{offset:35},extraCss:{"z-index":99,position:"fixed",top:35},display:{style:"slide",showSpeed:"normal",closeSpeed:"normal"}}).show(e)},showMySettings:function(e){new r({view:new o,target:e.currentTarget,arrow:{offset:100},extraCss:{"z-index":99,position:"fixed",top:35},display:{style:"slide",showSpeed:"normal",closeSpeed:"normal"}}).show(e)}})}),define("tools/auto-close-view-window",["jquery"],function(e){return function(t,n,i){var o="data-autoclose-status";n.$el.hover(function(){e(this).attr(o,"in")},function(){e(this).attr(o,"out")});var r=function(){setTimeout(function(){e(document).one("click",function(){"in"!=n.$el.attr(o)&&("function"==typeof i?i.call(n):n.remove())})},100)};r(),n.$el.click(function(){r()}),t&&t.stopPropagation()}}),define("text!templates/common/home-head/alert-box/item/chat/item.html",[],function(){return'{{#actor}}\n<div class="l-float avatar-wrap">\n    <a class="show_avatar link_bypass" href="{{avatar.view_url}}">\n        <img src="{{avatar.view_url}}" alt="{{display_name}}" width="34px" />\n    </a>\n    <a class="web-id" href="{{cn_number}}">{{cn_number}}</a>\n</div>\n<div class="l-float message-wrap">\n    <div class="main">\n        <div class="center">\n            <a href="{{cn_number}}">{{display_name}}</a> wants to chat with you.\n        </div>\n        <div class="bottom">\n            <span>{{display_time}}</span>\n        </div>\n    </div>\n    <div class="foot">\n        <a class="bt bt-gray bt-disagree r-float chat_clear" href="javascript:;">CLEAR</a>\n        <a class="bt bt-blue r-float load_send_email_window chat_clear" href="javascript:;" data-id="{{id}}">EMAIL</a>\n        <div class="clear"></div>\n    </div>\n</div>\n<div class="clear"></div>\n{{/actor}}\n{{^actor}}\n    <div>\n        Actor is not exist.\n    </div>\n{{/actor}}'}),define("views/common/home-head/alert-box/chat/items/normal",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/item/chat/item.html"],function(e,t,n,i){return n.View.extend({template:i,tagName:"li",events:{"click .chat_clear":"clear"},initialize:function(){this.model.view=this},serialize:function(){return this.model.toJSON()},clear:function(){var e=this;this.model.check({afterCheck:function(){e.model.collection.remove(e.model.get("id")),e.model.view.remove()}})}})}),define("text!templates/common/home-head/alert-box/no-message.html",[],function(){return'<div class="message-wrap">\n    <div class="main">\n        <div class="no-message">\n            {{message}}\n        </div>\n    </div>\n</div>'}),define("views/common/home-head/alert-box/no-message",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/no-message.html"],function(e,t,n,i){return n.View.extend({template:i,tagName:"li",initialize:function(t){var n="There are no messages.";t&&"string"==e.type(t.message)&&(n=t.message),this.message=n},serialize:function(){var e=this;return{message:e.message}}})}),define("modules/message-system/email",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/email/",check:function(t){var n=this;this.save({status:"read"},{resultTrue:function(){n.view.remove(),"function"===e.type(t)&&t()}})}})}),define("modules/message-system/chat-miss",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/chat_miss/",check:function(e){var n=this;this.save({mark:"read"},{resultTrue:function(){n.view.remove(),e&&t.isFunction(e.afterCheck)&&e.afterCheck()}})},deleted:function(e){var n=this;this.destroy({resultTrue:function(){n.view.remove(),e&&t.isFunction(e.afterDeleted)&&e.afterDeleted()}})}})}),define("modules/message-system/user-notification",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/user_notification/",check:function(e){var n=this;this.save({mark:"read"},{resultTrue:function(){n.view.remove(),e&&t.isFunction(e.afterCheck)&&e.afterCheck()}})},deleted:function(e){var n=this;this.destroy({resultTrue:function(){n.view.remove(),e&&t.isFunction(e.afterDeleted)&&e.afterDeleted()}})}})}),define("modules/user/user-colleague",["jquery","underscore","modules/user/user"],function(e,t,n){return n.extend({urlRoot:"api/user_colleague/"})}),define("modules/message-system/user-colleague",["jquery","underscore","modules/user/user-colleague"],function(e,t,n){return n.extend({urlRoot:"api/user_colleague/",setDefaults:function(){this.has("model")&&this.set(this.get("model"))}})}),define("collections/message-system/message-system-collections",["jquery","underscore","backbone","modules/message-system/email","modules/message-system/chat-miss","modules/message-system/user-notification","modules/message-system/user-colleague"],function(e,t,n,i,o,r,a){var s=n.Collection.extend({urlRoot:"api/email/",model:i,clearAll:function(e){var n=this,o=new i({id:""});o.save({status:"read"},{resultTrue:function(){n.reset(),t.isFunction(e)&&e()}})}}),l=n.Collection.extend({urlRoot:"api/user_colleague_request/",model:a}),c=n.Collection.extend({urlRoot:"api/user_notification/",model:r,clearAll:function(e){var n=this,i=new r({id:""});i.save({mark:"read"},{resultTrue:function(){n.reset(),t.isFunction(e)&&e()}})}}),d=n.Collection.extend({urlRoot:"api/chat_miss/",model:o,clearAll:function(e){var n=this,i=new o({id:""});i.save({mark:"read"},{resultTrue:function(){n.reset(),t.isFunction(e)&&e()}})}}),u={EmailMessages:s,ColleagueMessages:l,NotificationMessages:c,ChatMessages:d};return{get:function(e){return u[e]}}}),define("text!templates/common/home-head/alert-box/index/chat.html",[],function(){return'    <span class="text-hide icon-float-tip-arrow">\r\n        Arrow\r\n    </span>\r\n    <a class=" text-hide bt-close-17 close_box" href="javascript:;" title="close">\r\n        Close\r\n    </a>\r\n	<div class="main">\r\n		<div class="top">\r\n			<h4 class="l-float">\r\n				<span class="">Missing Chat Requests</span>\r\n			</h4>\r\n            <div class="clear"></div>\r\n		</div>\r\n		<div class="center block_opera_wrap">\r\n			<ul id="block_alert_box_chat_list" class="_list">\r\n				<li>\r\n                    <div class="block-loading block-horizontal-loading block_loading">\r\n                        <img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n                    </div>\r\n                </li>\r\n			</ul>\r\n		</div>\r\n	</div>\r\n'}),define("text!templates/common/home-head/alert-box/item/chat/opera-wrap.html",[],function(){return'{{#number}}\n    <a id="alert_box_chat_clear_all" class="l-float" href="javascript:;">Clear All</a>\n{{/number}}\n<a class="r-float" href="user/chat">Show History</a>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/chat/index",["jquery","underscore","backbone","tools/pop-up-window","views/common/home-head/alert-box/chat/items/normal","views/common/home-head/alert-box/no-message","collections/message-system/message-system-collections","text!templates/common/home-head/alert-box/index/chat.html","text!templates/common/home-head/alert-box/item/chat/opera-wrap.html"],function(e,t,n,i,o,r,a,s,l){var c=i.get("function"),d=a.get("ChatMessages"),u=n.View.extend({template:l,className:"opera-wrap opera_wrap",events:{"click #alert_box_chat_clear_all":"clearAll"},initialize:function(e){this.model.on("change",this.render,this),this.parent=e.parent},serialize:function(){return this.model.toJSON()},clearAll:function(){var e=this;c.confirm({content:"Are you sure to clear all of the chats?",yesCallBack:function(){e.collection.clearAll(function(){e.parent.deleted(),e.model.set({number:0})})}})}});return n.View.extend({template:s,className:"body block-float-down-box block-float-down-left-box block-alert-float-box",events:{"click .close_box":"deleted"},initialize:function(e){t.bindAll(this,"addAll","addOne","removeOne"),this.collection=new d,this.collection.on("all",this.refresh,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),this.collection.on("remove",this.checkIsEmpty,this),this.parent=e.parent},afterRender:function(){var e=this,t=new u({model:this.model,collection:this.collection,parent:e});this.$("#block_alert_box_chat_list").before(t.render().view.el),this.collection.addUrlParam({with_chat_miss_user:1,mark:"unread"}),this.collection.fetch({resultFalse:function(){e.refresh()}})},addOne:function(e){var t=new o({model:e});this.$("._list").append(t.render().view.el)},deleted:function(){this.remove()},checkIsEmpty:function(){this.collection.isEmpty()&&this.remove()},refresh:function(){if(this.collection.isEmpty()){var e=new r({message:"There are no new chat requests."});this.$("._list").empty().append(e.render().view.el)}else this.$(".opera_wrap").show();this.model.set({number:this.collection.length})},addAll:function(){this.$("._list").empty(),this.collection.each(this.addOne)},removeOne:function(){this.model.sub(1)}})}),define("text!templates/common/home-head/alert-box/new-message-count.html",[],function(){return"{{number}}\n"}),define("views/common/home-head/alert-box/count",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/new-message-count.html"],function(e,t,n,i){return n.View.extend({tagName:"b",template:i,serialize:function(){return this.model.toJSON()}})}),define("text!templates/common/home-head/alert-box/button/chat.html",[],function(){return'<div class="head _head">\n    <a class="text-hide icon-alert icon-alert-chat load_message always_allow" href="javascript:;" data-type="chat" >\n        chat\n    </a>\n    <div class="alert-box-item-count-wrap alert_box_item_count_wrap">\n        \n    </div>\n</div>\n<div class="main chat-main _main">\n\n</div>\n'}),define("views/common/home-head/alert-box/chat/button",["jquery","underscore","backbone","tools/auto-close-view-window","views/common/home-head/alert-box/chat/index","views/common/home-head/alert-box/count","modules/message-system/message-count-chat","text!templates/common/home-head/alert-box/button/chat.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({className:"item _item",template:s,events:{"click .load_message":"loadMessage"},initialize:function(){t.bindAll(this,"refresh"),this.model=a,this.model.on("change",this.refresh,this)},afterRender:function(){this.refresh()},loadMessage:function(t){var n=this,r=e(t.currentTarget),a=r.closest("#block_head");a.find("._main, ._box").fadeOut(),this.$("._item ._main").empty();var s=new o({parent:n,model:this.model});r.closest("._item").find("._main").hide().html(s.render().view.el).fadeIn(),i(t,s)},refresh:function(){if(this.model.get("number")){var e=new r({model:this.model});this.$("._head .alert_box_item_count_wrap").html(e.render().view.el).fadeIn()}else this.$("._head .alert_box_item_count_wrap").fadeOut()}})}),define("text!templates/common/home-head/alert-box/item/colleague/item.html",[],function(){return'<div class="l-float avatar-wrap">\n    <a class="show_avatar link_bypass" href="{{avatar.view_url}}">\n        <img src="{{avatar.view_url}}" alt="{{display_name}}" width="34px" />\n    </a>\n    <a class="web-id" href="{{cn_number}}">{{cn_number}}</a>\n</div>\n<div class="l-float message-wrap">\n    <div class="main">\n        <div class="center">\n            <a href="{{cn_number}}">{{display_name}}</a> wants to add you as a colleague.\n        </div>\n        <div class="bottom">\n            <span>{{display_time}}</span>\n        </div>\n    </div>\n    <div class="foot">\n        <a class="bt bt-gray bt-disagree r-float colleague_reject" href="javascript:;">Reject</a>\n        <a class="bt bt-blue bt-agree r-float colleague_accept" href="javascript:;">Accept</a>\n        <div class="clear"></div>\n    </div>\n</div>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/request/items/normal",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/item/colleague/item.html"],function(e,t,n,i){return n.View.extend({template:i,tagName:"li",events:{"click .colleague_accept":"accept","click .colleague_reject":"reject"},initialize:function(e){this.model=e&&t.has(e,"model")?e.model:new ColleagueMsgModel,this.model.view=this},serialize:function(){return this.model.toJSON()},accept:function(){this.model.addUrlParam({status:1}),this.model.save([],{resultTrue:function(e){e.collection.remove(e.get("id")),e.view.remove()}})},reject:function(){this.model.addUrlParam({status:0}),this.model.save([],{resultTrue:function(e){e.collection.remove(e.get("id")),e.view.remove()}})}})}),define("text!templates/common/home-head/alert-box/index/colleague.html",[],function(){return'    <span class="text-hide icon-float-tip-arrow">\r\n        Arrow\r\n    </span>\r\n    <a class=" text-hide bt-close-17 close_box" href="javascript:;" title="close">\r\n        Close\r\n    </a>\r\n	<div class="main">\r\n		<div class="top">\r\n			<h4 class="new_count">\r\n				<span>New Colleague Requests</span>\r\n			</h4>\r\n		</div>\r\n		<div class="center">\r\n			<ul id="block_alert_box_colleague_list" class="_list">\r\n                <li>\r\n                    <div class="block-loading block-horizontal-loading block_loading">\r\n                        <img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n                    </div>\r\n                </li>\r\n			</ul>\r\n		</div>\r\n	</div>\r\n'}),define("views/common/home-head/alert-box/request/index",["jquery","underscore","backbone","views/common/home-head/alert-box/request/items/normal","views/common/home-head/alert-box/no-message","collections/message-system/message-system-collections","text!templates/common/home-head/alert-box/index/colleague.html"],function(e,t,n,i,o,r,a){var s=r.get("ColleagueMessages");return n.View.extend({template:a,className:"body block-float-down-box block-float-down-left-box block-alert-float-box",events:{"click .close_box":"deleted"},initialize:function(e){t.bindAll(this,"addAll","addOne","removeOne"),this.collection=new s,this.collection.on("all",this.refresh,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),this.collection.on("remove",this.checkIsEmpty,this),this.parent=e.parent},afterRender:function(){var e=this;this.collection.fetch({resultFalse:function(){e.refresh()}})},addOne:function(e){var t=new i({model:e});this.$("._list").append(t.render().view.el)},deleted:function(){this.remove()},checkIsEmpty:function(){this.collection.isEmpty()&&this.remove()},refresh:function(){if(this.collection.isEmpty()){var e=new o({message:"There are no new colleague requests."});
this.$("._list").empty().append(e.render().view.el)}else this.$(".opera_wrap").show();this.model.set({number:this.collection.length})},addAll:function(){this.$("._list").empty(),this.collection.each(this.addOne)},removeOne:function(){this.model.sub(1)}})}),define("text!templates/common/home-head/alert-box/button/colleague.html",[],function(){return'<div class="head _head">\n    <a class="text-hide icon-alert icon-alert-colleague load_message always_allow" href="javascript:;" data-type="request" >\n        colleague\n    </a>\n    <div class="alert-box-item-count-wrap alert_box_item_count_wrap">\n        \n    </div>\n</div>\n<div class="main colleague-main _main">\n\n</div>\n'}),define("views/common/home-head/alert-box/request/button",["jquery","underscore","backbone","tools/auto-close-view-window","views/common/home-head/alert-box/request/index","views/common/home-head/alert-box/count","modules/message-system/message-count-request","text!templates/common/home-head/alert-box/button/colleague.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({className:"item _item",template:s,events:{"click .load_message":"loadMessage"},initialize:function(){t.bindAll(this,"refresh"),this.model=a,this.model.on("change",this.refresh,this)},afterRender:function(){this.refresh()},loadMessage:function(t){var n=this,r=e(t.currentTarget),a=r.closest("#block_head");a.find("._main, ._box").fadeOut(),this.$("._item ._main").empty();var s=new o({parent:n,model:this.model});r.closest("._item").find("._main").hide().html(s.render().view.el).fadeIn(),i(t,s)},refresh:function(){if(this.model.get("number")){var e=new r({model:this.model});this.$("._head .alert_box_item_count_wrap").html(e.render().view.el).fadeIn()}else this.$("._head .alert_box_item_count_wrap").fadeOut()}})}),define("modules/message-system/normal-email",["jquery","underscore","modules/message-system/email"],function(e,t,n){return n.extend({init:function(){this.set({type:"normal"})}})}),define("text!templates/common/home-head/alert-box/item/email/item-normal.html",[],function(){return'<div class="l-float avatar-wrap">\n    <a class="show_avatar link_bypass" href="{{sender.avatar.view_url}}">\n        <img src="{{sender.avatar.view_url}}" alt="{{sender.display_name}}" width="34px" />\n    </a>\n    <a class="web-id" href="{{sender.cn_number}}">{{sender.cn_number}}</a>\n</div>\n<div class="l-float message-wrap">\n    <div class="main">\n        <div class="center">\n            CN Mail from <a href="{{sender.cn_number}}">{{sender.fullname}}</a>\n        </div>\n        <div class="bottom">\n            <span>{{display_time}}</span>\n        </div>\n    </div>\n    <div class="foot">\n        <a class="bt bt-blue bt-agree r-float check_email" href="user/email/{{#is_reply_email}}{{parent_email_id}}{{/is_reply_email}}{{^is_reply_email}}{{id}}{{/is_reply_email}}">View</a>\n        <div class="clear"></div>\n    </div>\n</div>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/email/items/normal",["jquery","underscore","backbone","modules/message-system/normal-email","text!templates/common/home-head/alert-box/item/email/item-normal.html"],function(e,t,n,i,o){return n.View.extend({template:o,tagName:"li",events:{"click .check_email":"check"},initialize:function(){t.bindAll(this,"check");var e=this.model.collection;this.model=new i(this.model.toJSON()),this.model.view=this,this.model.collection=e},serialize:function(){return this.model.toJSON()},check:function(){return this.model.collection.remove(this.model.get("id")),this.model.check(),!0}})}),define("modules/user/course-user",["jquery","underscore","backbone","tools/string-help"],function(e,t,n,i){return n.Model.extend({urlRoot:"api/course_user/",defaults:function(){return{score:{sub_total_seeds:0,sub_total:0}}},initDefaults:function(){var e=this,n=e.get("score");n=t.extend(n,{display_sub_total:i.addCommas(n.sub_total)});var o={score:n};return t.extend({},o)}})}),define("modules/message-system/course-apply-email",["jquery","underscore","modules/message-system/email","modules/user/course-user"],function(e,t,n,i){return n.extend({init:function(){this.set({type:"course-apply"});var e=this.get("extra_data")[0].value;this.course_user=new i({id:e})},accept:function(){var e=this,t=this.get("sender");e.check(function(){e.course_user.save({user_id:t.id},{resultTrue:function(){}})})},reject:function(){var e=this,t=this.get("sender");this.course_user.addUrlParam({user_id:t.id}),e.check(function(){e.course_user.destroy({resultTrue:function(){}})})}})}),define("text!templates/common/home-head/alert-box/item/email/item-course-apply.html",[],function(){return'<div class="l-float avatar-wrap">\n    <a class="show_avatar link_bypass" href="{{sender.avatar.view_url}}">\n        <img src="{{sender.avatar.view_url}}" alt="{{sender.display_name}}" width="34px" />\n    </a>\n    <a class="web-id" href="{{sender.cn_number}}">{{sender.cn_number}}</a>\n</div>\n<div class="l-float message-wrap">\n    <div class="main">\n        <div class="center">\n            <a href="{{sender.cn_number}}">{{sender.fullname}}</a> has emailed a request to join your course . Please Accept or Reject the request below.\n        </div>\n        <div class="bottom">\n            <span>{{display_time}}</span>\n        </div>\n    </div>\n    <div class="foot">\n        <a class="bt bt-gray bt-disagree r-float reject_apply_course" href="javascript:;">Ignore</a>\n        <a class="bt bt-blue bt-agree r-float accept_apply_course" href="javascript:;">Accept</a>\n        <div class="clear"></div>\n    </div>\n</div>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/email/items/course-apply",["jquery","underscore","backbone","modules/message-system/course-apply-email","text!templates/common/home-head/alert-box/item/email/item-course-apply.html"],function(e,t,n,i,o){return n.View.extend({template:o,tagName:"li",events:{"click .accept_apply_course":"accept","click .reject_apply_course":"reject"},initialize:function(){t.bindAll(this,"accept","reject");var e=this.model.collection;this.model=new i(this.model.toJSON()),this.model.view=this,this.model.collection=e},serialize:function(){return this.model.toJSON()},accept:function(){this.model.collection.remove(this.model.get("id")),this.model.accept()},reject:function(){this.model.collection.remove(this.model.get("id")),this.model.reject()}})}),define("modules/message-system/course-invite-email",["jquery","underscore","modules/message-system/email","controller","modules/user/course-user"],function(e,t,n,i,o){return n.extend({init:function(){this.set({type:"course-invite"});var e=t.first(this.get("extra_data")),n=e.value;this.course_user=new o({id:n}),this.course_number=e.course_number},accpet:function(){var e=this,t=this.get("id");e.check(function(){e.course_user.save({invite_email_id:t},{resultTrue:function(){i.go(e.course_number)}})})},reject:function(){var e=this;e.check()}})}),define("text!templates/common/home-head/alert-box/item/email/item-course-invite.html",[],function(){return'<div class="l-float avatar-wrap">\n    <a class="show_avatar link_bypass" href="{{sender.avatar.view_url}}">\n        <img src="{{sender.avatar.view_url}}" alt="{{sender.display_name}}" width="34px" />\n    </a>\n    <a class="web-id" href="{{sender.cn_number}}">{{sender.cn_number}}</a>\n</div>\n<div class="l-float message-wrap">\n    <div class="main">\n        <div class="center">\n            {{#sender}}<a href="{{cn_number}}">{{display_name}}</a>{{/sender}} has invited you to join the Course {{#value}}<a href="{{course_number}}">{{course_name}}</a>{{/value}}. Please Accept or Reject the request below.\n        </div>\n        <div class="bottom">\n            <span>{{display_time}}</span>\n        </div>\n    </div>\n    <div class="foot">\n        <a class="bt bt-gray bt-disagree r-float reject_invited" href="javascript:;">Ignore</a>\n        <a class="bt bt-blue bt-agree r-float accept_invited" href="javascript:;">Accept</a>\n        <div class="clear"></div>\n    </div>\n</div>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/email/items/course-invite",["jquery","underscore","backbone","modules/message-system/course-invite-email","text!templates/common/home-head/alert-box/item/email/item-course-invite.html"],function(e,t,n,i,o){return n.View.extend({template:o,tagName:"li",events:{"click .accept_invited":"accept","click .reject_invited":"reject"},initialize:function(){var e=this.model.collection;this.model=new i(this.model.toJSON()),this.model.collection=e,this.model.view=this},serialize:function(){var t=this.model.get("extra_data"),n=e.extend({},{value:t[0]},this.model.toJSON());return n},accept:function(){return this.model.collection.remove(this.model.get("id")),this.model.accpet(),!0},reject:function(){return this.model.collection.remove(this.model.get("id")),this.model.reject(),!0}})}),define("modules/user/conexus-user",["jquery","underscore","backbone","tools/string-help"],function(e,t,n,i){return n.Model.extend({urlRoot:"api/conexus_user/",defaults:function(){return{score:{sub_total_seeds:0,sub_total:0}}},initDefaults:function(){var e=this,n=e.get("score");n=t.extend(n,{display_sub_total:i.addCommas(n.sub_total)});var o={score:n};return t.extend({},o)}})}),define("modules/message-system/conexus-invite-email",["jquery","underscore","modules/message-system/email","controller","modules/user/conexus-user"],function(e,t,n,i,o){return n.extend({init:function(){this.set({type:"conexus-invite"});var e=t.first(this.get("extra_data")),n=e.value;this.conexus_user=new o({id:n}),this.conexus_number=e.conexus_number},accpet:function(){var e=this,t=this.get("id");e.check(function(){e.conexus_user.save({invite_email_id:t},{resultTrue:function(){i.go(e.conexus_number)}})})},reject:function(){var e=this;e.check()}})}),define("views/common/home-head/alert-box/email/items/conexus-invite",["jquery","underscore","backbone","modules/message-system/conexus-invite-email","text!templates/common/home-head/alert-box/item/email/item-course-invite.html"],function(e,t,n,i,o){return n.View.extend({template:o,tagName:"li",events:{"click .accept_invited":"accept","click .reject_invited":"reject"},initialize:function(){t.bindAll(this,"accept","reject");var e=this.model.collection;this.model=new i(this.model.toJSON()),this.model.view=this,this.model.collection=e},serialize:function(){var t=this.model.get("extra_data"),n=e.extend({},{value:t[0]},this.model.toJSON());return n},accept:function(){return this.model.collection.remove(this.model.get("id")),this.model.accpet(),!0},reject:function(){return this.model.collection.remove(this.model.get("id")),this.model.reject(),!0}})}),define("text!templates/common/home-head/alert-box/index/email.html",[],function(){return'    <span class="text-hide icon-float-tip-arrow">\r\n        Arrow\r\n    </span>\r\n    <a class=" text-hide bt-close-17 close_box" href="javascript:;" title="close">\r\n        Close\r\n    </a>\r\n	<div class="main">\r\n		<div class="top">\r\n			<h4 class="new_count">\r\n				<span>New Emails</span>\r\n			</h4>\r\n		</div>\r\n		<div class="center block_opera_wrap">\r\n			<ul id="block_alert_box_email_list" class="_list">\r\n				<li>\r\n                    <div class="block-loading block-horizontal-loading block_loading">\r\n                        <img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n                    </div>\r\n                </li>\r\n			</ul>\r\n		</div>\r\n	</div>\r\n'}),define("text!templates/common/home-head/alert-box/item/email/opera-wrap.html",[],function(){return'{{#number}}\n    <a id="alert_box_email_clear_all" class="l-float" href="javascript:;">Clear All</a>\n{{/number}}\n<a class="r-float" href="user/email">Show History</a>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/email/index",["jquery","underscore","backbone","tools/pop-up-window","views/common/home-head/alert-box/email/items/normal","views/common/home-head/alert-box/email/items/course-apply","views/common/home-head/alert-box/email/items/course-invite","views/common/home-head/alert-box/email/items/conexus-invite","views/common/home-head/alert-box/no-message","collections/message-system/message-system-collections","text!templates/common/home-head/alert-box/index/email.html","text!templates/common/home-head/alert-box/item/email/opera-wrap.html"],function(e,t,n,i,o,r,a,s,l,c,d,u){var m=i.get("function"),h=c.get("EmailMessages"),p={normal:o,course_apply:r,course_invite:a,conexus_invite:s},f=n.View.extend({template:u,className:"opera-wrap",events:{"click #alert_box_email_clear_all":"clearAll"},initialize:function(e){this.model.on("change",this.render,this),this.parent=e.parent},serialize:function(){return this.model.toJSON()},clearAll:function(){var e=this;m.confirm({content:"Are you sure to clear all of the emails?",yesCallBack:function(){e.collection.clearAll(function(){e.parent.deleted(),e.model.set({number:0})})}})}});return n.View.extend({template:d,className:"body block-float-down-box block-float-down-left-box block-alert-float-box",events:{"click .close_box":"deleted"},initialize:function(e){t.bindAll(this,"addAll","addOne","removeOne"),this.collection=new h,this.collection.on("all",this.refresh,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),this.collection.on("remove",this.checkIsEmpty,this),this.parent=e.parent},afterRender:function(){var e=this,t=new f({model:this.model,collection:this.collection,parent:e});this.$("#block_alert_box_email_list").before(t.render().view.el),this.collection.addUrlParam({with_email_extra_data:1,with_email_sender:1,email_list_type:"unread"}),this.collection.fetch({resultFalse:function(){e.refresh()}})},addOne:function(e){var t=e.get("type"),n=new p[t]({model:e});this.$("._list").append(n.render().view.el)},deleted:function(){this.remove()},checkIsEmpty:function(){this.collection.isEmpty()&&this.remove()},refresh:function(){if(this.collection.isEmpty()){var e=new l({message:"There are no new emails."});this.$("._list").empty().append(e.render().view.el)}else this.$(".opera_wrap").show();this.model.set({number:this.collection.length})},addAll:function(){this.$("._list").empty(),this.collection.each(this.addOne)},removeOne:function(){this.model.sub(1)}})}),define("text!templates/common/home-head/alert-box/button/email.html",[],function(){return'<div class="head _head">\n    <a class="text-hide icon-alert icon-alert-email load_message always_allow" href="javascript:;" data-type="email" >\n        email\n    </a>\n    <div class="alert-box-item-count-wrap alert_box_item_count_wrap">\n        \n    </div>\n</div>\n<div class="main email-main _main">\n\n</div>\n'}),define("views/common/home-head/alert-box/email/button",["jquery","underscore","backbone","tools/auto-close-view-window","views/common/home-head/alert-box/email/index","views/common/home-head/alert-box/count","modules/message-system/message-count-email","text!templates/common/home-head/alert-box/button/email.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({className:"item _item",template:s,events:{"click .load_message":"loadMessage"},initialize:function(){t.bindAll(this,"refresh"),this.model=a,this.model.on("change",this.refresh,this)},afterRender:function(){this.refresh()},loadMessage:function(t){var n=this,r=e(t.currentTarget),a=r.closest("#block_head");a.find("._main, ._box").fadeOut(),this.$("._item ._main").empty();var s=new o({parent:n,model:this.model});r.closest("._item").find("._main").hide().html(s.render().view.el).fadeIn(),i(t,s)},refresh:function(){if(this.model.get("number")){var e=new r({model:this.model});this.$("._head .alert_box_item_count_wrap").html(e.render().view.el).fadeIn()}else this.$("._head .alert_box_item_count_wrap").fadeOut()}})}),define("text!templates/common/home-head/alert-box/item/notification/avater.html",[],function(){return'<a class="show_avatar link_bypass" href="{{avatar.view_url}}">\n    <img src="{{avatar.view_url}}" alt="{{display_name}}" width="34px" />\n</a>\n<a class="web-id" href="{{cn_number}}">{{cn_number}}</a>\n'}),define("views/common/home-head/alert-box/notification/items/avatar",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/item/notification/avater.html"],function(e,t,n,i){return n.View.extend({template:i,className:"avatar-wrap",serialize:function(){return t.first(this.model.get("users"))}})}),define("text!templates/common/home-head/alert-box/item/notification/master_.html",[],function(){return'<div class="l-float block_avatar_wrap">\n    <div>\n        \n    </div>\n</div>\n<div class="r-float block_message_wrap">\n    \n</div>\n<div class="clear"></div>\n'}),define("views/common/home-head/alert-box/notification/items/master_",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/avatar","text!templates/common/home-head/alert-box/item/notification/master_.html"],function(e,t,n,i,o){return n.View.extend({template:o,tagName:"li",className:"block_alert_box_notification_item",events:{"click .check_notification":"check","click .delete_notification":"deleted"},initialize:function(e){t.bindAll(this,"beforeRender_"),this.model.view=this,this.options=e?e:{}},beforeRender:function(){var e=this;this.setViews({".block_avatar_wrap":new i({model:e.model})}),this.beforeRender_()},beforeRender_:function(){},check:function(){var e=this;return this.model.check({afterCheck:function(){e.model.collection.remove(e.model.get("id"))}}),!0},deleted:function(){return this.model.deleted(),!0}})}),define("text!templates/common/home-head/alert-box/item/notification/item-like-content.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>liked</b> your <a href="content/view/{{value.id}}">{{value.type}}</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>liked</b> your {{type}}\n            , but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/like-content",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-like-content.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/loading/head-horizontal.html",[],function(){return'<div class="block-loading block-horizontal-loading block_loading">\r\n	<img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n</div>'}),define("text!templates/common/more-operation.html",[],function(){return'<div class="main get_more_operation_box">\r\n	<a href="javascript:;" class="get_more always_allow">\r\n		SHOW MORE\r\n	</a>\r\n</div>'}),function(e){var t={load:function(){},scrollTarget:null,heightOffset:"auto"},n=function(t,n){var i=e(n.scrollTarget);if(0!=e(t).scrollTop())if(e(t).length>0&&e(t).is(":visible")&&location.href==n.url){var o=!1;o="auto"===n.heightOffset||n.heightOffset>=e(t).height()?(e(t).scrollTop()+e(t).height())/i.height()>=.7:e(t).scrollTop()+n.heightOffset+e(t).height()>=i.height(),o&&n.load()}else e(t).stopScrollPagination()};e.fn.scrollPagination=function(i){var o=e.extend({},t,i,{url:location.href});return o.scrollTarget?(e(this).unbind("scroll"),e(this).attr("scrollPagination","enabled"),e(this).scroll(function(t){"enabled"==e(this).attr("scrollPagination")?n(this,o):t.stopPropagation()}),e(this)):(console.error("the scrollTarget is missing"),!1)},e.fn.stopScrollPagination=function(){return e(this).attr("scrollPagination","disabled")}}(jQuery),define("jqueryScrollPagination",function(){}),define("views/common/more-operation",["jquery","underscore","backbone","text!templates/loading/head-horizontal.html","text!templates/common/more-operation.html","jqueryScrollPagination"],function(e,t,n,i,o){return n.View.extend({className:"block-more-operation",template:o,events:{"click .get_more":"getMore"},initialize:function(t){this._tmpData={},this.view={initMinLimit:10,limit:20,scrollTarget:e(document),scrollTargetWrap:e(window),heightOffset:"auto",removeTemplateNoMore:!0,noMoreCallback:function(){},loadingCallback:function(){}},t.view&&t.view&&(this.view=e.extend(this.view,t.view)),this._tmpData.offset=0,this._tmpData.bindScrollPagination=!1,this.collection.on("add",this.render,this),this.collection.on("reset",this.render,this),this.collection&&this.view.initMinLimit<=this.collection.length?(this._tmpData.scrollLoadMore=!0,this._tmpData.offset=this.collection.length):this._tmpData.scrollLoadMore=!1},beforeRender:function(){return this._tmpData.scrollLoadMore?void 0:this.el=""},afterRender:function(){var t=this;return this._tmpData.scrollLoadMore?(t._tmpData.scrollLoadMore&&!t._tmpData.bindScrollPagination&&(t._tmpData.bindScrollPagination=!0,t._tmpData.scrollPagination=e(t.view.scrollTargetWrap).scrollPagination({heightOffset:t.view.heightOffset,scrollTarget:t.view.scrollTarget,callbackContext:t,load:function(){this.callbackContext.getMore()}})),void 0):this.el=""},getMore:function(){var t=this;if(!t._tmpData.scrollLoadMore)return!1;var n=function(e){t.$(".main").html(e)},o=function(){t._tmpData.scrollLoadMore=!1,t._tmpData.scrollPagination.stopScrollPagination(),t.view.removeTemplateNoMore?t.$el.parent().remove():n("<span>NO MORE</span>"),t.view.noMoreCallback()},r=t.$(".main").html();t._tmpData.scrollLoadMore&&t._tmpData.offset>0&&(n(i),t.view.loadingCallback(),t._tmpData.scrollLoadMore=!1,t.collection.fetch({add:!0,data:e.param({limit:t.view.limit,offset:t._tmpData.offset}),resultTrue:function(e,i){!i.data||t.view.limit>i.data.length?o():i.extra_data&&i.extra_data.next_offset?t._tmpData.offset<i.extra_data.next_offset?(t._tmpData.offset=i.extra_data.next_offset,t._tmpData.scrollLoadMore=!0,n(r)):o():o()},resultFalse:function(){o()}}))}})}),define("modules/user/user-following",["jquery","underscore","modules/user/user"],function(e,t,n){return n.extend({urlRoot:"api/user_following/"})}),define("tools/view/user-relation-manager",["jquery","underscore","modules/user/user-following","modules/user/user-colleague"],function(e,t,n,i){return function(){return{addColleague:function(e){var t=new i;t.save({colleague_user_id:e.get("id")},{resultTrue:function(){e.set({display_is_my_pending_colleague_user:!0})}})},removeColleague:function(e){var t=new i({id:e.get("id")});t.destroy({resultTrue:function(){e.set({display_is_my_colleague_user:!1,display_colleague_count:e.get("display_colleague_count")-1})}})},addFollowing:function(e){var t=new n;t.save({follow_user_id:e.get("id")},{resultTrue:function(){e.set({display_is_my_following_user:!0,display_follower_count:e.get("display_follower_count")+1})}})},removeFollowing:function(e){var t=new n({id:e.get("id")});t.destroy({resultTrue:function(){e.set({display_is_my_following_user:!1,display_follower_count:e.get("display_follower_count")-1})}})}}}()}),define("text!templates/content/relation/good.html",[],function(){return'<div class="sidebar l-float">\r\n    {{#avatar}}\r\n    <div class="top">\r\n        <a class="avatar avatar-61 show_avatar link_bypass" href="{{view_url}}">\r\n            <img src="{{view_url}}" alt="{{display_name}}" />\r\n        </a>\r\n    </div>\r\n    {{/avatar}}\r\n    <div class="bottom">\r\n        <span>{{cn_number}}</span>\r\n    </div>\r\n</div>\r\n<div class="content l-float">\r\n    <div class="top">\r\n        <a class="text show_card window_directed" href="javascript:;" data-href="{{cn_number}}" data-type="user" data-id="{{id}}">\r\n            {{display_name}}\r\n        </a>,\r\n        {{#profile}}\r\n            {{#position}}\r\n                {{#school_name}}\r\n                <a class="text link_bypass" {{#web_address}}href="{{web_address}}"{{/web_address}} target="_blank" title="{{school_name}}">\r\n                    {{school_name}}\r\n                </a>\r\n                {{/school_name}}\r\n            {{/position}}\r\n        {{/profile}}\r\n        {{#country}}\r\n            {{#flag_url}}\r\n            <a class="r-float flag-b" href="javascript:;">\r\n                <img src="{{flag_url}}" title="{{name}}" alt="{{name}}" />\r\n            </a>\r\n            {{/flag_url}}\r\n        {{/country}}\r\n    </div>\r\n    <div class="center visibility-hidden _operate">\r\n        <table class="block-user-relation-opt">\r\n             <thead>\r\n                 <tr>\r\n                    <th>\r\n                        <a class="link load_send_email_window" href="javascript:;" data-id="{{id}}">\r\n                            Email {{cn_number}}\r\n                        </a>\r\n                    </th>\r\n                    <th>\r\n                        <a class="link not_completed" href="javascript:;">\r\n                            Report Member\r\n                        </a>\r\n                    </th>\r\n                    <th>\r\n                        {{#score}}\r\n                        <a class="anar-18-20 load_about_anar_window" href="javascript:;">\r\n                            {{display_total}}\r\n                        </a>\r\n                        {{/score}}\r\n                    </th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr>\r\n                    <td>\r\n                    {{#relations}}\r\n                        {{#is_myself}}\r\n                         <a class="bt-relation bt-relation-off">\r\n                            <i>Follow</i>\r\n                        </a>\r\n                        {{/is_myself}}\r\n                        {{^is_myself}}\r\n                        <a class="\r\n                            {{#display_is_my_following_user}}\r\n                                remove_following bt-relation-on\r\n                            {{/display_is_my_following_user}}\r\n                            {{^display_is_my_following_user}}\r\n                                add_following bt-relation-off\r\n                            {{/display_is_my_following_user}} bt-relation " \r\n                        href="javascript:;">\r\n                           <i> \r\n                            {{#display_is_my_following_user}}\r\n                                Following\r\n                            {{/display_is_my_following_user}}\r\n                            {{^display_is_my_following_user}}\r\n                                Follow\r\n                            {{/display_is_my_following_user}}\r\n                           </i>\r\n                        </a>\r\n                        {{/is_myself}}\r\n                    {{/relations}}\r\n                    </td>\r\n                    <td>\r\n                    {{#relations}}\r\n                        {{#is_myself}}\r\n                         <a class="bt-relation bt-relation-off">\r\n                            <i>Colleague</i>\r\n                        </a>\r\n                        {{/is_myself}}\r\n                        {{^is_myself}}\r\n                        <a class="bt-relation \r\n                            {{#display_is_my_colleague_user}}\r\n                                remove_colleague bt-relation-on\r\n                            {{/display_is_my_colleague_user}}\r\n                            {{^display_is_my_colleague_user}}\r\n                                {{#display_is_my_pending_colleague_user}}\r\n                                    bt-relation-pending\r\n                                {{/display_is_my_pending_colleague_user}}\r\n                                {{^display_is_my_pending_colleague_user}}\r\n                                    add_colleague bt-relation-off\r\n                                {{/display_is_my_pending_colleague_user}}\r\n                            {{/display_is_my_colleague_user}}" \r\n                        href="javascript:;">\r\n                            <i>\r\n                            {{#display_is_my_colleague_user}}\r\n                                Colleague\r\n                            {{/display_is_my_colleague_user}}\r\n                            {{^display_is_my_colleague_user}}\r\n                                {{#display_is_my_pending_colleague_user}}\r\n                                Pending\r\n                                {{/display_is_my_pending_colleague_user}}\r\n                                {{^display_is_my_pending_colleague_user}}\r\n                                Colleague\r\n                                {{/display_is_my_pending_colleague_user}}\r\n                            {{/display_is_my_colleague_user}}\r\n                            </i>\r\n                        </a>\r\n                        {{/is_myself}}\r\n                    {{/relations}}\r\n                    </td>\r\n                    <td>\r\n                        <a class="bt-relation bt-relation-post" href="{{cn_number}}">\r\n                            Posts\r\n                        </a>\r\n                    </td>\r\n                </tr>\r\n                {{#count}}\r\n                <tr>\r\n                    <td>\r\n                        <em>{{display_follower_count}}</em>\r\n                    </td>\r\n                    <td>\r\n                        <em>{{display_colleague_count}}</em>\r\n                    </td>\r\n                    <td>\r\n                        <em>{{content}}</em>\r\n                    </td>\r\n                </tr>\r\n                {{/count}}\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div class="clear"></div>'}),define("views/content/relation/good",["jquery","underscore","backbone","tools/view/user-relation-manager","tools/pop-up-window","controller","text!templates/content/relation/good.html"],function(e,t,n,i,o,r,a){return n.View.extend({tagName:"li",className:"good_item",template:a,initialize:function(){this.model.on("change:display_is_my_following_user",this.render,this),this.model.on("change:display_is_my_colleague_user",this.render,this),this.model.on("change:display_is_my_pending_colleague_user",this.render,this),this.model.on("change:display_follower_count",this.render,this)},events:{"click .add_colleague":"addColleague","click .remove_colleague":"removeColleague","click .add_following":"addFollowing","click .remove_following":"removeFollowing","click .window_directed":"windowDirected"},serialize:function(){return this.model.toJSON()},addColleague:function(){i.addColleague(this.model)},removeColleague:function(){i.removeColleague(this.model)},addFollowing:function(){i.addFollowing(this.model)},removeFollowing:function(){i.removeFollowing(this.model)},windowDirected:function(e){o.get("function").close(),r.go(this.$(e.currentTarget).attr("data-href"))}})}),define("views/content/relation/goods",["jquery","underscore","backbone","views/content/relation/good"],function(e,t,n,i){return n.View.extend({tagName:"ul",initialize:function(){t.bindAll(this,"addOne","addAll"),this.collection.on("fetch",this.addAll,this),this.collection.on("add",this.addOne,this)
},events:{"mouseenter .good_item":"displayOperate","mouseleave .good_item":"hideOperate"},addAll:function(){this.collection.each(this.addOne)},addOne:function(e){this.$el.append(new i({model:e}).render().view.el)},displayOperate:function(e){this.$(e.currentTarget).find("._operate").css("visibility","visible")},hideOperate:function(e){this.$(e.currentTarget).find("._operate").css("visibility","hidden")}})}),define("text!templates/common/error-tip.html",[],function(){return'<div class="main">\r\n	<div class="center-text">\r\n		{{{text}}}\r\n	</div>\r\n</div>'}),define("views/common/error-tip",["jquery","underscore","backbone","text!templates/common/error-tip.html"],function(e,t,n,i){return n.View.extend({className:"block-error-tip",template:i,initialize:function(e){this.data=e.data},serialize:function(){return this.data}})}),define("text!templates/common/pop-up-window/goods.html",[],function(){return'<div class="head">\r\n	<h4>Likes</h4>\r\n</div>\r\n<div class="main">\r\n    <div class="center">\r\n        <div class="body">\r\n            <div class="block-post-good-list" id="goods_main">\r\n                \r\n            </div>\r\n        </div>\r\n        <div class="last" id="goods_foot">\r\n        \r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("views/common/pop-up-window/goods",["jquery","underscore","backbone","tools/pop-up-window","views/common/more-operation","views/content/relation/goods","views/common/error-tip","text!templates/common/pop-up-window/goods.html"],function(e,t,n,i,o,r,a,s){var l=i.get("function");return i.get("view").extend({className:"pop-up-window block-window-goods block_window_goods",template:s,beforeRender_:function(){this.setViews({"#goods_main":new r({collection:this.collection})})},afterRender_:function(){var e=this;this.collection.addUrlParam({with_user_profile:1,with_user_relations:1,with_user_country:1,with_user_count:1,with_user_score:1}),this.collection.fetch({resultTrue:function(t){e.$("#goods_foot").html(new o({collection:t,view:{initMinLimit:10,limit:10,scrollTarget:".block_window_goods ul",scrollTargetWrap:".block_window_goods .center"}}).render().view.el),l.update()},resultFalse:function(n){var i="";t.each(n,function(e){i+=e+"</ br>"}),e.$("#goods_main").html(new a({data:{text:i}}).render().view.el)}})}})}),define("tools/view/content-tools",["jquery","underscore","tools/pop-up-window","views/common/pop-up-window/goods"],function(e,t,n,i){var o=n.get("function");return function(){return{loadLikeUsersWindow:function(e){o.open(new i({collection:e}).render().view.el)}}}()}),define("modules/content/comment",["jquery","underscore","backbone","modules/me"],function(e,t,n,i){var o=new i;return n.Model.extend({urlRoot:"api/content_comment/",defaults:function(){return{user:o.toJSON(),count:{good:0,comment:0,best:0},is_owner:!0,count_comment:0,count_good:0,count_best:0,has_set_good:!1,has_set_best:!1,can_set_best:!1}},initDefaults:function(){var e=this,t=e.getCountByKey("comment");return{count_comment:t,count_good:e.getCountByKey("good"),count_best:e.getCountByKey("best"),can_set_best:t>2}},isAllowSetBest:function(){this.get("count_comment")>2},deleted:function(t){var n=this;this.destroy({silent:!0,wait:!0,resultTrue:function(){n.view.remove(),"function"==e.type(t.success)&&t.success()}})},hasCountByKey:function(e){return this.get("count")&&this.get("count")[e]&&this.get("count")[e]>0},getCountByKey:function(e){return this.hasCountByKey(e)?this.get("count")[e]:0}})}),define("modules/content/sub-comment",["jquery","underscore","backbone","modules/content/comment"],function(e,t,n,i){return i.extend({urlRoot:"api/content_sub_comment/"})}),define("modules/content/comment-good",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/content_comment_good/"})}),define("modules/content/comment-best",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/content_comment_best/"})}),define("modules/content/good",["jquery","underscore","modules/user/user"],function(e,t,n){return n.extend({urlRoot:"api/content_good/"})}),define("collections/content/comment-goods",["jquery","underscore","backbone","modules/content/good"],function(e,t,n,i){return n.Collection.extend({model:i,urlRoot:"/api/content_comment_good/"})}),define("text!templates/content/relation/reflection.html",[],function(){return'<div class="sidebar l-float">\r\n{{#user}}\r\n    {{#avatar}}\r\n    <a class="avatar avatar-34" href="{{cn_number}}">\r\n        <img class="avatar_url_{{user.id}}" src="{{view_url}}" alt="{{display_name}}" title="{{fullname}}" />\r\n    </a>\r\n    {{/avatar}}\r\n{{/user}}\r\n</div>\r\n<div class="content r-float">\r\n    <form class="form_reflect" method="post">\r\n        <textarea class="input_reflect" name="text" placeholder="Click to make a reflection." required="required"></textarea>\r\n        <button class="bt bt-gray display-none submit_reflect" type="submit">Submit</button>\r\n        <div class="clear"></div>\r\n        <input type="hidden" name="content_id" value="{{content_id}}">\r\n        <input type="hidden" name="content_comment_id" value="{{comment_id}}">\r\n    </form>\r\n</div>\r\n<div class="clear"></div>'}),function(e){e.fn.serializeObject=function(t){t=e.extend({},t);var n=this,i={},o={},r={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,n){return e[t]=n,e},this.push_counter=function(e){return void 0===o[e]&&(o[e]=0),o[e]++},e.each(e(this).serializeArray(),function(){if(r.validate.test(this.name)){for(var t,o=this.name.match(r.key),a=this.value,s=this.name;void 0!==(t=o.pop());)s=s.replace(RegExp("\\["+t+"\\]$"),""),t.match(r.push)?a=n.build([],n.push_counter(s),a):t.match(r.fixed)?a=n.build([],t,a):t.match(r.named)&&(a=n.build({},t,a));i=e.extend(!0,i,a)}}),i}}(jQuery),define("jquerySerializeObject",function(){}),define("views/content/relation/reflection",["jquery","underscore","backbone","modules/me","text!templates/content/relation/reflection.html","jquerySerializeObject"],function(e,t,n,i,o){return n.View.extend({className:"block-post-reflection",template:o,serialize:function(){return this.data},initialize:function(e){t.bindAll(this,"reflect_");var n=new i;this._model=e._model,this.data=e.data,this.data.user=n.toJSON(),this.data.content_id=e.contentId?e.contentId:"",this.data.comment_id=e.commentId?e.commentId:""},events:{"submit .form_reflect":"reflect","focus .input_reflect":"showSubmitButton"},showSubmitButton:function(t){var n=this;e(t.currentTarget).animate({width:"86%"},"fast","swing",function(){n.$(".submit_reflect").fadeIn("fast")})},afterRender:function(){},reflect:function(e){var t=this.$(e.currentTarget);if(t.attr("locked"))return!1;t.attr("locked","locked");var n=this;return n.model=new n._model,n.model.addUrlParam({return_detail:1,with_content_comment_user:1,with_user_profile:1}),n.model.save(n.$(".form_reflect").serializeObject(),{wait:!0,resultTrue:function(e){n.$(".input_reflect").val(""),n.data.model.set("count_comment",n.data.model.get("count_comment")+1),n.collection.add(e),n.reflect_()},completeCallback:function(){t.removeAttr("locked")}}),!1},reflect_:function(){}})}),define("views/content/relation/comment-reflection",["views/content/relation/reflection"],function(e){return e.extend({className:"block-post-reflection block-comment-reflection",reflect_:function(){this.remove()}})}),define("modules/translation",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/translation/",initDefaults:function(){var e=this;return{display_name:e.get("name"),display_value:e.get("id")}}})}),define("modules/user-translation-setting",["jquery","underscore","backbone"],function(e,t,n){var i=n.Model.extend({urlRoot:"api/user_translation_setting/"});return i}),define("modules/translation-language-detection",["jquery","underscore","backbone"],function(e,t,n){var i=n.Model.extend({urlRoot:"api/translation_language_detection/"});return i}),define("views/common/option",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({tagName:"option",initialize:function(i){if("undefined"!==e.type(i)){var o={};if(t.isUndefined(i.model))if(t.isUndefined(i.attrs))var r={display_value:"",display_name:"",selected:""};else var r=i.attrs;else var r=i.model;t.isUndefined(r)||(o={display_value:r instanceof n.Model?r.get("display_value"):r.display_value,display_name:r instanceof n.Model?r.get("display_name"):r.display_name,selected:t.isUndefined(i.params)||t.isUndefined(i.params.selected)?"":i.params.selected}),t.isUndefined(o.display_value)||t.isUndefined(o.display_name)||(this.$el.attr("value",o.display_value),this.$el.html(o.display_name),"undefined"!==e.type(o.selected)&&o.display_value==o.selected&&this.$el.prop("selected",!0))}}})}),define("text!templates/text/terms-of-use.html",[],function(){return'<div class="head">\r\n    <h4>Terms of Use</h4>\r\n</div>\r\n<div class="main">\r\n		<div class="index-terms-of-use-body">\r\n			<div>\r\n				\r\n				<p>Date of Last Revision: December 13, 2012.</p>\r\n\r\n                                <p>Welcome to CourseNetworking, LLC, an academic and professional networking and content delivery service. The CourseNetworking, LLC service and network (collectively, "CourseNetworking, LLC" or "the Service") are operated by CourseNetworking, LLC (collectively, "us", "we" or "the Company"). By accessing or using our web site at www.coursenetworking.com or any other version thereof (together the "Site") you (the "User") signify that you have read, understand and agree to be bound by these Terms of Use ("Terms of Use" or "Agreement"), whether or not you are a registered member of CourseNetworking, LLC. We reserve the right, at our sole discretion, to change, modify, add, or delete portions of these Terms of Use at any time without further notice. If we do this, we will post the changes to these Terms of Use on this page and will indicate at the top of this page the date these terms were last revised. Your continued use of the Service or the Site after any such changes constitutes your acceptance of the new Terms of Use. If you do not agree to abide by these or any future Terms of Use, do not use or access (or continue to use or access) the Service or the Site. It is your responsibility to regularly check the Site to determine if there have been changes to these Terms of Use and to review such changes. We may also offer other services that are governed by different Terms of Use. For instance, different terms may apply to non-US members, K-12 Students, and non-students.</p>\r\n\r\n                                <p><strong>PLEASE READ THESE TERMS OF USE CAREFULLY AS THEY CONTAIN IMPORTANT INFORMATION REGARDING YOUR LEGAL RIGHTS, REMEDIES AND OBLIGATIONS. THESE INCLUDE VARIOUS LIMITATIONS AND EXCLUSIONS, AND A DISPUTE RESOLUTION CLAUSE THAT GOVERNS HOW DISPUTES WILL BE RESOLVED.</strong></p>\r\n\r\n                                <h6>Eligibility</h6>\r\n\r\n                                <p>Membership in the Service is void where prohibited. This Site is intended solely for users who are thirteen (13) years of age or older. Any registration by, use of or access to the Site by anyone else is unauthorized, unlicensed and in violation of these Terms of Use. By using the Service or the Site, you represent and warrant that (a) you meet the above age requirements; (b) you agree to abide by all of the terms and conditions of this Agreement; and (c) your use of the CourseNetworking, LLC Services does not violate any applicable law or regulation.</p>\r\n\r\n                                <h6>Registration Data; Account Security</h6>\r\n\r\n                                <p>In consideration of your use of the Site, you agree to (a) provide accurate, current and complete information about you as may be prompted by any registration forms on the Site ("Registration Data"); (b) maintain the security of your password and identification; (c) maintain and promptly update the Registration Data, and any other information you provide to Company, to keep it accurate, current and complete; and (d) be fully responsible for all use of your account and for any actions that take place using your account.</p>\r\n\r\n                                <p>You are responsible for safeguarding and maintaining the secrecy of your password and identification at all times. You shall notify the Company promptly of any unauthorized use of your password and identification. You will remain liable for any use of the Service under your password and identification unless and until you notify the Company of the unauthorized use of your password and identification. The Company may suspend your access to the Service without notice to you in the event that you do not use the Service for an extended period of time.</p>\r\n\r\n                                <h6>Proprietary Rights in Site Content; Limited License</h6>\r\n\r\n                                <p>All content on the Site and available through the Service, including but not limited to designs, text, graphics, pictures, video, information, applications, software, music, sound and other files, User Content (as defined below), and their selection and arrangement (the "Site Content"), are the proprietary property of the Company, its users or its licensors with all rights reserved. No Site Content may be modified, copied, distributed, framed, reproduced, republished, downloaded, displayed, posted, transmitted, or sold in any form or by any means, in whole or in part, without the Company\'s prior written permission, except that the foregoing does not apply to your own User Content that you legally post on the Site. Provided that you are eligible for use of the Site, you are granted a limited license to access and use the Site and the Site Content and to download or print a copy of any portion of the Site Content to which you have properly gained access solely for your personal, non-commercial use, provided that you keep all copyright or other proprietary notices intact. Except for your own User Content, you may not upload or republish Site Content on any Internet, Intranet or Extranet site or incorporate the information in any other database or compilation, and any other use of the Site Content is strictly prohibited. Such license is subject to these Terms of Use and does not include use of any data mining, robots or similar data gathering or extraction methods. Any use of the Site or the Site Content other than as specifically authorized herein, without the prior written permission of Company, is strictly prohibited and will terminate the license granted herein. Such unauthorized use may also violate applicable laws including without limitation copyright and trademark laws and applicable communications regulations and statutes. Unless explicitly stated herein, nothing in these Terms of Use shall be construed as conferring any license to intellectual property rights, whether by estoppel, implication or otherwise. This license is revocable at any time without notice and with or without cause.</p>  \r\n\r\n                                <h6>Trademarks</h6>\r\n\r\n                                <p>CourseNetworking, LLC™, the CourseNetworking, LLC logo, and other Company graphics, logos, designs, page headers, icons, scripts and service names are registered trademarks, trademarks or trade dress of Company or its licensors in the U.S. and/or other countries. Company\'s trademarks and trade dress may not be used, including as part of trademarks and/or as part of domain names, in connection with any product or service in any manner that is likely to cause confusion and may not be copied, imitated, or used, in whole or in part, without the prior written permission of the Company.</p>  \r\n\r\n                                <h6>User Content Posted on the Site</h6>\r\n\r\n                                <p>You are solely responsible for the photos, profiles, messages, notes, text, information, music, video, advertisements, listings, and other content that you upload, publish or display (hereinafter, "post") on or through the Service or the Site, or transmit to or share with other users (collectively the "User Content"). You may not post, transmit, or share User Content on the Site or Service that you did not create or that you do not have permission to post, and you shall be solely responsible for obtaining such permission. You understand and agree that the Company may, but is not obligated to, review the Site and may delete or remove (without notice) any Site Content or User Content in its sole discretion, for any reason or no reason, including without limitation User Content that in the sole judgment of the Company violates this Agreement, or which might be offensive, illegal, or that might violate the rights, harm, or threaten the safety of users or others. You are solely responsible at your sole cost and expense for creating backup copies and replacing any User Content you post or store on the Site or provide to the Company.</p>\r\n\r\n                                <p>When you post User Content to the Site, you authorize and direct us to make such copies thereof as we deem necessary in order to facilitate the posting and storage of the User Content on the Site and delivery of the Service. By posting User Content to any part of the Site, you automatically grant, and you represent and warrant that you have the right to grant, to the Company an irrevocable, perpetual, non-exclusive, transferable, fully paid, worldwide license (with the right to sublicense) to use, copy, publicly perform, publicly display, reformat, translate, and distribute such User Content for any purpose that is in connection with delivery of the Service or the promotion thereof, and to grant and authorize sublicenses of the foregoing. You may remove your User Content from the Site at any time. If you choose to remove your User Content, the license granted above will automatically expire, however you acknowledge that the Company may retain archived copies of your User Content.</p>\r\n\r\n                                <p>If you feel your copyrighted material appears on the Site without proper authorization, please contact info@coursenetworking.com.</p>\r\n\r\n                                <h6>User Conduct</h6>\r\n\r\n                                <p>You represent, warrant and agree that no User Content submitted through your account or otherwise posted, transmitted, or shared by you on or through the Service will violate or infringe upon the rights of any third party, including copyright, trademark, privacy, publicity or other personal or proprietary rights; or contain libelous, defamatory or otherwise unlawful material. This means that you, and not CourseNetworking, LLC, are entirely responsible for all User Content that you upload, post, email, transmit or otherwise make available via the Service. CourseNetworking, LLC does not control the User Content posted via the Service and, as such, does not guarantee the accuracy, integrity or quality of such User Content. You understand that by using the Service, you may be exposed to Site Content that is offensive, indecent or objectionable. Under no circumstances will CourseNetworking, LLC be liable in any way for any Site Content, including, but not limited to, any errors or omissions in any Site Content, or any loss or damage of any kind incurred as a result of the use of any Site Content posted, emailed, transmitted or otherwise made available via the Service.</p>\r\n\r\n                                <p>You shall not use the Service to:</p>\r\n\r\n                                <p>a. upload, post, email, transmit or otherwise make available any content that is unlawful, harmful, threatening, abusive, harassing, tortuous, defamatory, vulgar, obscene, libelous, invasive of another\'s privacy, hateful, or racially, ethnically or otherwise objectionable;</p>\r\n                                <p>b. harm minors in any way;</p>\r\n                                <p>c. impersonate any person or entity, or falsely state or otherwise misrepresent yourself, your age or your affiliation with any person or entity;</p>\r\n                                <p>d. forge headers or otherwise manipulate identifiers in order to disguise the origin of any User Content transmitted through the Service;</p>\r\n                                <p>e. upload, post, email, transmit or otherwise make available any User Content that you do not have a right to make available under any law or under contractual or fiduciary relationships (such as intellectual property, inside information, proprietary and confidential information learned or disclosed as part of employment relationships or under nondisclosure agreements);</p>\r\n                                <p>f. upload, post, email, transmit or otherwise make available any User Content that infringes any patent, trademark, trade secret, copyright or other proprietary rights of any party;</p>\r\n                                <p>g. upload, post, email, transmit or otherwise make available any unsolicited or unauthorized advertising, promotional materials, "junk mail," "spam," "chain letters," "pyramid schemes," or any other form of solicitation, except in those areas (such as shopping) that are designated for such purpose.</p>\r\n                                <p>h. upload, post, email, transmit or otherwise make available any material that contains software viruses or any other computer code, files or programs designed to interrupt, destroy or limit the functionality of any computer software or hardware or telecommunications equipment;</p>\r\n                                <p>i. disrupt the normal flow of dialogue, cause a screen to "scroll" faster than other users of the Service are able to type, or otherwise act in a manner that negatively affects other users\' ability to engage in real time exchanges; </p>\r\n                                <p>j. interfere with or disrupt the Service or servers or networks connected to the Service, or disobey any requirements, procedures, policies or regulations of networks connected to the Service;</p> \r\n                                <p>k. intentionally or unintentionally violate any applicable local, state, national or international law, including, but not limited to, regulations promulgated by the U.S. Securities and Exchange Commission, any rules of any national or other securities exchange, including, without limitation, the New York Stock Exchange, the American Stock Exchange or the NASDAQ, and any regulations having the force of law;</p>\r\n                                <p>l. provide material support or resources (or to conceal or disguise the nature, location, source, or ownership of material support or resources) to any organization(s) designated by the United States government as a foreign terrorist organization pursuant to section 219 of the immigration and Nationality Act;</p> \r\n                                <p>m. "stalk" or otherwise harass another; and/or</p>\r\n                                <p>n. collect or store personal data about other users in connection with the prohibited conduct and activities set forth in paragraphs a through m above.</p>\r\n                                <p>You acknowledge that the Company may or may not pre-screen Site Content, but that the Company and its designees shall have the right (but not the obligation) in their sole discretion to pre-screen, refuse, or move any Site Content that is available via the Service. Without limiting the foregoing, the Company and its designees shall have the right to remove any Site Content that violates the Terms of Use or is otherwise objectionable. You acknowledge and agree that you must evaluate, and bear all risks associated with, the use of any Site Content, including any reliance on the accuracy, completeness, or usefulness of such Site Content. In this regard, you acknowledge that you may not rely on any Site Content created by the Company or submitted to the Company or the Service, including without limitation information in message boards and in all other parts of the Service.</p>\r\n                                <p>You acknowledge, consent and agree that the Company may access, preserve and disclose your account information and User Content if required to do so by law or in a good faith belief that such access preservation or disclosure is reasonably necessary to: (a) comply with legal process; (b) enforce the Terms of Use; (c) respond to claims that any User Content violates the rights of third parties; (d) respond to your requests for customer service; or (e) protect the rights, property or personal safety of the Company, its users and the public.</p>\r\n                                <p>You understand that the technical processing and transmission of the Service, including your User Content, may involve (a) transmissions over various networks; and (b) changes to conform and adapt to technical requirements of connecting networks or devices.</p>\r\n                                <p>You understand that the Service and software embodied within the Service may include security components that permit digital materials to be protected, and that use of these materials is subject to usage rules set by the Company and/or content providers who provide content to the Service. You may not attempt to override or circumvent any of the usage rules embedded into the Service. Any unauthorized reproduction, publication, further distribution or public exhibition of the materials provided on the Service, in whole or in part, is strictly prohibited.</p>\r\n\r\n                                <h6>Third Party Websites and Content</h6>\r\n\r\n                                <p>The Site contains (or you may be sent through the Site or the Service) links to other web sites ("Third Party Sites") as well as articles, photographs, text, graphics, pictures, designs, music, sound, video, information, applications, software and other content or items belonging to or originating from third parties (the "Third Party Applications, Software or Content"). Such Third Party Sites and Third Party Applications, Software or Content are not investigated, monitored or checked for accuracy, appropriateness, or completeness by us, and we are not responsible for any Third Party Sites accessed through the Site or any Third Party Applications, Software or Content posted on, available through or installed from the Site, including without limitation the content, accuracy, offensiveness, opinions, reliability, privacy practices or other policies of or contained in the Third Party Sites or the Third Party Applications, Software or Content. Inclusion of, linking to or permitting the use or installation of any Third Party Site or any Third Party Applications, Software or Content does not imply approval or endorsement thereof by us. If you decide to leave the Site and access the Third Party Sites or to use or install any Third Party Applications, Software or Content, you do so at your own risk and you should be aware that our terms and policies no longer govern. You should review the applicable terms and policies, including privacy and data gathering practices, of any site to which you navigate from the Site or relating to any applications you use or install from the site.</p>\r\n\r\n                                <h6>User Disputes</h6>\r\n\r\n                                <p>You are solely responsible for your interactions with other CourseNetworking, LLC users. We reserve the right, but have no obligation, to monitor or intervene in disputes between you and other users.</p>\r\n\r\n                                <h6>Disclaimers</h6>\r\n                                <p>The Company is not responsible or liable in any manner for any User Content or Third Party Applications, Software or Content posted on the Site or in connection with the Service, whether posted or caused by users of the Site, by CourseNetworking, LLC, by third parties or by any of the equipment or programming associated with or utilized in the Site or the Service. Although we provide rules for user conduct and postings, we do not control and are not responsible for what users post, transmit or share on the Site and are not responsible for any offensive, inappropriate, obscene, unlawful or otherwise objectionable content you may encounter on the Site or in connection with any User Content or Third Party Applications, Software or Content. The Company is not responsible for the conduct, whether online or offline, of any user of the Site or Service.</p>\r\n\r\n                                <p>The Site and the Service may be temporarily unavailable from time to time for maintenance or other reasons. Company assumes no responsibility for any error, omission, interruption, deletion, defect, delay in operation or transmission, communications line failure, theft or destruction or unauthorized access to, or alteration of, User communications. The Company is not responsible for any technical malfunction or other problems of any telephone network or service, computer systems, servers or providers, computer or mobile phone equipment, software, failure of email or players on account of technical problems or traffic congestion on the Internet or at any Site or combination thereof, including injury or damage to User\'s or to any other person\'s computer, mobile phone, or other hardware or software, related to or resulting from using or downloading materials in connection with the Web and/or in connection with the Service. Under no circumstances will the Company be responsible for any loss or damage, including any loss or damage to any User Content or personal injury or death, resulting from anyone\'s use of the Site or the Service, any User Content or Third Party Applications, Software or Content posted on or through the Site or the Service or transmitted to Users, or any interactions between users of the Site, whether online or offline.</p>\r\n\r\n                                <p>THE SITE, THE SERVICE, AND THE SITE CONTENT ARE PROVIDED "AS IS" AND "AS AVAILABLE" AND THE COMPANY DISCLAIMS ANY AND ALL REPRESENTATIONS AND WARRANTIES, WHETHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION IMPLIED WARRANTIES OF TITLE, MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT. THE COMPANY CANNOT GUARANTEE AND DOES NOT PROMISE ANY SPECIFIC RESULTS FROM USE OF THE SITE AND/OR THE SERVICE AND/OR ANY SITE CONTENT. COMPANY DOES NOT REPRESENT OR WARRANT THAT SOFTWARE, SITE CONTENT OR MATERIALS ON THE SITE, OR THE SERVICE ARE ACCURATE, COMPLETE, RELIABLE, CURRENT OR ERROR-FREE OR THAT THE SITE, SITE CONTENT, SERVICE OR SERVERS ARE FREE OF VIRUSES OR OTHER HARMFUL COMPONENTS. THEREFORE, YOU SHOULD EXERCISE CAUTION IN THE USE AND DOWNLOADING OF ANY SUCH SOFTWARE, SITE CONTENT, SERVICES, OR MATERIALS AND USE INDUSTRY-RECOGNIZED SOFTWARE TO DETECT AND DISINFECT VIRUSES. WITHOUT LIMITING THE FOREGOING, YOU UNDERSTAND AND AGREE THAT YOU DOWNLOAD OR OTHERWISE OBTAIN CONTENT, MATERIAL, DATA OR SOFTWARE (INCLUDING ANY MOBILE CLIENT) FROM OR THROUGH THE SERVICE AT YOUR OWN DISCRETION AND RISK AND THAT YOU WILL BE SOLELY RESPONSIBLE FOR YOUR USE THEREOF AND ANY DAMAGES TO YOUR MOBILE DEVICE OR COMPUTER SYSTEM, LOSS OF DATA OR OTHER HARM OF ANY KIND THAT MAY RESULT.</p>\r\n\r\n                                <p>The Company reserves the right to change any and all Site Content, software and other items used or contained in the Site and any Services offered through the Site at any time without notice. Reference to any products, services, processes or other information, by trade name, trademark, manufacturer, supplier or otherwise does not constitute or imply endorsement, sponsorship or recommendation thereof, or any affiliation therewith, by Company.</p>\r\n\r\n                                <h6>Limitation on Liability</h6>\r\n\r\n                                <p>IN NO EVENT WILL COMPANY OR ITS DIRECTORS, EMPLOYEES OR AGENTS BE LIABLE TO CLIENT OR ANY THIRD PERSON FOR USER CONTENT OR CONTENT POSTED OR ANOTHER USER, OR ANY CLAIM RELATED THERETO. IN NO EVENT WILL COMPANY OR ITS DIRECTORS, EMPLOYEES OR AGENTS BE LIABLE TO YOU OR ANY THIRD PERSON FOR ANY INDIRECT, CONSEQUENTIAL, EXEMPLARY, INCIDENTAL, SPECIAL OR PUNITIVE DAMAGES, INCLUDING FOR ANY LOST PROFITS OR LOST DATA ARISING FROM YOUR USE OF THE SITE OR THE SERVICE, OR ANY OF THE SITE CONTENT OR OTHER MATERIALS ON, ACCESSED THROUGH OR DOWNLOADED FROM THE SITE, EVEN IF THE COMPANY IS AWARE OR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR SUCH DAMAGES WERE FORESEEABLE. NOTWITHSTANDING ANYTHING TO THE CONTRARY CONTAINED HEREIN, THE COMPANY\'S LIABILITY TO YOU FOR ANY CAUSE WHATSOEVER, AND REGARDLESS OF THE FORM OF THE ACTION, WILL AT ALL TIMES BE LIMITED TO THE AMOUNT PAID, IF ANY, BY YOU TO COMPANY FOR THE SERVICE DURING THE TERM OF MEMBERSHIP, AND IN NO CASE WILL THE COMPANY\'S LIABILITY TO YOU EXCEED $1000. YOU ACKNOWLEDGE THAT IF NO FEES ARE PAID TO COMPANY FOR THE SERVICE, YOUR REMEDIES SHALL BE LIMITED TO INJUNCTIVE RELIEF ONLY, UNLESS OTHERWISE PERMITTED BY LAW, AND SHALL NOT BE ENTITLED TO DAMAGES OF ANY KIND FROM COMPANY, REGARDLESS OF THE CAUSE OF ACTION.</p>\r\n\r\n                                <p>CERTAIN STATE LAWS DO NOT ALLOW LIMITATIONS ON IMPLIED WARRANTIES OR THE EXCLUSION OR LIMITATION OF CERTAIN DAMAGES. IF THESE LAWS APPLY TO YOU, SOME OR ALL OF THE ABOVE DISCLAIMERS, EXCLUSIONS OR LIMITATIONS MAY NOT APPLY TO YOU, AND YOU MAY HAVE ADDITIONAL RIGHTS.</p>\r\n\r\n                                <h6>Termination</h6>\r\n\r\n                                <p>The Company may terminate your membership, delete your profile and any User Content or information that you have posted on the Site and/or prohibit you from using or accessing the Service or the Site (or any portion, aspect or feature of the Service or the Site) for any reason, or no reason, at any time in its sole discretion, with or without notice, including without limitation if it believes that you do not meet the age requirements set forth above.</p>  \r\n\r\n                                <h6>Governing Law; Venue and Jurisdiction</h6>\r\n\r\n                                <p>By visiting or using the Site and/or the Service, you agree that the laws of the State of Indiana, without regard to principles of conflict of laws, will govern these Terms of Use and any dispute of any sort that might arise between you and the Company or any of our affiliates. With respect to any disputes or claims not subject to arbitration (as set forth below), you agree not to commence or prosecute any action in connection therewith other than in the state and federal courts situated in Marion County, Indiana, and you hereby consent to, and waive all defenses of lack of personal jurisdiction and forum non conveniens with respect to, venue and jurisdiction in the state and federal courts situated in Marion County, Indiana.</p>\r\n\r\n                                <h6>Dispute Resolution</h6>\r\n\r\n                                <p>YOU AND COMPANY AGREE THAT, EXCEPT AS MAY OTHERWISE BE PROVIDED IN REGARD TO SPECIFIC SERVICES ON THE SITE IN ANY SPECIFIC TERMS APPLICABLE TO THOSE SERVICES, THE SOLE AND EXCLUSIVE FORUM AND REMEDY FOR ANY AND ALL DISPUTES AND CLAIMS RELATING IN ANY WAY TO OR ARISING OUT OF THESE TERMS OF USE, THE SITE AND/OR THE SERVICE (INCLUDING YOUR VISIT TO OR USE OF THE SITE AND/OR THE SERVICE) SHALL BE FINAL AND BINDING ARBITRATION, except that, to the extent that either of us has in any manner infringed upon or violated or threatened to infringe upon or violate the other party\'s patent, copyright, trademark or trade secret rights, or you have otherwise violated any of the user conduct rules set forth above, then the parties acknowledge that arbitration is not an adequate remedy at law and that injunctive or other appropriate relief may be sought before, during or after the pendency of any arbitration proceeding brought pursuant to this Agreement, or in lieu of such proceedings.</p>\r\n\r\n                                <p>Arbitration under this Agreement shall be conducted by the American Arbitration Association (the "AAA") under its Commercial Arbitration Rules and, in the case of consumer disputes, the AAA\'s Supplementary Procedures for Consumer Related Disputes ( the "AAA Consumer Rules") (collectively the "AAA Rules"). The location of the arbitration and the allocation of costs and fees for such arbitration shall be determined in accordance with such AAA Rules and shall be subject to the limitations provided for in the AAA Consumer Rules (for consumer disputes) and in these Terms of Use. In rendering a decision, the arbitration panel shall follow the law of the United States and of the state of Indiana, and shall not use equitable or other principles which would permit the panel to ignore this Agreement or the law. The arbitration panel\'s award shall be binding and may be entered as a judgment in any court of competent jurisdiction, provided, however, that errors of law may be appealed to a court of competent jurisdiction for review. Any award in arbitration shall be subject to all dollar and other limitations set forth in this Agreement.</p>  \r\n\r\n                                <p>To the fullest extent permitted by applicable law, NO ARBITRATION OR CLAIM UNDER THESE TERMS OF USE SHALL BE JOINED TO ANY OTHER ARBITRATION OR CLAIM, INCLUDING ANY ARBITRATION OR CLAIM INVOLVING ANY OTHER CURRENT OR FORMER USER OF THE SERVICE, AND NO CLASS ARBITRATION PROCEEDINGS SHALL BE PERMITTED. In no event shall any claim, action or proceeding by you related in any way to the Site and/or the Service (including your visit to or use of the Site and/or the Service) be instituted more than one (1) year after the cause of action arose.</p>\r\n\r\n                                <h6>Indemnity</h6>\r\n\r\n                                <p>You shall indemnify and hold the Company, its subsidiaries and affiliates, and each of their directors, officers, agents, contractors, partners and employees, harmless from and against any loss, liability, claim, demand, damages, costs and expenses, including reasonable attorney\'s fees, arising out of or in connection with any User Content, any Third Party Applications, Software or Content you post or share on or through the Site, your use of the Service or the Site, your conduct in connection with the Service or the Site or with other users of the Service or the Site, or any violation of this Agreement or of any law or the rights of any third party.</p> \r\n\r\n                                <h6>Submissions</h6>\r\n\r\n                                <p>You acknowledge and agree that any questions, comments, suggestions, ideas, feedback or other information about the Site or the Service ("Submissions"), provided by you to Company are non-confidential and shall become the sole property of Company. Company shall own exclusive rights, including all intellectual property rights, and shall be entitled to the unrestricted use and dissemination of these Submissions for any purpose, commercial or otherwise, without acknowledgment or compensation to you.</p>\r\n\r\n                                <h6>Other</h6>\r\n\r\n                                <p>These Terms of Use constitute the entire agreement between you and Company regarding the use of the Site and/or the Service, superseding any prior agreements between you and Company relating to your use of the Site or the Service. The failure of Company to exercise or enforce any right or provision of these Terms of Use shall not constitute a waiver of such right or provision in that or any other instance. If any provision of this Agreement is held invalid, the remainder of this Agreement shall continue in full force and effect. If any provision of these Terms of Use shall be deemed unlawful, void or for any reason unenforceable, then that provision shall be deemed severable from these Terms of Use and shall not affect the validity and enforceability of any remaining provisions.</p>\r\n\r\n			</div>\r\n		</div>\r\n\r\n</div>'
}),define("views/text/translate-institution",["tools/pop-up-window","text!templates/text/terms-of-use.html"],function(e,t){return e.get("view").extend({className:"pop-up-window block-window-translate-institution",template:t})}),define("text!templates/common/pop-up-window/translate.html",[],function(){return'<div class="head">\r\n	<h4>Translate</h4>\r\n</div>\r\n<div class="main">\r\n	<form>\r\n		<div class="center">\r\n			<div class="title">\r\n				<span class="l-float">Source</span>\r\n				<select class="r-float" id="from_lang" name="">\r\n					<option value="">Please Select One</option>\r\n				</select>\r\n                <div class="clear"></div>\r\n			</div>\r\n			<div class="body">\r\n				<textarea id="input_text">{{text}}</textarea>\r\n			</div>\r\n		</div>\r\n		<div class="center">\r\n			<div class="title">\r\n				<span class="l-float">Translate <img id="img_loading" style="display: none;" src="img/com/frontend/loading/horizontal.gif"/></span>\r\n                <div id="to_lang_wrap"></div>\r\n				<select class="r-float" id="to_lang" name="">\r\n					<option value="">Please Select One</option>\r\n				</select>\r\n				<div class="clear"></div>\r\n			</div>\r\n			<div class="body">\r\n				<textarea id="output_text"></textarea>\r\n			</div>\r\n		</div>\r\n		<div class="bottom">\r\n			<p class="l-float">\r\n				This CN translation was sponsored by <a id="institution" href="javascript:;">your institution</a>.\r\n			</p>\r\n			<button class="r-float bt bt-red cancel" type="button">CLOSE</button>\r\n			<div class="clear"></div>\r\n		</div>\r\n	</form>\r\n</div>'}),define("views/common/pop-up-window/translate",["jquery","underscore","backbone","modules/translation","modules/user-translation-setting","modules/translation-language-detection","tools/pop-up-window","views/common/option","views/text/translate-institution","text!templates/common/pop-up-window/translate.html"],function(e,t,n,i,o,r,a,s,l,c){return a.get("view").extend({className:"block-window-translate pop-up-window",template:c,serialize:function(){return this.data},events:{"click .cancel":"deleted","change #from_lang":"changeFromLang","change #to_lang":"changeToLang","click #institution":"showInstitution"},showInstitution:function(){a.get("function").open((new l).render().view.el)},translate:function(e,t,n){var o=this;this.$("#img_loading").show();var r=new i;r.save({text:e,to_lang:t,from_lang:n},{resultTrue:function(e,t){o.$("#output_text").val(t.data.text)},resultFalse:function(){alert("The Source text is too long to translate.")},completeCallback:function(){o.$("#img_loading").hide()}})},translateSetting:function(e){var t=new o;t.save({lang:e},{resultTrue:function(){},resultFalse:function(){}})},changeFromLang:function(t){var n=e.trim(this.$(t.currentTarget).find("option:selected").val());n.length>0&&(this.fromLang=n)},changeToLang:function(t){var n=e.trim(this.$(t.currentTarget).find("option:selected").val()),i=e.trim(this.$("#input_text").val());n.length>0&&i.length>0&&(this.translate(i,n),this.translateSetting(n))},insertOption:function(t){var n=this,i=new o;i.fetch({resultTrue:function(i,o){for(var r in t){var a=new s({attrs:{display_value:t[r].language,display_name:t[r].name}}),l=new s({attrs:{display_value:t[r].language,display_name:t[r].name},params:{selected:o.data.lang}});this.$("#from_lang").append(a.render().view.el),this.$("#to_lang").append(l.render().view.el)}var c=e.trim(this.$("#input_text").val());o.data.lang.length>0&&c.length>0&&n.translate(c,o.data.lang)},resultFalse:function(){for(var e in t){var n=new s({attrs:{display_value:t[e].language,display_name:t[e].name}}),i=new s({attrs:{display_value:t[e].language,display_name:t[e].name}});this.$("#from_lang").append(n.render().view.el),this.$("#to_lang").append(i.render().view.el)}}})},afterRender_:function(){var e=[{language:"af",name:"Afrikaans"},{language:"sq",name:"Albanian"},{language:"ar",name:"Arabic"},{language:"be",name:"Belarusian"},{language:"bg",name:"Bulgarian"},{language:"ca",name:"Catalan"},{language:"zh",name:"Chinese (Simplified)"},{language:"zh-CN",name:"Chinese (Simplified)"},{language:"zh-TW",name:"Chinese (Traditional)"},{language:"hr",name:"Croatian"},{language:"cs",name:"Czech"},{language:"da",name:"Danish"},{language:"nl",name:"Dutch"},{language:"en",name:"English"},{language:"eo",name:"Esperanto"},{language:"et",name:"Estonian"},{language:"tl",name:"Filipino"},{language:"fi",name:"Finnish"},{language:"fr",name:"French"},{language:"gl",name:"Galician"},{language:"de",name:"German"},{language:"el",name:"Greek"},{language:"ht",name:"Haitian Creole"},{language:"iw",name:"Hebrew"},{language:"hi",name:"Hindi"},{language:"hu",name:"Hungarian"},{language:"is",name:"Icelandic"},{language:"id",name:"Indonesian"},{language:"ga",name:"Irish"},{language:"it",name:"Italian"},{language:"ja",name:"Japanese"},{language:"ko",name:"Korean"},{language:"lv",name:"Latvian"},{language:"lt",name:"Lithuanian"},{language:"mk",name:"Macedonian"},{language:"ms",name:"Malay"},{language:"mt",name:"Maltese"},{language:"no",name:"Norwegian"},{language:"fa",name:"Persian"},{language:"pl",name:"Polish"},{language:"pt",name:"Portuguese"},{language:"ro",name:"Romanian"},{language:"ru",name:"Russian"},{language:"sr",name:"Serbian"},{language:"sk",name:"Slovak"},{language:"sl",name:"Slovenian"},{language:"es",name:"Spanish"},{language:"sw",name:"Swahili"},{language:"sv",name:"Swedish"},{language:"th",name:"Thai"},{language:"tr",name:"Turkish"},{language:"uk",name:"Ukrainian"},{language:"vi",name:"Vietnamese"},{language:"cy",name:"Welsh"},{language:"yi",name:"Yiddish"}],t="";if(this.insertOption(e),this.data.text.length>0){var n=50>this.data.text.length?this.data.text.length:50;t=this.data.text.substr(0,n)}var i=this,o=new r;o.addUrlParam({text:t}),o.fetch({resultTrue:function(e,t){i.$("#from_lang").find('option[value="'+t.data.lang+'"]').prop("selected",!0)}})}})}),define("text!templates/content/relation/comment-operation.html",[],function(){return'\r\n	<ul>\r\n		<li>\r\n			{{#has_set_good}}\r\n			<a class="unlike" href="javascript:;">Unlike</a>\r\n			{{/has_set_good}}\r\n			{{^has_set_good}}\r\n				<a class="like" href="javascript:;">Like</a>\r\n			{{/has_set_good}}\r\n			({{#count_good}}<a class="font-bold load_comment_like_users_window" href="javascript:;">{{count_good}}</a>{{/count_good}}{{^count_good}}<b>{{count_good}}</b>{{/count_good}}),\r\n		</li>\r\n		<li>\r\n			<a class="comment_reflect" href="javascript:;">\r\n				Reflect\r\n			</a>\r\n			(<b class="count_comment {{#count_comment}}font-bold{{/count_comment}}">{{count_comment}}</b>)\r\n			{{#count_comment}}\r\n            <a class="operation_sub_comments text-hide icon-blue-down" href="javascript:;" title="Show Comments" data-off="1">\r\n				&darr;\r\n			</a>\r\n            {{/count_comment}}\r\n            ,\r\n		</li>\r\n		{{#can_set_best}}\r\n		<li>\r\n			{{#has_set_best}}\r\n			<a class="unbest" href="javascript:;">\r\n				Unbest\r\n			</a>\r\n			{{/has_set_best}}\r\n			{{^has_set_best}}\r\n				{{#has_one_set_best}}\r\n				<em>\r\n					Best\r\n				</em>\r\n				{{/has_one_set_best}}\r\n				{{^has_one_set_best}}\r\n				<a class="best" href="javascript:;">\r\n					Best\r\n				</a>\r\n				{{/has_one_set_best}}\r\n			{{/has_set_best}}\r\n			(<b {{#count_best}}class="font-bold"{{/count_best}}>{{count_best}}</b>),\r\n		</li>\r\n		{{/can_set_best}}\r\n		<li>\r\n			<a class="laod_translate_comment_window" href="javascript:;">\r\n				Translate{{#is_owner}},{{/is_owner}}\r\n			</a>\r\n		</li>\r\n		{{#is_owner}}\r\n		<li>\r\n			<a class="delete_comment" href="javascript:;">\r\n				Delete\r\n			</a>\r\n		</li>\r\n		{{/is_owner}}\r\n	</ul>\r\n'}),define("views/content/relation/comment-operation",["jquery","underscore","backbone","tools/pop-up-window","tools/view/content-tools","modules/content/sub-comment","modules/content/comment-good","modules/content/comment-best","collections/content/comment-goods","views/content/relation/comment-reflection","views/common/pop-up-window/translate","text!templates/content/relation/comment-operation.html"],function(e,t,n,i,o,r,a,s,l,c,d,u){var m=i.get("function");return n.View.extend({className:"block-post-operate",template:u,initialize:function(e){t.bindAll(this,"resetComment"),this.model.on("change:count_comment",this.resetComment,this),this.model.on("change:count_good",this.render,this),this.model.on("change:count_best",this.render,this),this.parent=e.parent,this.data=e.data||{}},serialize:function(){return{count_comment:this.model.get("count_comment"),count_good:this.model.get("count_good"),count_best:this.model.get("count_best"),has_set_good:this.model.get("has_set_good"),has_set_best:this.model.get("has_set_best"),is_owner:this.model.get("is_owner"),can_set_best:this.data.content&&this.data.content.get("can_set_best"),has_one_set_best:this.data.hasOneSetBest}},events:{"click .like":"setLike","click .unlike":"unLike","click .best":"setBest","click .unbest":"unBest","click .delete_comment":"deleted","click .comment_reflect":"insertReflectionForm","click .operation_sub_comments":"operationSubComments","click .laod_translate_comment_window":"laodTranslateWindow","click .load_comment_like_users_window":"loadLikeUsersWindow"},operationSubComments:function(t){var n=e(t.currentTarget).attr("data-off");"1"==n?this.model.get("count_comment")&&(this.data.subComments.addUrlParam({content_comment_id:this.model.get("id"),with_content_comment_user:1,with_user_profile:1,with_user_country:1}),this.data.subComments.fetch({resultTrue:function(){e(t.currentTarget).attr({"data-off":"0",title:"Hide Comments"}),e(t.currentTarget).html("&uarr;").removeClass("icon-blue-down").addClass("icon-blue-up")}})):this.data.subComments.clear(function(){e(t.currentTarget).attr({"data-off":"1",title:"Show Comments"}),e(t.currentTarget).html("&darr;").removeClass("icon-blue-up").addClass("icon-blue-down")})},resetComment:function(){this.$(".count_comment").html(this.model.get("count_comment"))},deleted:function(){var e=this;m.confirm({content:"Are you sure you want to delete this reflection?",yesCallBack:function(){e.model.deleted({success:function(){e.data.content instanceof n.Model&&e.data.content.set("count_comment",e.data.content.get("count_comment")-1),e.data.comments instanceof n.Collection&&e.data.comments.trigger("remove")}})}})},setLike:function(t){if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var n=this,i=new a;i.save({content_comment_id:n.model.get("id")},{resultTrue:function(){n.model.set("has_set_good",1),n.model.set("count_good",n.model.get("count_good")+1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})},unLike:function(t){if(this.model.get("has_set_good")){if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var n=this;n.good=new a({id:n.model.get("id")}),n.good.destroy({resultTrue:function(){n.model.set("has_set_good",0),n.model.set("count_good",n.model.get("count_good")-1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})}},setBest:function(t){if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var n=this,i=new s;i.save({content_comment_id:n.model.get("id")},{resultTrue:function(){n.model.set("has_set_best",1),n.model.set("count_best",n.model.get("count_best")+1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})},unBest:function(t){if(this.model.get("has_set_best")){if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var n=this;n.best=new s({id:n.model.get("id")}),n.best.destroy({resultTrue:function(){n.model.set("has_set_best",0),n.model.set("count_best",n.model.get("count_best")-1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})}},insertReflectionForm:function(){var e=this;e.parent.$(".block_comment_reflection").html(new c({commentId:e.model.get("id"),data:{model:e.model},_model:r,collection:e.data.subComments}).render().view.el)},laodTranslateWindow:function(){var t=this;m.open(new d({data:{text:e.trim(t.parent.$(".translate_comment_text").text())}}).render().view.el)},loadLikeUsersWindow:function(){var e=new l;e.addUrlParam({content_comment_id:this.model.get("id")}),o.loadLikeUsersWindow(e)}})}),define("text!templates/content/relation/sub-comment-operation.html",[],function(){return'<ul>\r\n	<li>\r\n		{{#has_set_good}}\r\n		<a class="unlike" href="javascript:;">Unlike</a>\r\n		{{/has_set_good}}\r\n		{{^has_set_good}}\r\n			<a class="like" href="javascript:;">Like</a>\r\n		{{/has_set_good}}\r\n		({{#count_good}}<a class="font-bold load_sub_comment_like_users_window" href="javascript:;">{{count_good}}</a>{{/count_good}}{{^count_good}}<b>{{count_good}}</b>{{/count_good}}),\r\n	</li>\r\n	{{#can_set_best}}\r\n	<li>\r\n		<a class="not_completed" href="javascript:;">\r\n			Best\r\n		</a>\r\n		(<b>{{best}}</b>),\r\n	</li>\r\n	{{/can_set_best}}\r\n	<li>\r\n		<a class="laod_translate_s_coment_window" href="javascript:;">\r\n			Translate{{#is_owner}},{{/is_owner}}\r\n		</a>\r\n	</li>\r\n	{{#is_owner}}\r\n	<li>\r\n		<a class="delete_sub_comment" href="javascript:;">\r\n			Delete\r\n		</a>\r\n	</li>\r\n	{{/is_owner}}\r\n</ul>\r\n'}),define("views/content/relation/sub-comment-operation",["jquery","underscore","backbone","tools/pop-up-window","tools/view/content-tools","collections/content/comment-goods","modules/content/comment-good","views/common/pop-up-window/translate","text!templates/content/relation/sub-comment-operation.html"],function(e,t,n,i,o,r,a,s,l){var c=i.get("function");return n.View.extend({className:"block-post-operate",template:l,serialize:function(){return{count_good:this.model.get("count_good"),has_set_good:this.model.get("has_set_good"),is_owner:this.model.get("is_owner"),can_set_best:0}},initialize:function(e){this.data=e.data,this.view=e.view,this.model.on("change:count_good",this.render,this)},events:{"click .like":"setLike","click .unlike":"unLike","click .delete_sub_comment":"deleted","click .laod_translate_s_coment_window":"laodTranslateWindow","click .load_sub_comment_like_users_window":"loadLikeUsersWindow"},deleted:function(){var e=this;c.confirm({content:"Are you sure you want to delete this reflection?",yesCallBack:function(){e.model.deleted({success:function(){e.data.comment.set("count_comment",e.data.comment.get("count_comment")-1)}})}})},setLike:function(t){var n=this;if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var i=new a;i.save({content_comment_id:n.model.get("id")},{resultTrue:function(){n.model.set("has_set_good",1),n.model.set("count_good",n.model.get("count_good")+1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})},unLike:function(t){if(this.model.get("has_set_good")){if(e(t.currentTarget).attr("locked"))return!1;e(t.currentTarget).attr("locked","locked");var n=this,i=new a({id:n.model.get("id")});i.destroy({resultTrue:function(){n.model.set("has_set_good",0),n.model.set("count_good",n.model.get("count_good")-1)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})}},laodTranslateWindow:function(){var t=e.trim(this.view.parent.$(".translate_s_comment_text").text());c.open(new s({data:{text:t}}).render().view.el)},loadLikeUsersWindow:function(){var e=new r;e.addUrlParam({content_comment_id:this.model.get("id")}),o.loadLikeUsersWindow(e)}})}),define("text!templates/content/relation/sub-comment.html",[],function(){return'<div class="block-post-comment-item block-post-comment-sub-item block_post_comment_sub_item">\r\n	{{#user}}\r\n	<div class="sidebar l-float">\r\n		{{#avatar}}\r\n		<a class="avatar avatar-34 show_avatar link_bypass" href="{{view_url}}" title="{{display_name}}">\r\n			<img class="avatar_url_{{user.id}}" src="{{view_url}}" alt="{{display_name}}" title="{{fullname}}" />\r\n		</a>\r\n		{{/avatar}}\r\n	</div>\r\n	{{/user}}\r\n	<div class="content l-float">\r\n		<div class="block-post-relations block_sub_comment_relations">\r\n			{{#user}}\r\n				<div class="item">\r\n                    <div class="title">\r\n                        <a class="show_card" href="{{cn_number}}" data-type="user" data-id="{{id}}">\r\n                            {{display_name}}\r\n                        </a>\r\n                        <span class="comma _comma">,</span>\r\n                        <div class="clear"></div>\r\n                    </div>\r\n				</div>\r\n            {{/user}}\r\n            {{#user}}\r\n                {{#profile}}\r\n                    {{#position}}\r\n                        {{#school_name}}\r\n                        <div class="item">\r\n                            <div class="title">\r\n                                <a class="link_bypass" {{#web_address}}href="{{web_address}}"{{/web_address}} target="_blank" title="{{school_name}}">\r\n                                    {{school_name}}\r\n                                </a>\r\n                                <span class="comma _comma">,</span>\r\n                                <div class="clear"></div>\r\n                            </div>\r\n                        </div>\r\n                        {{/school_name}}\r\n                    {{/position}}\r\n                {{/profile}}\r\n				{{#country}}\r\n                {{#flag_url}}\r\n				<a class="r-float flag-s">\r\n					<img src="{{flag_url}}" title="{{name}}" alt="{{name}}" />\r\n				</a>\r\n                {{/flag_url}}\r\n				{{/country}}\r\n			{{/user}}\r\n			<span class="r-float time">\r\n				[{{display_time}}]\r\n			</span>\r\n			<div class="clear"></div>\r\n		</div>\r\n		<div class="body">\r\n			<div class="break-word translate_s_comment_text">\r\n				{{{text}}}\r\n			</div>\r\n		</div>\r\n		<div class="block-post-sub-comment-wrap">\r\n			<div class="operate visibility-hidden sub_comment_count content_operate">\r\n				\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div class="clear"></div>\r\n</div>\r\n'}),define("views/content/relation/sub-comment",["jquery","underscore","backbone","views/content/relation/sub-comment-operation","text!templates/content/relation/sub-comment.html"],function(e,t,n,i,o){return n.View.extend({tagName:"li",template:o,serialize:function(){return this.model.toJSON()},initialize:function(e){this.data=e.data,this.model.view=this},beforeRender:function(){var e=this;this.setViews({".sub_comment_count":new i({model:this.model,data:{comment:e.data.comment},view:{parent:e}})})},afterRender:function(){this.$(".block_sub_comment_relations").find("._comma").last().remove()}})}),define("views/content/relation/sub-comments",["jquery","underscore","backbone","views/content/relation/sub-comment"],function(e,t,n,i){return n.View.extend({tagName:"ul",initialize:function(e){t.bindAll(this,"add","appOne","preOne","addAll"),this.collection.on("add",this.appOne,this),this.collection.on("reset",this.addAll,this),this.data=e.data,this.collection.view=this},addAll:function(){this.$el.empty(),this.collection.each(this.appOne)},add:function(e){var t=new i({model:e,data:{comment:this.data.comment}});return t},appOne:function(e){this.$el.append(this.add(e).render().view.el)},preOne:function(e){this.$el.prepend(this.add(e).render().view.el)}})}),define("collections/content/comment-comments",["jquery","underscore","backbone","modules/content/sub-comment"],function(e,t,n,i){return n.Collection.extend({model:i,urlRoot:"/api/content_sub_comment/",allowSetBest:function(){return this.length>3},clear:function(t){this.reset({silent:!0}),this.view.$el.empty(),e.isFunction(t)&&t()}})}),define("tools/summary-show-more",["jquery"],function(e){var t=function(){var t=this;this.defaults={contentObj:"",defaultHeight:96,isMix:!0},this.init=function(n){return t.settings=e.extend(!0,{},t.defaults,n),t},this.getButtonHtml=function(){return'<div class="show_more_button_wrapper" style="font-size: 14px; text-align: right; padding:5px;"><a class="summary_text_slide_up" href="javascript:;" style="display:none;">&uarr; slide up</a><a class="summary_text_show_more" href="javascript:;">...more</a></div>'},this.getPart1=function(e){return e&&e.indexOf("<br>")?e.substr(0,e.indexOf("<br>")):""},this.getPart2=function(e){return e&&e.indexOf("<br>")?e.substr(e.indexOf("<br>"),e.length):""},this.hasAttachment=function(){return e(t.settings.contentObj).find(".item_attachments_image_and_video").length>0},this.breakText=function(n){if(t.settings.isMix&&t.hasAttachment()){var i=e(t.settings.contentObj).find(".block_content_wrap"),o=i.find(".summary_text").html();o&&o.indexOf("<br>")>0&&(i.find(".summary_text").html(t.getPart1(o)),e(t.settings.contentObj).find(".item_attachments_image_and_video").css({"float":"left"}),e(t.settings.contentObj).append('<div class="summary_extra_text translate_text break-word" style="font-size: 1.4em; line-height: 16px;">'+t.getPart2(o)+'</div><div class="clear"></div'))}"function"==typeof n&&n()},this.getAttachmentHeight=function(){return t.hasAttachment()&&t.settings.isMix?e(t.settings.contentObj).find(".item_attachments_image_and_video").height()-5:0},this.getSummaryExtraText=function(){return t.settings.isMix&&e(t.settings.contentObj).find(".summary_extra_text").length>0?e(t.settings.contentObj).find(".summary_extra_text").height():0},this.insert=function(){e(t.settings.contentObj).after(t.getButtonHtml())},this.bindButton=function(){e(t.settings.contentObj).siblings(".show_more_button_wrapper").find(".summary_text_slide_up").click(function(){e(t.settings.contentObj).animate({height:t.settings.defaultHeight,overflow:"hidden"},500,"swing"),e(this).hide(),e(this).parent().find(".summary_text_show_more").show()}),e(t.settings.contentObj).siblings(".show_more_button_wrapper").find(".summary_text_show_more").click(function(){e(t.settings.contentObj).animate({height:e(t.settings.contentObj).attr("origin_height")},500,"swing"),e(this).hide(),e(this).parent().find(".summary_text_slide_up").show()})},this.removeButton=function(){e(t.settings.contentObj).siblings(".show_more_button_wrapper").remove()},this.setContentHeight=function(){e(t.settings.contentObj).attr({origin_height:t.originHeight}).css({height:t.settings.defaultHeight,overflow:"hidden"})},this.afterLoadTarget=function(n,i,o){var r=0,a=function(){setTimeout(function(){e(n).length>0&&t.settings.defaultHeight<e(n).height()?"function"==typeof i&&i():100>r&&(++r,a())},o)};a()},this.run=function(){t.afterLoadTarget(t.settings.contentObj,function(){t.settings.attachmentHeight=t.getAttachmentHeight();var n=e(t.settings.contentObj),i=n.height();t.originHeight=i;var o=t.settings.defaultHeight;i>o+t.settings.attachmentHeight&&(t.setContentHeight(),t.insert(),t.bindButton())},300),t.afterLoadTarget(e(t.settings.contentObj).find(".item_attachments_image_and_video"),function(){t.breakText(function(){t.settings.attachmentHeight=t.getAttachmentHeight(),t.settings.defaultHeight=t.settings.attachmentHeight+e(t.settings.contentObj).find(".block_content_wrap").height(),t.originHeight=t.getSummaryExtraText()+e(t.settings.contentObj).find(".block_content_wrap").height(),t.settings.defaultHeight>t.originHeight&&t.removeButton(),t.setContentHeight(),t.bindButton()})},300)}};return{init:function(e){(new t).init(e).run()}}}),define("text!templates/content/relation/comment.html",[],function(){return'<div class="block-post-comment-item block_post_comment_item">\r\n	{{#user}}\r\n	<div class="sidebar l-float">\r\n		{{#avatar}}\r\n		<a class="avatar avatar-34 show_avatar link_bypass" href="{{view_url}}" title="{{display_name}}">\r\n			<img class="avatar_url_{{user.id}}" src="{{view_url}}" alt="{{display_name}}" title="{{fullname}}" />\r\n		</a>\r\n		{{/avatar}}\r\n        <b>{{cn_number}}</b>\r\n	</div>\r\n	{{/user}}\r\n	<div class="content l-float">\r\n		<div class="block-post-relations block_comment_relations">\r\n			{{#user}}\r\n			<div class="item">\r\n                <div class="title">\r\n                    <a class="show_card" href="{{cn_number}}" data-type="user" data-id="{{id}}">\r\n                        {{display_name}}\r\n                    </a>\r\n                    <span class="comma _comma">,</span>\r\n                    <div class="clear"></div>\r\n                </div>\r\n			</div>\r\n			{{/user}}\r\n            {{#user}}\r\n                {{#profile}}\r\n                    {{#position}}\r\n                        {{#school_name}}\r\n                        <div class="item">\r\n                            <div class="title">\r\n                                <a class="link_bypass" {{#web_address}}href="{{web_address}}"{{/web_address}} target="_blank" title="{{school_name}}">\r\n                                    {{school_name}}\r\n                                </a>\r\n                                <span class="comma _comma">,</span>\r\n                                <div class="clear"></div>\r\n                            </div>\r\n                        </div>\r\n                        {{/school_name}}\r\n                    {{/position}}\r\n                {{/profile}}\r\n                {{#country}}\r\n                {{#flag_url}}\r\n                <a class="r-float flag-s">\r\n					<img src="{{flag_url}}" title="{{name}}" alt="{{name}}" />\r\n				</a>\r\n                {{/flag_url}}\r\n				{{/country}}\r\n			{{/user}}\r\n			<span class="r-float time">\r\n				[{{display_time}}]\r\n			</span>\r\n			<div class="clear"></div>\r\n		</div>\r\n		<div class="body">\r\n			<div class="break-word translate_comment_text">\r\n				{{{text}}}\r\n			</div>\r\n		</div>\r\n		<div class="block-post-sub-comment-wrap">\r\n			<div class="operate visibility-hidden comment_count content_operate">\r\n	\r\n			</div>\r\n			<div class="reflect">\r\n				<div class="head">\r\n					<div class="block-post-comment-list block-post-comment-sub-list block_post_sub_comment_list">\r\n					</div>\r\n				</div>\r\n				<div class="foot block_comment_reflection">\r\n					\r\n				</div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div class="clear"></div>\r\n</div>\r\n'}),define("views/content/relation/comment",["jquery","underscore","backbone","views/content/relation/comment-operation","views/content/relation/sub-comments","collections/content/comment-comments","tools/summary-show-more","text!templates/content/relation/comment.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({tagName:"li",template:s,serialize:function(){return this.model.toJSON()},initialize:function(e){this.pass=e.pass||{},this.model.view=this},events:{"mouseenter .block_post_comment_item":"displayOperate","mouseleave .block_post_comment_item":"hideOperate"},beforeRender:function(){var e=new r;this.setViews({".block_post_sub_comment_list":new o({collection:e,data:{comment:this.model}}),".comment_count":new i({model:this.model,parent:this,data:t.extend(this.pass,{subComments:e})})})},afterRender:function(){this.$(".block_comment_relations").find("._comma").last().remove(),a.init({contentObj:this.$(".translate_comment_text"),defaultHeight:65})},displayOperate:function(e){this.$(e.currentTarget).find(".content_operate").css("visibility","visible")},hideOperate:function(e){this.$(e.currentTarget).find(".content_operate").css("visibility","hidden")}})}),define("text!templates/common/home-head/alert-box/quick-look.html",[],function(){return'<span class="text-hide arrow icon-float-tip-arrow-5-quick-look">Arrow</span>\n<a class="text-hide bt-close-17-left bt-close-17 hide_float_box" href="javascript:;" title="close">Close</a>\n<div class="main">\n    <div class="center _center">\n        <div class="block-post-comment-list block_post_comment_list">\n            <ul class="_list">\n                \n            </ul>\n        </div>\n        <div class="error-wrap _error">\n            \n        </div>\n    </div>\n</div>\n\n'}),define("views/common/home-head/alert-box/notification/quick-look",["jquery","underscore","backbone","text!templates/common/home-head/alert-box/quick-look.html"],function(e,t,n,i){return n.View.extend({className:"float-box block-float-down-box float-box-quick-look",template:i,initialize:function(){},afterRender:function(){var e=this.model.view;this.$("._list").append(e.render().view.el)}})}),define("text!templates/common/home-head/alert-box/item/notification/item-others-add-content-comment.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>reflected</b> on a <a href="content/view/{{value.id}}">{{value.type}}</a> you also <b>reflected</b> on.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>reflected</b> on a {{type}} you also <b>reflected</b> on\n            , but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        {{^value.content_comment_id}}\n            <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n        {{/value.content_comment_id}}\n        {{#value.content_comment_id}}\n            <a class="bt bt-blue bt-agree r-float quick_look" href="javascript:;" data-id="{{value.content_comment_id}}">VIEW</a>\n        {{/value.content_comment_id}}\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/others-add-content-comment",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","views/content/relation/comment","views/content/relation/sub-comment","views/common/home-head/alert-box/notification/quick-look","modules/content/comment","text!templates/common/home-head/alert-box/item/notification/item-others-add-content-comment.html"],function(e,t,n,i,o,r,a,s,l){_cache={};var c=n.View.extend({className:"message-wrap",template:l,events:{"click .quick_look":"showQuickLook"},serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};if(o){var l=this.model.get("extra_data");l&&l[1]&&(s.value.content_comment_id=l[1].value.id)}return s},initialize:function(e){this.parent={},e&&e.parent&&(this.parent=e.parent)},showQuickLook:function(n){var i=e(n.currentTarget),l=this.parent.$(".quick_look_wrap"),c=i.attr("data-id"),d={};if(c in _cache)d=_cache[c];else{d=new s;var u=this.model.get("extra_data"),m=t.first(this.model.get("users"));for(var h in u)if("content_comment"==u[h].data_model_name){d.set(u[h].value),d.set({user:m});var p=d.get("count");for(var f in p)d.set("count_"+f,p[f]);d.view=""==d.get("parent_id")?new o({model:d}):new r({model:d,data:{comment:new s}});break}_cache[d.get("id")]=d}var v=function(e){var t=i.closest("li").position().top,n=new a({model:e});l.attr({"data-id":e.get("id")}).css({top:t}).html(n.render().view.el).animate({left:-l.width()-10,opacity:1},"slow")};0==l.css("opacity")?v(d):l.animate({left:"+10px",opacity:0},"slow",function(){l.attr("data-id")!=d.get("id")&&v(d)})}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new c(this.options))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-system-message.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a> {{/first_user}}{{value}}.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a> {{/first_user}}sent you a system message\n            , but this message has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    <a class="bt bt-blue bt-agree r-float check_notification" href="user/notification/{{id}}">View</a>\n    <div class="clear"></div>\n</div>'
}),define("views/common/home-head/alert-box/notification/items/system-message",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-system-message.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-join-conexus.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>joined</b> your Conexus.\n            <a href="{{value.conexus_id}}">{{value.name}}</a>\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>joined</b> your Conexus.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.conexus_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/join-conexus",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-join-conexus.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-accept-course-invite.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>accepted</b> your invitation to join the Course \n        {{#value}}<a href="{{value.course_id}}">({{value.name}})</a>{{/value}}.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.course_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/accept-course-invite",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-accept-course-invite.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-accept-conexus-invite.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>accepted</b> your invitation to join the Conexus \n        {{#value}}<a href="{{value.conexus_id}}">({{value.name}})</a>{{/value}}.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.course_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/accept-conexus-invite",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-accept-conexus-invite.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-join-course.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>joined</b> your Course.\n            <a href="{{value.course_id}}">{{value.name}}</a>\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>joined</b> your Course.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.course_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/join-course",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-join-course.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-submit-quiz.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} {{value.text}}.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} send you a system message\n            , but this message has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/submit-quiz",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-submit-quiz.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-publish-quiz.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>published</b> a <a href="content/view/{{value.id}}">quiz</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>published</b> a quiz\n            , but this quiz has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/publish-quiz",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-publish-quiz.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-expired-remind.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value.assignment}}\n            The <a href="content/view/{{id}}">task</a> {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} created in {{#value.model}}<a href="{{#conexus_id}}{{conexus_id}}{{/conexus_id}}{{#course_id}}{{course_id}}{{/course_id}}">{{name}}</a>{{/value.model}} is <b>approaching</b>.\n        {{/value.assignment}}\n        {{#value.event}}\n            The <a href="content/view/{{id}}">event</a> {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} created in {{#value.model}}<a href="{{#conexus_id}}{{conexus_id}}{{/conexus_id}}{{#course_id}}{{course_id}}{{/course_id}}">{{name}}</a>{{/value.model}} is <b>coming</b> due.\n        {{/value.event}}\n        {{^value}}\n            Your {{type}} is <b>coming</b> due, but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value.assignment}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{id}}">View</a>\n    {{/value.assignment}}\n    {{#value.event}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{id}}">View</a>\n    {{/value.event}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/expired-remind",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-expired-remind.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a},l={};return this.model.get("extra_data").length>1&&(l=t.last(this.model.get("extra_data"))),s.value="assignment"==o.data_model_name?{assignment:o.value,model:l.value}:"event"==o.data_model_name?{event:o.value,model:l.value}:[],s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-grade-quiz.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>graded</b> your <a href="content/view/{{value.id}}">quiz</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>graded</b> your quiz\n            , but this quiz has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/grade-quiz",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-grade-quiz.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-accept-join-course.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>accepts</b> your request to join the Course \n        {{#value}}<a href="{{value.course_id}}">({{value.name}})</a>{{/value}}.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.course_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/accept-join-course",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-accept-join-course.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-mentioned.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>mentioned</b> you in a <a href="content/view/{{value.id}}">{{value.type}}</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>mentioned</b> you in a <b>{{type}}</b>\n            , but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/mentioned",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-mentioned.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-after-register.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} Hello, new CN member!\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    <a class="bt bt-blue bt-agree r-float check_notification" href="{{first_user.cn_number}}">View</a>\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/after-register",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-after-register.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-add-content-comment.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>reflected</b> on your <a href="content/view/{{value.id}}">{{value.type}}</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>reflected</b> on your {{type}}, but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        {{^value.content_comment_id}}\n            <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n        {{/value.content_comment_id}}\n        {{#value.content_comment_id}}\n            <a class="bt bt-blue bt-agree r-float quick_look" href="javascript:;" data-id="{{value.content_comment_id}}">VIEW</a>\n        {{/value.content_comment_id}}\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/add-content-comment",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","views/content/relation/comment","views/content/relation/sub-comment","views/common/home-head/alert-box/notification/quick-look","modules/content/comment","text!templates/common/home-head/alert-box/item/notification/item-add-content-comment.html"],function(e,t,n,i,o,r,a,s,l){var c={},d=n.View.extend({className:"message-wrap",template:l,events:{"click .quick_look":"showQuickLook"},serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};if(o){var l=this.model.get("extra_data");l&&l[1]&&(s.value.content_comment_id=l[1].value.id)}return s},initialize:function(e){this.parent={},e&&e.parent&&(this.parent=e.parent)},showQuickLook:function(n){var i=e(n.currentTarget),l=this.parent.$(".quick_look_wrap"),d=i.attr("data-id"),u={};if(d in c)u=c[d];else{u=new s;var m=this.model.get("extra_data"),h=t.first(this.model.get("users"));for(var p in m)if("content_comment"==m[p].data_model_name){u.set(m[p].value),u.set({user:h});var f=u.get("count");for(var v in f)u.set("count_"+v,f[v]);u.view=""==u.get("parent_id")?new o({model:u}):new r({model:u,data:{comment:new s}});break}c[u.get("id")]=u}var _=function(e){var t=i.closest("li").position().top,n=new a({model:e});l.attr({"data-id":e.get("id")}).css({top:t}).html(n.render().view.el).animate({left:-l.width()-10,opacity:1},"slow")};0==l.css("opacity")?_(u):l.animate({left:"+10px",opacity:0},"slow",function(){l.attr("data-id")!=u.get("id")&&_(u)})}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new d(this.options))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-accept-colleague.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>accepted</b> your colleague request.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    <a class="bt bt-blue bt-agree r-float check_notification" href="{{first_user.cn_number}}">View</a>\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/accept-colleague",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-accept-colleague.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-add-attachment-comment.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>reflected</b> on your attachment.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/attachment/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/add-attachment-comment",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-add-attachment-comment.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-answer-survey.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>answered</b> your <a href="content/view/{{value.id}}">survey</a>.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} <b>answered</b> your survey\n            , but this survey has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/answer-survey",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-answer-survey.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-others-like-content.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>liked</b> a <a href="content/view/{{value.id}}">{{value.type}}</a> you <b>reflected</b> on.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>liked</b> a {{type}} you <b>reflected</b> on\n            , but this {{type}} has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/view/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/others-like-content",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-others-like-content.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-inform-instructor-handle-join-course.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>requests</b> to join your Course.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="{{value.course_id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'
}),define("views/common/home-head/alert-box/notification/items/inform-instructor-handle-join-course",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-inform-instructor-handle-join-course.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-like-attachment.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>liked</b> your attachment.\n        {{/value}}\n        {{^value}}\n            {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>{{/first_user}} <b>liked</b> your attachment\n            , but this attachment has been deleted.\n        {{/value}}\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    {{#value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="content/attachment/{{value.id}}">View</a>\n    {{/value}}\n    {{^value}}\n        <a class="bt bt-blue bt-agree r-float check_notification" href="user">View</a>\n    {{/value}}\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/like-attachment",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-like-attachment.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/item/notification/item-add-follow.html",[],function(){return'<div class="main main-notification">\n    <div class="center">\n        {{#first_user}}<a href="{{cn_number}}">{{display_name}}</a>,{{/first_user}} is now <b>following</b> you.\n    </div>\n    <div class="bottom">\n        <span>{{display_time}}</span>\n    </div>\n</div>\n<div class="foot display-none display_operation">\n    <a class="bt bt-gray r-float delete_notification" href="javascript:;">CLEAR</a>\n    <a class="bt bt-blue bt-agree r-float check_notification" href="{{first_user.cn_number}}">View</a>\n    <div class="clear"></div>\n</div>'}),define("views/common/home-head/alert-box/notification/items/add-follow",["jquery","underscore","backbone","views/common/home-head/alert-box/notification/items/master_","text!templates/common/home-head/alert-box/item/notification/item-add-follow.html"],function(e,t,n,i,o){var r=n.View.extend({className:"message-wrap",template:o,serialize:function(){var e=t.first(this.model.get("users")),n=this.model.get("display_time"),i=this.model.get("id"),o=t.first(this.model.get("extra_data")),r="";t.isUndefined(o)||(r=o.data_model_name);var a=[];t.isUndefined(o)||!t.has(o,"value")||t.isEmpty(o.value)||(a=o);var s={id:i,first_user:e,display_time:n,type:r,value:a};return s}});return i.extend({beforeRender_:function(){this.insertView(".block_message_wrap",new r({model:this.model}))}})}),define("text!templates/common/home-head/alert-box/index/notification.html",[],function(){return'    <span class="text-hide icon-float-tip-arrow">\r\n        Arrow\r\n    </span>\r\n    <a class=" text-hide bt-close-17 close_box" href="javascript:;" title="close">\r\n        Close\r\n    </a>\r\n	<div class="main">\r\n		<div class="top">\r\n			<h4 class="l-float">\r\n				<span class="">New Notifications</span>\r\n			</h4>\r\n            <div class="clear"></div>\r\n		</div>\r\n		<div class="center center-relative block_opera_wrap">\r\n			<ul id="block_alert_box_notification_list" class="_list">\r\n				<li>\r\n                    <div class="block-loading block-horizontal-loading block_loading">\r\n                        <img src="img/com/frontend/loading/horizontal.gif" alt="Loading" />\r\n                    </div>\r\n                </li>\r\n			</ul>\r\n            <div class="quick-look-wrap quick_look_wrap">\r\n                \r\n            </div>\r\n		</div>\r\n	</div>\r\n'}),define("text!templates/common/home-head/alert-box/item/notification/opera-wrap.html",[],function(){return'{{#number}}\n    <a id="alert_box_notification_clear_all" class="l-float" href="javascript:;">Clear All</a>\n{{/number}}\n<a class="r-float" href="user/notification">Show History</a>\n<div class="clear"></div>'}),define("views/common/home-head/alert-box/notification/index",["jquery","underscore","backbone","tools/pop-up-window","views/common/home-head/alert-box/notification/items/like-content","views/common/home-head/alert-box/notification/items/others-add-content-comment","views/common/home-head/alert-box/notification/items/system-message","views/common/home-head/alert-box/notification/items/join-conexus","views/common/home-head/alert-box/notification/items/accept-course-invite","views/common/home-head/alert-box/notification/items/accept-conexus-invite","views/common/home-head/alert-box/notification/items/join-course","views/common/home-head/alert-box/notification/items/submit-quiz","views/common/home-head/alert-box/notification/items/publish-quiz","views/common/home-head/alert-box/notification/items/expired-remind","views/common/home-head/alert-box/notification/items/grade-quiz","views/common/home-head/alert-box/notification/items/accept-join-course","views/common/home-head/alert-box/notification/items/mentioned","views/common/home-head/alert-box/notification/items/after-register","views/common/home-head/alert-box/notification/items/add-content-comment","views/common/home-head/alert-box/notification/items/accept-colleague","views/common/home-head/alert-box/notification/items/add-attachment-comment","views/common/home-head/alert-box/notification/items/answer-survey","views/common/home-head/alert-box/notification/items/others-like-content","views/common/home-head/alert-box/notification/items/inform-instructor-handle-join-course","views/common/home-head/alert-box/notification/items/like-attachment","views/common/home-head/alert-box/notification/items/add-follow","views/common/home-head/alert-box/no-message","views/common/home-head/alert-box/notification/quick-look","collections/message-system/message-system-collections","text!templates/common/home-head/alert-box/index/notification.html","text!templates/common/home-head/alert-box/item/notification/opera-wrap.html"],function(e,t,n,i,o,r,a,s,l,c,d,u,m,h,p,f,v,_,g,b,y,w,x,k,C,E,A,S,T,N,D){var R=i.get("function"),O=T.get("NotificationMessages"),I={like_content:o,others_add_content_comment:r,system_message:a,join_conexus:s,accept_course_invite:l,accept_conexus_invite:c,join_course:d,submit_quiz:u,publish_quiz:m,expired_remind:h,grade_quiz:p,accept_join_course:f,mentioned:v,after_register:_,add_content_comment:g,accept_colleague:b,add_attachment_comment:y,answer_survey:w,others_like_content:x,inform_instructor_handle_join_course:k,like_attachment:C,add_follow:E},j=n.View.extend({template:D,className:"opera-wrap",events:{"click #alert_box_notification_clear_all":"clearAll"},initialize:function(e){this.model.on("change",this.render,this),this.parent=e.parent},serialize:function(){return this.model.toJSON()},clearAll:function(){var e=this;R.confirm({content:"Are you sure you want to clear all of the notifications?",yesCallBack:function(){e.collection.clearAll(function(){e.parent.deleted(),e.model.set({number:0})})}})}});return n.View.extend({className:"body block-float-down-box block-float-down-left-box block-alert-float-box",template:N,events:{"click .close_box":"deleted","mouseenter .block_alert_box_notification_item":"displayOperate","mouseleave .block_alert_box_notification_item":"hideOperate","click .hide_float_box":"closeQuickLook"},initialize:function(e){t.bindAll(this,"addAll","addOne","removeOne"),this.collection=new O,this.collection.on("all",this.refresh,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),this.collection.on("remove",this.checkIsEmpty,this),this.parent=e.parent},afterRender:function(){var e=this,t=new j({model:this.model,collection:this.collection,parent:e});this.$("#block_alert_box_notification_list").before(t.render().view.el),this.collection.addUrlParam({with_user_notification_extra_data:1,user_notification_list_mark:"unread"}),this.collection.fetch({resultFalse:function(){e.refresh()}})},deleted:function(){this.remove()},checkIsEmpty:function(){this.collection.isEmpty()&&this.remove()},refresh:function(){if(this.collection.isEmpty()){var e=new A({message:"There are no new notifications."});this.$("._list").empty().append(e.render().view.el)}else this.$(".opera_wrap").show();this.model.set({number:this.collection.length}),this.closeQuickLook()},addOne:function(e){var t=new(I[e.get("type")])({model:e,parent:this});this.$("._list").append(t.render().view.el)},addAll:function(){this.$("._list").empty(),this.collection.each(this.addOne)},removeOne:function(){this.model.sub(1),this.closeQuickLook()},closeQuickLook:function(){var e=this.$(".quick_look_wrap");e.css({opacity:0}).empty()},displayOperate:function(t){var n=e(t.currentTarget).find(".display_operation");n.show()},hideOperate:function(t){var n=e(t.currentTarget).find(".display_operation");n.hide()}})}),define("text!templates/common/home-head/alert-box/button/notification.html",[],function(){return'<div class="head _head">\n    <a class="text-hide icon-alert icon-alert-notification load_message always_allow" href="javascript:;" data-type="notification" >\n        notification\n    </a>\n    <div class="alert-box-item-count-wrap alert_box_item_count_wrap">\n        \n    </div>\n</div>\n<div class="main notification-main _main">\n\n</div>\n'}),define("views/common/home-head/alert-box/notification/button",["jquery","underscore","backbone","tools/auto-close-view-window","views/common/home-head/alert-box/notification/index","views/common/home-head/alert-box/count","modules/message-system/message-count-notification","text!templates/common/home-head/alert-box/button/notification.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({className:"item _item",template:s,events:{"click .load_message":"loadMessage"},initialize:function(){t.bindAll(this,"refresh"),this.model=a,this.model.on("change",this.refresh,this)},afterRender:function(){this.refresh()},loadMessage:function(t){var n=this,r=e(t.currentTarget),a=r.closest("#block_head");a.find("._main, ._box").fadeOut(),this.$("._item ._main").empty();var s=new o({parent:n,model:this.model});r.closest("._item").find("._main").hide().html(s.render().view.el).fadeIn(),i(t,s)},refresh:function(){if(this.model.get("number")){var e=new r({model:this.model});this.$("._head .alert_box_item_count_wrap").html(e.render().view.el).fadeIn()}else this.$("._head .alert_box_item_count_wrap").fadeOut()}})}),define("text!templates/common/home-head/alert-box.html",[],function(){return'<div class="block-alert-item-wrap block_alert_item_wrap">\r\n    \r\n    <div class="item" title="RememberIt">\r\n        <div class="head no-border-r">\r\n            <a class="text-hide icon-alert icon-alert-remember" href="content/remember" >\r\n                remember\r\n            </a>\r\n    <!--		 <b>8</b> -->\r\n        </div>\r\n        <div class="main">\r\n\r\n        </div>\r\n    </div>\r\n    <div class="clear"></div>\r\n</div>'}),define("views/common/home-head/alert-box",["jquery","underscore","backbone","views/common/home-head/alert-box/chat/button","views/common/home-head/alert-box/request/button","views/common/home-head/alert-box/email/button","views/common/home-head/alert-box/notification/button","text!templates/common/home-head/alert-box.html"],function(e,t,n,i,o,r,a,s){var l={notification:a,email:r,request:o,chat:i};return n.View.extend({className:"block-alert",template:s,afterRender:function(){for(var e in l)l.hasOwnProperty(e)&&this.$(".block_alert_item_wrap").prepend((new l[e]).render().view.el)},serialize:function(){return this.model.toJSON()}})}),define("text!templates/common/head.html",[],function(){return'<div class="head">\r\n	<div class="center web-fixed-width">\r\n		<h1 class="l-float sidebar-fixed-width">\r\n			<a  class="logo text-hide" href="" title="Go to CN home">\r\n				theCN logo\r\n			</a>\r\n		</h1>\r\n		<div class="r-float content-fixed-width">\r\n			<div class="l-float" id="block_search_box">\r\n				\r\n			</div>\r\n			<div class="l-float" id="block_alert_box">\r\n				\r\n			</div>\r\n			<div class="r-float" id="block_master_menu">\r\n				\r\n			</div>\r\n			<div class="clear"></div>\r\n		</div>\r\n		<div class="clear"></div>\r\n	</div>\r\n</div>\r\n'}),define("views/common/head",["jquery","underscore","backbone","views/common/home-head/search-box","views/common/home-head/master-menu","views/common/home-head/alert-box","modules/me","text!templates/common/head.html"],function(e,t,n,i,o,r,a,s){return n.View.extend({className:"block-head",template:s,beforeRender:function(){this.setViews({"#block_search_box":new i})},afterRender:function(){var e=this;this.model.setUrlParam({}),this.model.fetch({resultTrue:function(t){var n=new o({model:t});e.$("#block_master_menu").html(n.render().view.el);var i=new r({model:t});e.$("#block_alert_box").html(i.render().view.el)}})},initialize:function(){this.model=new a}})}),define("text!templates/common/foot.html",[],function(){return'<div class="head">\r\n	<div class="web-fixed-width">\r\n		<ul class="l-float">\r\n			<li>\r\n				<a class="text_terms_of_use" href="javascript:;">\r\n					Terms of Use\r\n				</a>\r\n			</li>\r\n			<li>\r\n				<a class="text_privacy_policy" href="javascript:;">\r\n					Privacy Policy\r\n				</a>\r\n			</li>\r\n			<li>\r\n				<a href="mailto:help@theCN.com">\r\n					help@theCN.com\r\n				</a>\r\n			</li>\r\n		</ul>\r\n		<p class="r-float">\r\n			Copyright &copy; 2011-13.  CourseNetworking LLC.  All rights reserved.\r\n		</p>\r\n		<div class="clear"></div>\r\n	</div>\r\n</div>\r\n<div class="foot">\r\n	<div class="web-fixed-width">\r\n		<p class="r-float">\r\n			Rumi: V3.1.6 Beta,  Apr 3, 2013\r\n		</p>\r\n		<div class="clear"></div>\r\n	</div>\r\n</div>'}),define("views/common/foot",["backbone","text!templates/common/foot.html"],function(e,t){return e.View.extend({className:"block-foot",template:t})}),define("text!templates/layout/home.html",[],function(){return'<div class="wrap-web wrap-home" id="wrap_home">\n    <!-- head -->\n    <div class="head" id="block_head">\n        \n    </div>\n    <!-- /head -->\n\n    <!-- main -->\n    <div class="main">\n\n        <!-- center -->\n        <div class="center">\n            <div class="web-fixed-width">\n                <div class="l-float" id="block_sidebar">\n                    \n                </div>\n                <div class="l-float" id="block_content">\n\n                </div>\n                <div class="clear"></div>\n            </div>\n        </div>\n        <!-- /center -->\n        \n        <!-- bottom -->\n        <div id="block_foot">\n            \n        <div>\n        <!-- /bottom -->\n        \n    </div>\n    <!-- /main -->\n</div>'}),define("views/layout/home",["app","views/common/head","views/common/foot","text!templates/layout/home.html"],function(e,t,n,i){return e.useLayout({template:i,views:{"#block_head":new t,"#block_foot":new n}})}),define("modules/user-avatar",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/user_avatar/",urlParam:{as_current_user_avatar:1},defaults:function(){return{type:"",value:""}}})}),define("modules/attachment-picture-thumb",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/attachment_picture_thumb/",defaults:function(){return{width:0,height:0,top:0,left:0,do_replace:0}}})}),define("text!templates/common/crop-picture.html",[],function(){return'<link rel="stylesheet" href="js/ui/jcrop/css/jquery.Jcrop.min.css" type="text/css" />\n<style>\n	.crop-wrap{\n        max-width: 680px;\n        overflow: hidden;\n	}\n	.crop-wrap > .sidebar{\n		border: 1px solid #ccc;\n		padding: 1px;\n	}\n	.crop-wrap > .sidebar img{\n		max-width: 500px;\n	}\n	.crop-wrap > .lateral{\n		max-width: 160px;\n		margin-left: 10px;\n		padding: 1px;\n	}\n	.crop-wrap > .lateral > .top{\n		border: 1px solid #ccc;\n        overflow: hidden;\n        max-width: 150px;\n	}\n	.crop-wrap > .lateral > .bottom{\n		margin: 30px 0 0 0;  \n		text-align: center;\n	}\n	.btn-crop{\n		padding: 5px 7px; \n		font-weight: bold;\n	}\n</style>\n<input type="hidden" id="origin_id"/>\n<div class="l-float sidebar">\n	<img id="target" src="{{view_url}}" alt="Flowers" />\n</div>\n<div class="l-float lateral">\n	<div class="top" id="preview_wrap">\n		<img id="preview" src="{{view_url}}" alt="Preview" />\n	</div>\n	<div class="bottom">\n		<button class="btn-crop bt bt-gray" id="crop_btn">Done Cropping</button>\n	</div>\n</div>\n<div class="clear"></div>\n'}),function(e){e.Jcrop=function(t,n){function i(e){return Math.round(e)+"px"}function o(e){return F.baseClass+"-"+e}function r(){return e.fx.step.hasOwnProperty("backgroundColor")}function a(t){var n=e(t).offset();return[n.left,n.top]}function s(e){return[e.pageX-j[0],e.pageY-j[1]]}function l(t){"object"!=typeof t&&(t={}),F=e.extend(F,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof F[t]&&(F[t]=function(){})})}function c(e,t,n){if(j=a(V),pt.setCursor("move"===e?e:e+"-resize"),"move"===e)return pt.activateHandlers(u(t),v,n);var i=ut.getFixed(),o=m(e),r=ut.getCorner(m(o));ut.setPressed(ut.getCorner(o)),ut.setCurrent(r),pt.activateHandlers(d(e,i),v,n)}function d(e,t){return function(n){if(F.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}ut.setCurrent(n),ht.update()}}function u(e){var t=e;return ft.watchKeys(),function(e){ut.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,ht.update()}}function m(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function h(e){return function(t){return F.disabled?!1:"move"!==e||F.allowMove?(j=a(V),it=!0,c(e,s(t)),t.stopPropagation(),t.preventDefault(),!1):!1}}function p(e,t,n){var i=e.width(),o=e.height();i>t&&t>0&&(i=t,o=t/e.width()*e.height()),o>n&&n>0&&(o=n,i=n/e.height()*e.width()),tt=e.width()/i,nt=e.height()/o,e.width(i).height(o)}function f(e){return{x:e.x*tt,y:e.y*nt,x2:e.x2*tt,y2:e.y2*nt,w:e.w*tt,h:e.h*nt}}function v(){var e=ut.getFixed();e.w>F.minSelect[0]&&e.h>F.minSelect[1]?(ht.enableHandles(),ht.done()):ht.release(),pt.setCursor(F.allowSelect?"crosshair":"default")}function _(e){if(F.disabled)return!1;if(!F.allowSelect)return!1;it=!0,j=a(V),ht.disableHandles(),pt.setCursor("crosshair");var t=s(e);return ut.setPressed(t),ht.update(),pt.activateHandlers(g,v,"touch"===e.type.substring(0,5)),ft.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function g(e){ut.setCurrent(e),ht.update()}function b(){var t=e("<div></div>").addClass(o("tracker"));return U&&t.css({opacity:0,backgroundColor:"white"}),t}function y(e){Y.removeClass().addClass(o("holder")).addClass(e)}function w(e,t){function n(){window.setTimeout(g,u)}var i=e[0]/tt,o=e[1]/nt,r=e[2]/tt,a=e[3]/nt;if(!ot){var s=ut.flipCoords(i,o,r,a),l=ut.getFixed(),c=[l.x,l.y,l.x2,l.y2],d=c,u=F.animationDelay,m=s[0]-c[0],h=s[1]-c[1],p=s[2]-c[2],f=s[3]-c[3],v=0,_=F.swingSpeed;i=d[0],o=d[1],r=d[2],a=d[3],ht.animMode(!0);var g=function(){return function(){v+=(100-v)/_,d[0]=Math.round(i+v/100*m),d[1]=Math.round(o+v/100*h),d[2]=Math.round(r+v/100*p),d[3]=Math.round(a+v/100*f),v>=99.8&&(v=100),100>v?(k(d),n()):(ht.done(),ht.animMode(!1),"function"==typeof t&&t.call(vt))}}();n()}}function x(e){k([e[0]/tt,e[1]/nt,e[2]/tt,e[3]/nt]),F.onSelect.call(vt,f(ut.getFixed())),ht.enableHandles()}function k(e){ut.setPressed([e[0],e[1]]),ut.setCurrent([e[2],e[3]]),ht.update()}function C(){return f(ut.getFixed())}function E(){return ut.getFixed()}function A(e){l(e),I()}function S(){F.disabled=!0,ht.disableHandles(),ht.setCursor("default"),pt.setCursor("default")}function T(){F.disabled=!1,I()}function N(){ht.done(),pt.activateHandlers(null,null)}function D(){Y.remove(),M.show(),M.css("visibility","visible"),e(t).removeData("Jcrop")}function R(e,t){ht.release(),S();var n=new Image;n.onload=function(){var i=n.width,o=n.height,r=F.boxWidth,a=F.boxHeight;V.width(i).height(o),V.attr("src",e),W.attr("src",e),p(V,r,a),$=V.width(),H=V.height(),W.width($).height(H),st.width($+2*at).height(H+2*at),Y.width($).height(H),mt.resize($,H),T(),"function"==typeof t&&t.call(vt)},n.src=e}function O(e,t,n){var i=t||F.bgColor;F.bgFade&&r()&&F.fadeTime&&!n?e.animate({backgroundColor:i},{queue:!1,duration:F.fadeTime}):e.css("backgroundColor",i)}function I(e){F.allowResize?e?ht.enableOnly():ht.enableHandles():ht.disableHandles(),pt.setCursor(F.allowSelect?"crosshair":"default"),ht.setCursor(F.allowMove?"move":"default"),F.hasOwnProperty("trueSize")&&(tt=F.trueSize[0]/$,nt=F.trueSize[1]/H),F.hasOwnProperty("setSelect")&&(x(F.setSelect),ht.done(),delete F.setSelect),mt.refresh(),F.bgColor!=lt&&(O(F.shade?mt.getShades():Y,F.shade?F.shadeColor||F.bgColor:F.bgColor),lt=F.bgColor),ct!=F.bgOpacity&&(ct=F.bgOpacity,F.shade?mt.refresh():ht.setBgOpacity(ct)),Q=F.maxSize[0]||0,X=F.maxSize[1]||0,Z=F.minSize[0]||0,et=F.minSize[1]||0,F.hasOwnProperty("outerImage")&&(V.attr("src",F.outerImage),delete F.outerImage),ht.refresh()}var j,F=e.extend({},e.Jcrop.defaults),B=navigator.userAgent.toLowerCase(),U=/msie/.test(B),L=/msie [1-6]\./.test(B);"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof n&&(n={}),l(n);var P={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},M=e(t),q=!0;if("IMG"==t.tagName){if(0!=M[0].width&&0!=M[0].height)M.width(M[0].width),M.height(M[0].height);else{var z=new Image;z.src=M[0].src,M.width(z.width),M.height(z.height)}var V=M.clone().removeAttr("id").css(P).show();V.width(M.width()),V.height(M.height()),M.after(V).hide()}else V=M.css(P).show(),q=!1,null===F.shade&&(F.shade=!0);p(V,F.boxWidth,F.boxHeight);var $=V.width(),H=V.height(),Y=e("<div />").width($).height(H).addClass(o("holder")).css({position:"relative",backgroundColor:F.bgColor}).insertAfter(M).append(V);F.addClass&&Y.addClass(F.addClass);var W=e("<div />"),G=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),J=e("<div />").width("100%").height("100%").css("zIndex",320),K=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=ut.getFixed();F.onDblClick.call(vt,e)}).insertBefore(V).append(G,J);q&&(W=e("<img />").attr("src",V.attr("src")).css(P).width($).height(H),G.append(W)),L&&K.css({overflowY:"hidden"});var Q,X,Z,et,tt,nt,it,ot,rt,at=F.boundary,st=b().width($+2*at).height(H+2*at).css({position:"absolute",top:i(-at),left:i(-at),zIndex:290}).mousedown(_),lt=F.bgColor,ct=F.bgOpacity;j=a(V);var dt=function(){function e(){var e,t={},n=["touchstart","touchmove","touchend"],i=document.createElement("div");try{for(e=0;n.length>e;e++){var o=n[e];o="on"+o;var r=o in i;r||(i.setAttribute(o,"return;"),r="function"==typeof i[o]),t[n[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(a){return!1}}function t(){return F.touchSupport===!0||F.touchSupport===!1?F.touchSupport:e()}return{createDragger:function(e){return function(t){return F.disabled?!1:"move"!==e||F.allowMove?(j=a(V),it=!0,c(e,s(dt.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1):!1}},newSelection:function(e){return _(dt.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:t()}}(),ut=function(){function e(e){e=a(e),p=m=e[0],f=h=e[1]}function t(e){e=a(e),d=e[0]-p,u=e[1]-f,p=e[0],f=e[1]}function n(){return[d,u]}function i(e){var t=e[0],n=e[1];0>m+t&&(t-=t+m),0>h+n&&(n-=n+h),f+n>H&&(n+=H-(f+n)),p+t>$&&(t+=$-(p+t)),m+=t,p+=t,h+=n,f+=n}function o(e){var t=r();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function r(){if(!F.aspectRatio)return l();var e,t,n,i,o=F.aspectRatio,r=F.minSize[0]/tt,a=F.maxSize[0]/tt,d=F.maxSize[1]/nt,u=p-m,v=f-h,_=Math.abs(u),g=Math.abs(v),b=_/g;return 0===a&&(a=10*$),0===d&&(d=10*H),o>b?(t=f,n=g*o,e=0>u?m-n:n+m,0>e?(e=0,i=Math.abs((e-m)/o),t=0>v?h-i:i+h):e>$&&(e=$,i=Math.abs((e-m)/o),t=0>v?h-i:i+h)):(e=p,i=_/o,t=0>v?h-i:h+i,0>t?(t=0,n=Math.abs((t-h)*o),e=0>u?m-n:n+m):t>H&&(t=H,n=Math.abs(t-h)*o,e=0>u?m-n:n+m)),e>m?(r>e-m?e=m+r:e-m>a&&(e=m+a),t=t>h?h+(e-m)/o:h-(e-m)/o):m>e&&(r>m-e?e=m-r:m-e>a&&(e=m-a),t=t>h?h+(m-e)/o:h-(m-e)/o),0>e?(m-=e,e=0):e>$&&(m-=e-$,e=$),0>t?(h-=t,t=0):t>H&&(h-=t-H,t=H),c(s(m,h,e,t))}function a(e){return 0>e[0]&&(e[0]=0),0>e[1]&&(e[1]=0),e[0]>$&&(e[0]=$),e[1]>H&&(e[1]=H),[Math.round(e[0]),Math.round(e[1])]}function s(e,t,n,i){var o=e,r=n,a=t,s=i;return e>n&&(o=n,r=e),t>i&&(a=i,s=t),[o,a,r,s]}function l(){var e,t=p-m,n=f-h;return Q&&Math.abs(t)>Q&&(p=t>0?m+Q:m-Q),X&&Math.abs(n)>X&&(f=n>0?h+X:h-X),et/nt&&et/nt>Math.abs(n)&&(f=n>0?h+et/nt:h-et/nt),Z/tt&&Z/tt>Math.abs(t)&&(p=t>0?m+Z/tt:m-Z/tt),0>m&&(p-=m,m-=m),0>h&&(f-=h,h-=h),0>p&&(m-=p,p-=p),0>f&&(h-=f,f-=f),p>$&&(e=p-$,m-=e,p-=e),f>H&&(e=f-H,h-=e,f-=e),m>$&&(e=m-H,f-=e,h-=e),h>H&&(e=h-H,f-=e,h-=e),c(s(m,h,p,f))}function c(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var d,u,m=0,h=0,p=0,f=0;return{flipCoords:s,setPressed:e,setCurrent:t,getOffset:n,moveOffset:i,getCorner:o,getFixed:r}}(),mt=function(){function t(e,t){p.left.css({height:i(t)}),p.right.css({height:i(t)})}function n(){return o(ut.getFixed())}function o(e){p.top.css({left:i(e.x),width:i(e.w),height:i(e.y)}),p.bottom.css({top:i(e.y2),left:i(e.x),width:i(e.w),height:i(H-e.y2)}),p.right.css({left:i(e.x2),width:i($-e.x2)}),p.left.css({width:i(e.x)})}function r(){return e("<div />").css({position:"absolute",backgroundColor:F.shadeColor||F.bgColor}).appendTo(h)}function a(){m||(m=!0,h.insertBefore(V),n(),ht.setBgOpacity(1,0,1),W.hide(),s(F.shadeColor||F.bgColor,1),ht.isAwake()?c(F.bgOpacity,1):c(1,1))}function s(e,t){O(u(),e,t)}function l(){m&&(h.remove(),W.show(),m=!1,ht.isAwake()?ht.setBgOpacity(F.bgOpacity,1,1):(ht.setBgOpacity(1,1,1),ht.disableHandles()),O(Y,0,1))}function c(e,t){m&&(F.bgFade&&!t?h.animate({opacity:1-e},{queue:!1,duration:F.fadeTime}):h.css({opacity:1-e}))}function d(){F.shade?a():l(),ht.isAwake()&&c(F.bgOpacity)}function u(){return h.children()}var m=!1,h=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),p={top:r(),left:r().height(H),right:r().height(H),bottom:r()};return{update:n,updateRaw:o,getShades:u,setBgColor:s,enable:a,disable:l,resize:t,refresh:d,opacity:c}}(),ht=function(){function t(t){var n=e("<div />").css({position:"absolute",opacity:F.borderOpacity}).addClass(o(t));return G.append(n),n}function n(t,n){var i=e("<div />").mousedown(h(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n}).addClass("ord-"+t);return dt.support&&i.bind("touchstart.jcrop",dt.createDragger(t)),J.append(i),i}function r(e){var t=F.handleSize,i=n(e,S++).css({opacity:F.handleOpacity}).addClass(o("handle"));return t&&i.width(t).height(t),i}function a(e){return n(e,S++).addClass("jcrop-dragbar")}function s(e){var t;for(t=0;e.length>t;t++)D[e[t]]=a(e[t])}function l(e){var n,i;for(i=0;e.length>i;i++){switch(e[i]){case"n":n="hline";break;case"s":n="hline bottom";break;case"e":n="vline right";break;case"w":n="vline"}T[e[i]]=t(n)}}function c(e){var t;for(t=0;e.length>t;t++)N[e[t]]=r(e[t])}function d(e,t){F.shade||W.css({top:i(-t),left:i(-e)}),K.css({top:i(t),left:i(e)})}function u(e,t){K.width(Math.round(e)).height(Math.round(t))}function m(){var e=ut.getFixed();ut.setPressed([e.x,e.y]),ut.setCurrent([e.x2,e.y2]),p()}function p(e){return A?v(e):void 0}function v(e){var t=ut.getFixed();u(t.w,t.h),d(t.x,t.y),F.shade&&mt.updateRaw(t),A||g(),e?F.onSelect.call(vt,f(t)):F.onChange.call(vt,f(t))}function _(e,t,n){(A||t)&&(F.bgFade&&!n?V.animate({opacity:e},{queue:!1,duration:F.fadeTime}):V.css("opacity",e))}function g(){K.show(),F.shade?mt.opacity(ct):_(ct,!0),A=!0}function y(){k(),K.hide(),F.shade?mt.opacity(1):_(1),A=!1,F.onRelease.call(vt)}function w(){R&&J.show()}function x(){return R=!0,F.allowResize?(J.show(),!0):void 0}function k(){R=!1,J.hide()}function C(e){e?(ot=!0,k()):(ot=!1,x())}function E(){C(!1),m()}var A,S=370,T={},N={},D={},R=!1;F.dragEdges&&e.isArray(F.createDragbars)&&s(F.createDragbars),e.isArray(F.createHandles)&&c(F.createHandles),F.drawBorders&&e.isArray(F.createBorders)&&l(F.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()});var O=b().mousedown(h("move")).css({cursor:"move",position:"absolute",zIndex:360});return dt.support&&O.bind("touchstart.jcrop",dt.createDragger("move")),G.append(O),k(),{updateVisible:p,update:v,release:y,refresh:m,isAwake:function(){return A},setCursor:function(e){O.css("cursor",e)},enableHandles:x,enableOnly:function(){R=!0},showHandles:w,disableHandles:k,animMode:C,setBgOpacity:_,done:E}}(),pt=function(){function t(t){st.css({zIndex:450}),t?e(document).bind("touchmove.jcrop",a).bind("touchend.jcrop",l):m&&e(document).bind("mousemove.jcrop",i).bind("mouseup.jcrop",o)}function n(){st.css({zIndex:290}),e(document).unbind(".jcrop")}function i(e){return d(s(e)),!1}function o(e){return e.preventDefault(),e.stopPropagation(),it&&(it=!1,u(s(e)),ht.isAwake()&&F.onSelect.call(vt,f(ut.getFixed())),n(),d=function(){},u=function(){}),!1}function r(e,n,i){return it=!0,d=e,u=n,t(i),!1}function a(e){return d(s(dt.cfilter(e))),!1}function l(e){return o(dt.cfilter(e))}function c(e){st.css("cursor",e)}var d=function(){},u=function(){},m=F.trackDocument;return m||st.mousemove(i).mouseup(o).mouseout(o),V.before(st),{activateHandlers:r,setCursor:c}}(),ft=function(){function t(){F.keySupport&&(r.show(),r.focus())}function n(){r.hide()}function i(e,t,n){F.allowMove&&(ut.moveOffset([t,n]),ht.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function o(e){if(e.ctrlKey||e.metaKey)return!0;rt=e.shiftKey?!0:!1;var t=rt?10:1;switch(e.keyCode){case 37:i(e,-t,0);break;case 39:i(e,t,0);break;case 38:i(e,0,-t);break;case 40:i(e,0,t);break;case 27:F.allowSelect&&ht.release();break;case 9:return!0}return!1}var r=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),a=e("<div />").css({position:"absolute",overflow:"hidden"}).append(r);return F.keySupport&&(r.keydown(o).blur(n),L||!F.fixedSupport?(r.css({position:"absolute",left:"-20px"}),a.append(r).insertBefore(V)):r.insertBefore(V)),{watchKeys:t}}();dt.support&&st.bind("touchstart.jcrop",dt.newSelection),J.hide(),I(!0);var vt={setImage:R,animateTo:w,setSelect:x,setOptions:A,tellSelect:C,tellScaled:E,setClass:y,disable:S,enable:T,cancel:N,release:ht.release,destroy:D,focus:ft.watchKeys,getBounds:function(){return[$*tt,H*nt]
},getWidgetSize:function(){return[$,H]},getScaleFactor:function(){return[tt,nt]},getOptions:function(){return F},ui:{holder:Y,selection:K}};return U&&Y.bind("selectstart",function(){return!1}),M.data("Jcrop",vt),vt},e.fn.Jcrop=function(t,n){var i;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),i=e.Jcrop(this,t),e.isFunction(n)&&n.call(i)}):(e(this).css({display:"block",visibility:"hidden"}),i=e.Jcrop(this,t),e.isFunction(n)&&n.call(i))}),this},e.Jcrop.Loader=function(t,n,i){function o(){a.complete?(r.unbind(".jcloader"),e.isFunction(n)&&n.call(a)):window.setTimeout(o,50)}var r=e(t),a=r[0];r.bind("load.jcloader",o).bind("error.jcloader",function(){r.unbind(".jcloader"),e.isFunction(i)&&i.call(a)}),a.complete&&e.isFunction(n)&&(r.unbind(".jcloader"),n.call(a))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),define("jcrop",function(){}),define("views/common/crop-picture",["jquery","underscore","backbone","modules/attachment-picture-thumb","tools/pop-up-window","text!templates/common/crop-picture.html","jcrop"],function(e,t,n,i,o,r){return n.View.extend({className:"crop-wrap",template:r,initialize:function(t,n){this.callBack=e.extend(!0,{},this.callBack,n),this.pluginParams=e.extend(!0,{},this.pluginParams,t.pluginParams),this.model="object"===e.type(t)?new i(t):new i},serialize:function(){return this.model.toJSON()},events:{"click #crop_btn":"crop"},callBack:{success:function(){},error:function(){}},pluginParams:{previewSize:[150,150],replaceOriginImg:0,aspectRatio:1,minSize:[],maxSize:[],setSelect:[],bgColor:"black",bgOpacity:.6},getJcropApi:function(){return"undefined"!==e.type(this.jcropApi)?this.jcropApi:!1},getWidth:function(){return this.model.get("width")},getHeight:function(){return this.model.get("height")},hasCrop:function(){return this.getWidth()&&this.getHeight()},crop:function(){var e=this;return this.hasCrop()?(this.model.save({},{resultTrue:function(t,n){e.callBack.success(n),o.get("function").close()}}),void 0):(alert("Please crop the picture."),!1)},setPreviewPictureSize:function(){var e=this;e.$("#preview_wrap").css({width:e.pluginParams.previewSize[0],height:e.pluginParams.previewSize[1],overflow:"hidden"})},setCropData:function(t){var n=this;"object"===e.type(t)&&this.model.set({width:t.w,height:t.h,top:t.y,left:t.x,do_replace:n.pluginParams.replaceOriginImg})},afterRender:function(){var t=this;t.setPreviewPictureSize();var n=function(e){if(parseInt(e.w)>0){t.setCropData(e);var n=t.pluginParams.previewSize[0]/e.w,i=t.pluginParams.previewSize[1]/e.h;t.$("#preview").css({width:Math.round(n*t.bounds[0])+"px",height:Math.round(i*t.bounds[1])+"px",marginLeft:"-"+Math.round(n*e.x)+"px",marginTop:"-"+Math.round(i*e.y)+"px"})}},i=e.extend(!0,{},t.pluginParams,{onChange:n,onSelect:n});t.$("#target").Jcrop(i,function(){t.bounds=this.getBounds(),t.jcropApi=this})}})}),define("text!templates/user/edit-profile/sidebar.html",[],function(){return'<div class="block-clubs-create-side block-box-type-three">\n    <div class="head">\n        <a class="avatar avatar-large" href="javascript:;"><img id="avatar_url" {{#avatar.view_url}}src="{{avatar.view_url}}"{{/avatar.view_url}}{{^avatar.view_url}}src="/img/common/avatar/gender.png"{{/avatar.view_url}} alt="" width="160"/></a>\n        <p class="select-box">\n            <input class="always_allow" id="user_logo_upload_custom" type="radio" name="option" />\n            <label for="user_logo_upload_custom">Upload an image for your profile</label>\n        </p>\n        <div class="main">\n            <div id="block_upload_button_box" class="upload-button-wrap" style="display: none;">\n                <a id="upload_avatar" class="bt bt-blue-2 text" href="javascript:;">UPLOAD</a>\n            </div>\n        </div>\n    </div>\n    <div class="main">\n        <p class="select-box">\n            <input class="always_allow" id="user_logo_upload_system" type="radio" name="option" checked="checked" />\n            <label for="user_logo_upload_system">Select an image from the library</label>\n        </p>\n        <ul class="system-avatar-wrap" id="system_avatar_wrap">\n            <li>\n                <a class="avatar-female00-backed" href="img/common/avatar/female00.backed.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female00" href="img/common/avatar/female00.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female01" href="img/common/avatar/female01.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female02" href="img/common/avatar/female02.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female03" href="img/common/avatar/female03.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female04" href="img/common/avatar/female04.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female05" href="img/common/avatar/female05.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female06" href="img/common/avatar/female06.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female07" href="img/common/avatar/female07.png"></a>\n            </li>\n            <li>\n                <a class="avatar-female08" href="img/common/avatar/female08.png"></a>\n            </li>\n            <li>\n                <a class="avatar-gender" href="img/common/avatar/gender.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male00" href="img/common/avatar/male00.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male01" href="img/common/avatar/male01.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male02" href="img/common/avatar/male02.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male03" href="img/common/avatar/male03.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male04" href="img/common/avatar/male04.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male05" href="img/common/avatar/male05.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male06" href="img/common/avatar/male06.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male07" href="img/common/avatar/male07.png"></a>\n            </li>\n            <li>\n                <a class="avatar-male08" href="img/common/avatar/male08.png"></a>\n            </li>\n        </ul>\n    </div>\n</div>'}),define("views/user/edit-profile/sidebar",["jquery","underscore","backbone","modules/me","modules/user-avatar","tools/upload-plugin","tools/pop-up-window","views/common/crop-picture","text!templates/user/edit-profile/sidebar.html"],function(e,t,n,i,o,r,a,s,l){var c=n.View.extend({className:"sidebar-clubs sidebar-web sidebar-fixed-width",template:l,serialize:function(){return this.model.toJSON()},events:{"click #user_logo_upload_custom":"showUploadBtn","click #user_logo_upload_system":"closeUploadBtn","click #system_avatar_wrap a":"change2SystemAvatar"},afterRender:function(){var t=this;r.set({url:"/api/attachment_picture/",browseButtonId:"upload_avatar",wrapId:"block_upload_button_box",imgResize:{width:500},extraParams:{max_width:500},fileExts:"bmp,jpg,jpeg,png,gif,BMP,JPG,JPEG,PNG,GIF",events:{success:function(n,i,o){if(o.result&&"object"===e.type(o.data)){var r=o.data;a.get("function").open(new s({view_url:r.view_url,id:r.id,pluginParams:{replaceOriginImg:1}},{success:function(e){t.$("#avatar_url").attr("src",e.data.view_url),t.updateUserAvatar({value:e.data.id},{resultTrue:function(){},resultFalse:function(){}})}}).render().view.el,{padding:10})}}}})},showUploadBtn:function(){var e=this;e.$("#system_avatar_wrap").fadeOut("fast",function(){e.$("#block_upload_button_box").fadeIn()})},closeUploadBtn:function(){var e=this;this.$("#block_upload_button_box").fadeOut("fast",function(){e.$("#system_avatar_wrap").fadeIn("fast")})},updateUserAvatar:function(t,n){var r={type:"attachment",value:"",as_current_user_avatar:0};r=e.extend(!0,{},r,t);var a=new o;a.save(r,{resultTrue:function(t,o){"object"===e.type(n)&&"function"===e.type(n.resultTrue)&&(e("#avatar_id").val(o.data.id),n.resultTrue(o),(new i).fetch())},resultFalse:function(t,i){"object"===e.type(n)&&"function"===e.type(n.resultFalse)&&n.resultFalse(i)}})},beforeRender:function(){},change2SystemAvatar:function(t){var n=this,i=e.trim(this.$(t.currentTarget).attr("href"));return i.length>0&&this.updateUserAvatar({type:"url",value:i},{resultTrue:function(){n.$("#avatar_url").attr("src",i)},resultFalse:function(){}}),!1}});return c}),define("modules/language",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/language/",initDefaults:function(){var e=this;return{display_name:e.get("name"),display_value:e.get("id")}}})}),define("collections/languages",["jquery","underscore","backbone","modules/language"],function(e,t,n,i){var o=n.Collection.extend({model:i,urlRoot:"api/language/"});return new o}),define("modules/country",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/country/",initDefaults:function(){var e=this;return{display_name:e.get("name"),display_value:e.get("id")}}})}),define("collections/countries",["jquery","underscore","backbone","modules/country"],function(e,t,n,i){var o=n.Collection.extend({model:i,urlRoot:"api/country/"});return new o}),define("modules/time-zone",["jquery","underscore","backbone"],function(e,t,n){return n.Model.extend({urlRoot:"api/time_zone/",initDefaults:function(){var e=this;return{display_name:e.get("zone"),display_value:e.get("id")}}})}),define("collections/timezones",["jquery","underscore","backbone","modules/time-zone"],function(e,t,n,i){var o=n.Collection.extend({model:i,urlRoot:"api/time_zone/"});return new o}),define("modules/zip-code-number",["jquery","underscore","backbone"],function(e,t,n){var i=n.Model.extend({urlRoot:"api/zip_code_number/",defaults:function(){return{city:"",county:"",state:"",display_name:""}},initDefaults:function(){var e=this;return{display_name:e.get("city")+" , "+e.get("county")+" , "+e.get("state")}}});return i}),define("modules/city",["jquery","underscore","backbone"],function(e,t,n){var i=n.Model.extend({urlRoot:"api/city/",initDefaults:function(){var e=this;return{display_name:e.get("name"),display_value:e.get("id")}}});return i}),define("views/common/select",["jquery","underscore","backbone","views/common/option"],function(e,t,n,i){return n.View.extend({tagName:"select",initialize:function(e){t.bindAll(this,"addAll","addOne"),this.attrs=e.attrs,this.extra=e.extra,this.collections=e.collections,this.collections.on("fetch",this.addAll,this)},afterRender:function(){var t=this,n={defaults:!0},i={defaultName:"Please Select One"};if(i=e.extend(!0,{},i,this.extra),n=e.extend(!0,{},n,this.attrs),e(this.$el).attr(n),"undefined"!==e.type(n)&&"undefined"!==e.type(n.defaults)&&n.defaults){var o='<option value="">'+i.defaultName+"</option>";t.$el.prepend(o)}},addAll:function(){this.collections.each(this.addOne)},addOne:function(e){var t=this,n=new i({model:e,params:{selected:t.attrs.value}});this.$el.append(n.render().view.el)}})}),define("text!templates/user/edit-profile/main/other-language-item.html",[],function(){return'{{lang_name}} \n<input type="hidden" name="profile[other_languages][{{lang_id}}]" value="{{lang_name}}"/>\n<a class="delete" href="javascript:;">Delete</a>'}),define("views/user/edit-profile/main/other-language-item",["jquery","underscore","backbone","text!templates/user/edit-profile/main/other-language-item.html"],function(e,t,n,i){return n.View.extend({template:i,tagName:"span",initialize:function(e){this.options=e},serialize:function(){return this.options.data},events:{"click .delete":"deleted"},deleted:function(){e(this.el).remove()}})}),define("text!templates/user/edit-profile/main/zip-code-item.html",[],function(){return'{{display_name}} \n<input type="hidden" name="profile[country_id]" value="{{country.id}}"/>\n<input type="hidden" name="profile[current_city_id]" value=""/>'}),define("views/user/edit-profile/main/zip-code-item",["jquery","underscore","backbone","text!templates/user/edit-profile/main/zip-code-item.html"],function(e,t,n,i){return n.View.extend({template:i,tagName:"span",serialize:function(){return this.model.toJSON()}})}),define("text!templates/user/edit-profile/main/school-history-item.html",[],function(){return'<div class="top">\n    <select class="school_position" _name="profile[schools][{{count}}][type]">\n        <option value="" selected="selected">Please Select One</option>\n        <option value="elementary">Elementary</option>\n        <option value="middle">Middle</option>\n        <option value="high_school">High School</option>\n        <option value="college">College</option>\n        <option value="university">University</option>\n        <option value="professional">Professional</option>\n    </select>\n    <input class="school_name" type="text" _name="profile[schools][{{count}}][name]" placeholder="Name"/>\n    <input class="school_web" type="text" _name="profile[schools][{{count}}][web_address]" placeholder="Web Address" />\n    <a class="icon-circle-1 icon-circle-1-delete-red remove_item_btn" href="javascript:;">remove</a>\n    <div class="clear"></div>\n</div>\n'}),define("views/user/edit-profile/main/school-history-item",["jquery","underscore","backbone","text!templates/user/edit-profile/main/school-history-item.html"],function(e,t,n,i){return n.View.extend({template:i,className:"box",events:{"click .remove_item_btn":"deleted","change .school_position":"changeSchoolPosition"},initialize:function(t){if(this.data={count:0},"undefined"!==e.type(t)){var n=t.data||{};this.data=e.extend(!0,{},this.data,n),"object"===e.type(this.data.parent)&&(this.data.count=e(this.data.parent).children().length)}},serialize:function(){return this.data},afterRender:function(){if("undefined"!==e.type(this.data)&&"undefined"!==e.type(this.data.type)&&"undefined"!==e.type(this.data.name)){this.$el.find('option[value="'+this.data.type+'"]').prop("selected",!0),this.$el.find(".school_name").val(this.data.name),this.$el.find(".school_web").val(this.data.web_address);var t=this.$(".school_position");t.parent().find("*[_name]").each(function(){var t=e(this).attr("_name");e(this).attr("name",t),e(this).removeAttr("_name")})}},changeSchoolPosition:function(t){var n=e(t.currentTarget);e.trim(e(t.currentTarget).val())?n.parent().find("*[_name]").each(function(){var t=e(this).attr("_name");e(this).attr("name",t),e(this).removeAttr("_name")}):n.parent().find("*[name]").each(function(){var t=e(this).attr("name");e(this).attr("_name",t),e(this).removeAttr("name")})},deleted:function(){this.remove()}})}),define("text!templates/user/edit-profile/main/work-history-item.html",[],function(){return'<input class="work_company" type="text" name="profile[works][{{count}}][company]" placeholder="Company name" />\n<input class="work_position" type="text" name="profile[works][{{count}}][position]" placeholder="Title" />\n<a class="icon-circle-1 icon-circle-1-delete-red remove_item_btn" href="javascript:;">Add</a>\n<div class="clear"></div>\n'}),define("views/user/edit-profile/main/work-history-item",["jquery","underscore","backbone","text!templates/user/edit-profile/main/work-history-item.html"],function(e,t,n,i){return n.View.extend({template:i,className:"box",events:{"click .remove_item_btn":"remove"},initialize:function(t){if(this.data={count:0},"undefined"!==e.type(t)){var n=t.data||{};this.data=e.extend(!0,{},this.data,n),"object"===e.type(this.data.parent)&&(this.data.count=e(this.data.parent).children().length)}},serialize:function(){return this.data},afterRender:function(){"undefined"!==e.type(this.data)&&"undefined"!==e.type(this.data.company)&&"undefined"!==e.type(this.data.position)&&(e(this.el).find(".work_company").val(this.data.company),e(this.el).find(".work_position").val(this.data.position))},remove:function(){e(this.el).remove()}})}),define("text!templates/user/edit-profile/main/general.html",[],function(){return'<legend>General Information</legend>\n<ul>\n    <li>\n        <div class="only">\n            <label class="title" for="full_name">Full name <span class="red">*</span></label>\n            <input id="full_name" type="text" name="fullname" value="{{fullname}}"/>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="left">\n            <label class="title" for="first_name">First name <span class="red">*</span></label>\n            <input id="first_name" type="text" name="first_name" value="{{first_name}}"/>\n        </div>\n        <div class="right">\n            <label class="title" for="last_name">Last name <span class="red">*</span></label>\n            <input id="last_name" type="text" name="last_name" value="{{last_name}}"/>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="only">\n            <label class="title" for="other_lang_name">Full Name in Secondary Language</label>\n            <input id="other_lang_name" type="text" name="profile[other_fullname]" value="{{profile.other_fullname}}"/>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="primary_email">Primary Email <span class="red">*</span></label>\n            <input id="primary_email" type="text" name="profile[primary_email]" value="{{profile.primary_email}}" />\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_email">Visible to</label>\n            <div id="auth_group_primary_email"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="secondary_email">Secondary Email</label>\n            <input id="secondary_email" type="text" name="profile[secondary_email]" value="{{profile.secondary_email}}"/>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_secondary_email">Visible to</label>\n            <div id="auth_group_secondary_email"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="gemder">Gender</label>\n            <select id="gender" name="profile[gender]">\n                <option value="">Please Select One</option>\n                <option value="male">Male</option>\n                <option value="female">Female</option>\n                <option value="prefer">Prefer not to Specify</option>\n            </select>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_gender">Visible to</label>\n            <div id="auth_group_gender"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="birthday">\n            <input id="birthday_time" type="hidden" name="profile[birthday]" value="{{profile.birthday}}"/>\n            <label class="title" for="birthday">Birthday</label>\n            <div class="main block_birthday">\n                <select class="month" id="birthday_month">\n                    <option value="">Select Month</option>\n                    <option value="1">January</option>\n                    <option value="2">February</option>\n                    <option value="3">March</option>\n                    <option value="4">April</option>\n                    <option value="5">May</option>\n                    <option value="6">June</option>\n                    <option value="7">July</option>\n                    <option value="8">August</option>\n                    <option value="9">September</option>\n                    <option value="10">October</option>\n                    <option value="11">November</option>\n                    <option value="12">December</option>\n                </select>\n                <select class="day" id="birthday_date">\n                    <option value="">Select Day</option>\n                </select>\n                <select class="year" id="birthday_year">\n                    <option value="">Select Year</option>\n                </select>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_birthday">Visible to</label>\n            <div id="auth_group_birthday"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="primary_language">Primary Language</label>\n            <div id="primary_language_wrap">\n                <select id="primary_language" class="target_select" name="profile[primary_language]">\n                    {{#profile}}\n                    {{#primary_language}}\n                    <option value="{{primary_language}}">{{primary_language_name}}</option>\n                    {{/primary_language}}\n                    {{^primary_language}}\n                    <option value="">Please Select One</option>\n                    {{/primary_language}}\n                    {{/profile}}\n                </select>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_primary_language">Visible to</label>\n            <div id="auth_group_primary_language"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="other-language">\n            <label class="title" for="other_language">Other Language</label>\n            <div class="main block_other_language">\n                <div class="top">\n                    <div id="other_language_wrap">\n                        <select id="other_language" class="target_select" name="profile[other_languages]">\n                            <option value="">Please Select One</option>\n                        </select>\n                    </div>\n                    <a class="icon-circle-1 icon-circle-1-add-green" id="add_other_lang_item" href="javascript:;">Add</a>\n                    <div class="clear"></div>\n                </div>\n                <div class="center join_other_language_wrap">\n\n                </div>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_other_languages">Visible to</label>\n            <div id="auth_group_other_languages"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="about">About me</label>\n            <textarea id="about" name="profile[about]">{{profile.about}}</textarea>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_about">Visible to</label>\n            <div id="auth_group_about"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="intersts">Interests</label>\n            <textarea id="intersts" name="profile[interests]" placeholder="Enter areas of academic/personal/professional interest separated by \ncommas (eg. cooking, philanthropy, technology, child  psychology, etc.).">{{display_interests}}</textarea>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_interests">Visible to</label>\n            <div id="auth_group_interests"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="tag_line">Tag Line</label>\n            <input id="tag_line" type="text" name="profile[tag_line]" value="{{display_tag_line}}" placeholder="eg. Always learning, I love science, etc." />\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_tag_line">Visible to</label>\n            <div id="auth_group_tag_line"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n</ul>\n'}),define("views/user/edit-profile/main/general",["jquery","underscore","backbone","text!templates/user/edit-profile/main/general.html"],function(e,t,n,i){return n.View.extend({tagName:"fieldset",template:i,serialize:function(){return this.model.toJSON()}})}),define("text!templates/user/edit-profile/main/location.html",[],function(){return'<legend>Location</legend>\n<ul>\n    <li class="location">\n        <div class="sidebar l-float">What is your current location?*:</div>\n        <div class="content l-float">\n            <label>\n                <input class="current_location_radio always_allow" type="radio" name="current_location_radio" value="usa" checked="checked"/>\n                <span>USA</span>\n            </label>\n            <label>\n                <input class="current_location_radio always_allow" type="radio" name="current_location_radio" value="other"/>\n                <span>Other Country</span>\n            </label>\n            <input type="hidden" name="profile[zip_code]" value="{{profile.zip_code}}"/>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li class="usa_country">\n        <div class="zip">\n            <label class="title" for="zip_code">USA Zip Code <span class="red">*</span></label>\n            <div class="main">\n                <input id="zip_code" class="always_allow" type="text" value="{{profile.zip_code}}"/>\n                <a class="bt bt-blue-2" id="check_zip_code" href="javascript:;">Enter</a>\n            </div>\n            <div class="center zip_code_wrap">\n                {{#profile}}\n                {{#zip_code}}\n                {{#zip_code_detail}}\n                <span>\n                    {{city}} , {{county}} , {{state}}\n                    <input type="hidden" name="profile[country_id]" value="{{country.id}}"/>\n                    <input type="hidden" name="profile[current_city_id]" value=""/>\n                </span>\n                {{/zip_code_detail}}\n                {{/zip_code}}\n                {{/profile}}\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_zip_code">Visible to</label>\n            <div id="auth_group_zip_code"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li class="other_country display-none">\n        <div class="master">\n            <label class="title" for="country_id">Other Country <span class="red">*</span></label>\n            <div id="other_country_wrap">\n                <select id="country_id" class="target_select" _name="profile[country_id]">\n                    {{^profile.zip_code}}\n                    {{#country}}\n                    {{#id}}\n                    <option value="{{id}}">{{name}}</option>\n                    {{/id}}\n                    {{^id}}\n                    <option value="">Please Select One</option>\n                    {{/id}}\n                    {{/country}}\n                    {{/profile.zip_code}}\n\n                    {{#profile.zip_code}}\n                    <option value="">Please Select One</option>\n                    {{/profile.zip_code}}\n                </select>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_country_id">Visible to</label>\n            <div id="auth_group_country_id"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li class="other_country display-none">\n        <div class="master">\n            <label class="title" for="current_city_id">Current City <span class="red">*</span></label>\n            <div id="current_city_wrap">\n                <select id="current_city_id" _name="profile[current_city_id]">\n                    {{#profile}}\n                    {{#current_city_id}}\n                    <option value="{{current_city_id}}">{{current_city_name}}</option>\n                    {{/current_city_id}}\n                    {{^current_city_id}}\n                    <option value="">Please Select One</option>\n                    {{/current_city_id}}\n                    {{/profile}}\n                </select>\n            </div>\n            <div class="display-none" id="input_new_city">\n                <input id="new_city" class="always_allow" type="text" placeholder="new city" style="width: 200px;"/>\n                <button class="bt bt-blue bt-size-normal" id="create_city_btn">Create</button>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_current_city_id">Visible to</label>\n            <div id="auth_group_current_city_id"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="country">What is your country of origin <span class="red">*</span></label>\n            <div id="country_wrap">\n                <select id="origin_country_id" class="target_select" name="profile[origin_country_id]">\n                    {{^profile.origin_country_id}}\n                    <option value="">Please Select One</option>\n                    {{/profile.origin_country_id}}\n                    \n                    {{#profile}}\n                    {{#origin_country}}\n                    {{#id}}\n                    <option value="{{id}}">{{name}}</option>\n                    {{/id}}\n                    {{^id}}\n                    <option value="">Please Select One</option>\n                    {{/id}}\n                    {{/origin_country}}\n                    {{/profile}}\n                </select>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_origin_country_id">Visible to</label>\n            <div id="auth_group_origin_country_id"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="time_zone">What is your time zone <span class="red">*</span></label>\n            <div id="time_zone_wrap">\n                <select id="time_zone_id" class="target_select" name="profile[time_zone_id]">\n                    {{#profile}}\n                    {{#time_zone_id}}\n                    <option value="{{time_zone_id}}">{{time_zone_name}}</option>\n                    {{/time_zone_id}}\n                    {{^time_zone_id}}\n                    <option value="">Please Select One</option>\n                    {{/time_zone_id}}\n                    {{/profile}}\n                </select>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_time_zone_id">Visible to</label>\n            <div id="auth_group_time_zone_id"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n</ul>'
}),define("views/user/edit-profile/main/location",["jquery","underscore","backbone","text!templates/user/edit-profile/main/location.html"],function(e,t,n,i){return n.View.extend({tagName:"fieldset",template:i,serialize:function(){return this.model.toJSON()}})}),define("text!templates/user/edit-profile/main/school-work.html",[],function(){return'<legend>School / Work</legend>\n<ul>\n    <li>\n        <div class="position">\n            <label for="position">Current Position <span class="red">*</span></label>\n            <div class="main">\n                <label>\n                    <input class="profile_position" type="radio" name="profile[position][position]" value="student" checked="checked"/>\n                    <span>Student</span>\n                </label>\n                <label>\n                    <input class="profile_position" type="radio" name="profile[position][position]" value="instructor"/>\n                    <span>Instructor</span>\n                </label>\n                <label>\n                    <input class="profile_position" type="radio" name="profile[position][position]" value="other"/>\n                    <span>Other</span>\n                </label>\n                <div class="clear"></div>\n            </div>\n            <div class="profile_position_other foot display-none">\n                <input type="text" _name="profile[position][type]" value="{{profile.position.type}}" placeholder="(Specify (eg.Librarian. TA))"/>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_position">Visible to</label>\n            <div id="auth_group_position"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="school_type school">\n            <label class="title" for="school">Current School <span class="red">*</span></label>\n            <div class="main">\n                <div class="top">\n                    <select id="school_position_type_student" name="profile[position][type]">\n                        <option value="">Please Select One</option>\n                        <option value="Student">Student</option>\n                        <option value="Elementary student">Elementary student</option>\n                        <option value="Middle School Student">Middle School Student</option>\n                        <option value="High School Student">High School Student</option>\n                        <option value="College/University Student">College/University Student</option>\n                        <option value="Graduate Student">Graduate Student</option>\n                    </select>\n                    <select class="display-none" id="school_position_type_instructor" _name="profile[position][type]">\n                        <option value="">Please Select One</option>\n                        <option value="Instructor">Instructor</option>\n                        <option value="Elementary Instructor">Elementary Instructor</option>\n                        <option value="Middle School Instructor">Middle School Instructor</option>\n                        <option value="High School Instructor">High School Instructor</option>\n                        <option value="College Professor">College Professor</option>\n                        <option value="Lecturer">Lecturer</option>\n                        <option value="Adjunct Professor">Adjunct Professor</option>\n                        <option value="Visiting Lecturer">Visiting Lecturer</option>\n                        <option value="Guest Lecturer">Guest Lecturer</option>\n                        <option value="Assistant Professor">Assistant Professor</option>\n                        <option value="Professor">Professor</option>\n                        <option value="Distinguish Professor">Distinguished Professor</option>\n                    </select>\n                    <input type="text" name="profile[position][school_name]" value="{{profile.position.school_name}}" placeholder="Name" />\n                    <input class="school_web" type="text" name="profile[position][web_address]" value="{{profile.position.web_address}}" placeholder="Web Address" />\n                    <div class="clear"></div>\n                </div>\n            </div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="school">\n            <label class="title" for="school_history">School History</label>\n            <input type="hidden" name="profile[schools][]"/>\n            <div class="main">\n                <div class="top">\n                    <select id="school_position">\n                        <option value="">Please Select One</option>\n                        <option value="elementary">Elementary</option>\n                        <option value="middle">Middle</option>\n                        <option value="high_school">High School</option>\n                        <option value="college">College</option>\n                        <option value="university">University</option>\n                        <option value="professional">Professional</option>\n                    </select>\n                    <input id="school_name" type="text" placeholder="Name" />\n                    <input class="school_web" id="school_web" type="text" placeholder="Web Address" />\n                    <a class="icon-circle-1 icon-circle-1-add-green" id="add_school_history_btn" href="javascript:;">Add</a>\n                    <div class="clear"></div>\n                </div>\n            </div>\n            <div class="main" id="school_history_wrap"></div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_schools">Visible to</label>\n            <div id="auth_group_schools"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="work">\n            <label class="title" for="work_position">Current Work Position</label>\n            <div class="main">\n                <input type="text" name="profile[current_work][company]" value="{{profile.current_work.company}}" placeholder="Company name" />\n                <input type="text" name="profile[current_work][position]" value="{{profile.current_work.position}}" placeholder="Title" />\n                <div class="clear"></div>\n            </div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_current_work">Visible to</label>\n            <div id="auth_group_current_work"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="work">\n            <label class="title" for="work_history">Work/Professional History</label>\n            <div class="main">\n                <input type="hidden" name="profile[works][]"/>\n                <input id="work_company_name" type="text"  placeholder="Company name" />\n                <input id="work_title" type="text"  placeholder="Title" />\n                <a class="icon-circle-1 icon-circle-1-add-green" id="add_work_history_btn" href="javascript:;">Add</a>\n                <div class="clear"></div>\n            </div>\n            <div class="main" id="work_history_wrap"></div>\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_works">Visible to</label>\n            <div id="auth_group_works"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n</ul>'}),define("views/user/edit-profile/main/school-work",["jquery","underscore","backbone","text!templates/user/edit-profile/main/school-work.html"],function(e,t,n,i){return n.View.extend({tagName:"fieldset",template:i,serialize:function(){return this.model.toJSON()}})}),define("text!templates/user/edit-profile/main/social-network.html",[],function(){return'<legend>Social Network</legend>\n<ul>\n    <li>\n        <div class="master">\n            <label class="title" for="website">Personal Website</label>\n            <input id="website" type="text" name="profile[website]" value="{{profile.website}}" />\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_website">Visible to</label>\n            <div id="auth_group_website"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="facebook">Facebook Address</label>\n            <input id="facebook_address" type="text" name="profile[facebook_address]" value="{{profile.facebook_address}}" placeholder="eg. www.facebook.com/coursenetworking" />\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_facebook_address">Visible to</label>\n            <div id="auth_group_facebook_address"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n    <li>\n        <div class="master">\n            <label class="title" for="twitter">Twitter Name</label>\n            <input id="twitter" type="text" name="profile[twitter_name]" value="{{profile.twitter_name}}" placeholder="eg. @coursenetwork" />\n        </div>\n        <div class="separator">\n            --\n        </div>\n        <div class="lesser">\n            <label class="title" for="visible_twitter_name">Visible to</label>\n            <div id="auth_group_twitter_name"></div>\n        </div>\n        <div class="clear"></div>\n    </li>\n</ul>\n'}),define("views/user/edit-profile/main/social-network",["jquery","underscore","backbone","text!templates/user/edit-profile/main/social-network.html"],function(e,t,n,i){return n.View.extend({tagName:"fieldset",template:i,serialize:function(){return this.model.toJSON()}})}),define("text!templates/user/common/visible-settings.html",[],function(){return'<option value="public">All CN Members</option>\n<option value="my_follower">My Followers</option>\n<option value="my_colleague">My Colleagues</option>\n<option value="all_my_courses">My Courses</option>\n<option value="all_my_conexus">My Conexus</option>\n<option value="similar_courses">Similar to my Courses</option>\n<option value="only_me">Only Me</option>'}),define("views/user/common/visible-settings",["jquery","underscore","backbone","text!templates/user/common/visible-settings.html"],function(e,t,n,i){return n.View.extend({tagName:"select",template:i,initialize:function(e){this.options=e||{}},afterRender:function(){this.options.attrs&&(this.$el.attr(this.options.attrs),this.$el.find("option[value="+this.options.attrs.value+"]").prop("selected",!0))}})}),define("text!templates/user/edit-profile/main.html",[],function(){return'<div class="block-edit-profile block-box-type-one">\n    <div class="block-box-head head">\n        <h3>Edit Profile</h3>\n        <em>All fields with (<span class="red">*</span>) are required</em>\n        <div class="clear"></div>\n    </div>\n    <div class="main">\n        <div class="intro">\n            Use the following form to edit your profile.\n        </div>\n        <form id="user_edit" method="post">\n            <input id="avatar_id" type="hidden" name="avatar[id]" value="{{avatar.id}}"/>\n            <div id="general"></div>\n            <div id="location"></div>\n            <div id="school_work"></div>\n            <div id="social_network"></div>\n            <div class="operate">\n                <button class="update bt bt-blue-2 bt-size-normal" type="submit">SAVE ALL</button>\n                <button class="cancel bt bt-gray bt-size-normal" type="reset">CANCEL</button>\n            </div>\n        </form>\n    </div>\n</div>'}),define("views/user/edit-profile/main",["jquery","underscore","backbone","collections/languages","collections/countries","collections/timezones","modules/zip-code-number","modules/country","modules/city","views/common/select","views/user/edit-profile/main/other-language-item","views/user/edit-profile/main/zip-code-item","views/user/edit-profile/main/school-history-item","views/user/edit-profile/main/work-history-item","views/user/edit-profile/main/general","views/user/edit-profile/main/location","views/user/edit-profile/main/school-work","views/user/edit-profile/main/social-network","views/user/common/visible-settings","tools/regs","tools/pop-up-window","controller","text!templates/user/edit-profile/main.html","jquerySerializeObject"],function(e,t,n,i,o,r,a,s,l,c,d,u,m,h,p,f,v,_,g,b,y,w,x){var k=y.get("function");return n.View.extend({className:"content-web content-fixed-width",template:x,serialize:function(){return this.model.toJSON()},events:{"submit form":"save","keypress form":"stopEnterSubmitForm","click #add_other_lang_item":"addOtherLangItem","change .current_location_radio":"changeLocation","click #check_zip_code":"checkZipCode","blur #zip_code":"checkZipCode","keypress #zip_code":"enterCheckZipCode","keypress #school_name":"enterAddSchool","keypress #school_web":"enterAddSchool","click #add_school_history_btn":"addSchoolHistoryBtn","click #add_work_history_btn":"addWorkHistoryBtn","keypress #work_company_name":"enterAddWork","keypress #work_title":"enterAddWork","change .profile_position":"changePosition","change #birthday_month":"changeBirthday","change #birthday_date":"changeBirthday","change #birthday_year":"changeBirthday","change #country_id":"changeOtherCountryToCity","change #current_city_id":"showInputNewCity","click #create_city_btn":"createCity","click #school_position":"changeSchoolPosition","click #current_city_id":"changeCity","mouseover .target_select":"coverSelect","click .cover_layer":"fetchSelectData","click .cancel":"cancel"},beforeRender:function(){var e=this;this.setViews({"#general":new p({model:e.model}),"#location":new f({model:e.model}),"#school_work":new v({model:e.model}),"#social_network":new _({model:e.model})})},afterRender:function(){var n=this.model.get("profile");this.$("#gender").find('option[value="'+this.model.get("profile").gender+'"]').prop("selected",!0),this.$("#birthday_date").append(this.getBirthdayOption(1,31)),this.$("#birthday_year").append(this.getBirthdayOption(2013,1900)),n.birthday&&(this.$("#birthday_month").find('option[value="'+new Date(1e3*parseInt(n.birthday)).format("m")+'"]').prop("selected",!0),this.$("#birthday_date").find('option[value="'+new Date(1e3*parseInt(n.birthday)).format("d")+'"]').prop("selected",!0),this.$("#birthday_year").find('option[value="'+new Date(1e3*parseInt(n.birthday)).format("yyyy")+'"]').prop("selected",!0));var i=this.model.get("profile").other_languages;if(e(i).length>0)for(var o in i){var r={lang_name:i[o],lang_id:o};this.addOtherLangItem(r)}if(t.isUndefined(this.model.get("profile").zip_code)||""!=this.model.get("profile").zip_code||this.$('.current_location_radio[value="other"]').click(),t.isUndefined(this.model.get("profile").position.position)||(this.$('.profile_position[value="'+this.model.get("profile").position.position+'"]').click(),this.$("#school_position_type_"+this.model.get("profile").position.position).find('option[value="'+this.model.get("profile").position.type+'"]').prop("selected",!0)),!t.isUndefined(this.model.get("display_first_schools"))){var a=this.model.get("display_first_schools").type;a&&a.length>0&&this.$("#school_position").find('option[value="'+a+'"]').prop("selected",!0)}var s=this.model.get("profile").schools;if(s.length>0)for(var l in s)this.addSchoolHistoryBtn(s[l]);var c=this.$("#school_position");e.trim(c.val()).length>0&&c.parent().find("*[_name]").each(function(){var t=e(this).attr("_name");e(this).attr("name",t),e(this).removeAttr("_name")});var d=this.model.get("profile").works;if(d.length>0)for(var l in d)this.addWorkHistoryBtn(d[l]);var u=this.model.get("visible_settings");if(!t.isUndefined(u))for(var l in u)this.$("#auth_group_"+l).html(new g({attrs:{name:"visible_settings["+l+"]",value:u[l]}}).render().view.el);e(document).on("blur",".school_web",function(){var t=e.trim(e(this).val());return t.length&&!b.rules("url").test(t)?(e(this).val(""),k.alert("Please enter correct url address"),!1):void 0})},cancel:function(){w.go("user")},fetchSelectData:function(t){var n=this,a=e(t.currentTarget).data("targetObj"),s="";"origin_country_id"===a.attr("id")||"country_id"===a.attr("id")?s=o:"primary_language"===a.attr("id")||"other_language"===a.attr("id")?s=i:"time_zone_id"===a.attr("id")&&(s=r),s&&this.fetchSelectView(a,{collections:s,id:a.attr("id"),name:a.attr("name"),value:n.model.get("profile")[a.attr("id")],wrap:"#"+a.parent().attr("id")})},coverSelect:function(t){var n=e(t.currentTarget),i=n.parent();if(3>n.children().length&&0==i.find(".cover_layer").length){var o=e("<div>").css({width:450,height:31,position:"absolute",top:0,left:0,"z-index":2}),r=e("<iframe>").css({width:450,height:31,position:"absolute",top:0,left:0,display:"block"}).attr({frameborder:0,scrolling:"no",allowtransparency:!0});i.css({position:"relative"}),o.attr("class","cover_layer"),o.data({targetObj:n}),i.prepend(r),i.prepend(o)}},changeCity:function(t){var n=e.trim(this.$("#country_id").find("option:selected").val());return n?e(t.currentTarget).children().length>1?!1:(this.changeOtherCountryToCity(n),void 0):(k.alert("Please select Country."),!1)},fetchSelectView:function(t,n){if(t.attr("locked"))return!1;if(3>t.children().length){t.attr("locked","locked");var i=this,o={collections:"",id:"",name:"",value:"",wrap:""};o=e.extend(!0,{},o,n),t.html(""),t.html('<option "selected"="selected">loading...</option>');var r=new c({collections:o.collections,attrs:{id:o.id,name:o.name,value:o.value}});o.collections.addUrlParam({limit:999}),o.collections.fetch({resultTrue:function(){setTimeout(function(){i.$(o.wrap).html(r.render().view.el)},1e3)},completeCallback:function(){t.removeAttr("locked")}})}},changeSchoolPosition:function(t){var n=e(t.currentTarget);e.trim(e(t.currentTarget).val())?n.parent().find("*[_name]").each(function(){var t=e(this).attr("_name");e(this).attr("name",t),e(this).removeAttr("_name")}):n.parent().find("*[name]").each(function(){var t=e(this).attr("name");e(this).attr("_name",t),e(this).removeAttr("name")})},checkData:function(e){return t.isUndefined(e.profile)?!1:e.profile.website.length>0&&!b.check("url",e.profile.website)?(k.alert("Please input correct Personal Website"),!1):!0},stopEnterSubmitForm:function(e){return 13!==e.keyCode},save:function(n){if(e(n.currentTarget).attr("locked"))return!1;if(e(n.currentTarget).attr("locked","locked"),!e.trim(this.$('[name="profile[country_id]"]').val()))return e(n.currentTarget).removeAttr("locked"),k.alert("Please enter correct USA Zip Code or select Other Country."),!1;var i=this,o=i.$("#user_edit *[name]").serializeObject();return i.checkData(o)?(i.model.unset("id"),i.model.set(o),i.model.save({},{resultTrue:function(){w.go("user")},resultFalse:function(e){t.each(e,function(e){k.alert(e)})},completeCallback:function(){e(n.currentTarget).removeAttr("locked")}}),!1):(e(n.currentTarget).removeAttr("locked"),!1)},createCity:function(){var t=this,n=e.trim(this.$("#new_city").val()),i=this.$("#country_id").val();if(n.length>0&&i.length>0){var o=new l,r={country_id:i,name:n};o.save(r,{resultTrue:function(e,i){var o='<option value="'+i.data.id+'" selected="selected">'+n+"</option>";t.$("#current_city_id").prepend(o),k.alert("Create city successfully.")}})}return!1},showInputNewCity:function(t){var n=this.$(t.currentTarget);"end"===n.val()?this.$("#input_new_city").show("fast"):this.$("#input_new_city").hide("fast",function(){e(this).find("#new_city").val("")})},changeOtherCountryToCity:function(t){if(e(t.currentTarget).attr("locked"))return!1;var n=this,i=n.$("#current_city_id"),o="object"===e.type(t)?this.$(t.currentTarget).find("option:selected").val():t;if(o.length>0){e(t.currentTarget).attr("locked","locked"),i.prepend('<option "selected"="selected">loading...</option>');var r=new s({id:o});r.addUrlParam({with_country_city:1}),r.fetch({resultTrue:function(e,t){var o=t.data.cities,r="";i.html("");var a='<option value="end">My City is not Listed</option>';if(o.length>0){for(var s in o)r+='<option value="'+o[s].id+'">'+o[s].name+"</option>";i.append(r),n.$("#input_new_city").hide("fast")}else n.$("#input_new_city").show("fast");i.append(a)},completeCallback:function(){e(t.currentTarget).removeAttr("locked")}})}},changeBirthday:function(){var t=e.trim(this.$("#birthday_month").val()),n=e.trim(this.$("#birthday_date").val()),i=e.trim(this.$("#birthday_year").val());if(!t||!n||!i)return this.$("#birthday_time").val(""),!1;t=2>t.length?"0"+t:t,n=2>n.length?"0"+n:n;var o=t+"/"+n+"/"+i;this.$("#birthday_time").val((new Date).strtotime(o))},changePosition:function(t){var n=this,i=this.$(t.currentTarget),o=this.$(".profile_position_other"),r=this.$("#school_position_type_student"),a=this.$("#school_position_type_instructor"),s=this.$(".school_type");"other"===i.val()?(s.hide("fast",function(){n.changeChildrenAttr(e(this),"name","_name")}),o.show("fast",function(){n.changeChildrenAttr(e(this),"_name","name")})):(o.hide("fast",function(){n.changeChildrenAttr(e(this),"name","_name")}),s.show("fast",function(){n.changeChildrenAttr(e(this),"_name","name"),"student"===i.val()?(a.hide("fast",function(){n.changeAttr(e(this),"name","_name")}),r.show("fast",function(){n.changeAttr(e(this),"_name","name")})):"instructor"===i.val()&&(r.hide("fast",function(){n.changeAttr(e(this),"name","_name")}),a.show("fast",function(){n.changeAttr(e(this),"_name","name")}))}))},addWorkHistoryBtn:function(t){var n=this.$("#work_history_wrap"),i=this.$("#work_company_name"),o=this.$("#work_title"),r={parent:n,company:e.trim(i.val()),position:e.trim(o.val())};r=e.extend(!0,{},r,t);var a=new h({data:r});n.append(a.render().view.el),i.val(""),o.val("")},enterAddWork:function(e){13===e.keyCode&&this.addWorkHistoryBtn()},addSchoolHistoryBtn:function(t){var n=this.$("#school_history_wrap"),i=this.$("#school_position"),o=this.$("#school_name"),r=this.$("#school_web"),a={parent:n,type:i.find("option:selected").val(),name:e.trim(o.val()),web_address:e.trim(r.val())};t&&t.name&&(a=e.extend(!0,{},a,t));var s=new m({data:a});n.append(s.render().view.el),o.val(""),r.val(""),i.val("")},enterAddSchool:function(e){13===e.keyCode&&this.addSchoolHistoryBtn()},enterCheckZipCode:function(e){13===e.keyCode&&this.checkZipCode()},checkZipCode:function(){var t=this,n=e.trim(this.$("#zip_code").val()),i=/\d+/;if(i.test(n)){var o=new a({id:n});o.addUrlParam({with_zip_code_country:1}),o.fetch({resultTrue:function(e){t.$('[name="profile[zip_code]"]').val(e.get("zip_code")),t.$(".zip_code_wrap").empty().append(new u({model:e}).render().view.el)},resultFalse:function(){t.$(".zip_code_wrap").empty().append('<span style="color:red;">Zip Code does not exist.</span>')}})}},addOtherLangItem:function(t){var n=this.$("#other_language"),i=e.trim(n.val()),o=e.trim(n.find("option:selected").html()),r={lang_name:o,lang_id:i};if(r=e.extend(!0,{},r,t),r.lang_id.length>0&&r.lang_name.length>0){var a=new d({data:r});this.$(".join_other_language_wrap").append(a.render().view.el)}},changeLocation:function(t){var n=this,i=this.$(t.currentTarget),o=this.$(".other_country"),r=this.$(".usa_country"),a=e.trim(i.val()),s=this.$('[name="profile[zip_code]"]'),l=this.$("#zip_code"),c=this.$(".zip_code_wrap");"other"===a?(r.hide("fast",function(){n.changeChildrenAttr(e(this),"name","_name"),o.show("fast",function(){n.changeChildrenAttr(e(this),"_name","name")})}),s.val(""),l.val(""),c.html("")):"usa"===a&&o.hide("fast",function(){n.changeChildrenAttr(e(this),"name","_name"),r.show("fast",function(){n.changeChildrenAttr(e(this),"_name","name")})})},changeChildrenAttr:function(t,n,i){if("object"===e.type(t)){var o=e(t).find("*["+n+"]");o.each(function(){e(this).attr(""+i,e(this).attr(""+n)),e(this).removeAttr(""+n)})}},changeAttr:function(t,n,i){if("object"===e.type(t)){var o=e(t);o.attr(""+i,o.attr(""+n)),o.removeAttr(""+n)}},getArray:function(e,t){for(var n=[],i=e;t>=i;i++)n[i]=i;return n},getBirthdayOption:function(e,t){var n="";if(t>e)for(var i=e;t>=i;i++)n+='<option value="'+i+'">'+i+"</option>";else for(var i=e;i>=t;i--)n+='<option value="'+i+'">'+i+"</option>";return n}})}),define("views/user/edit-profile/index",["views/layout/home","views/user/edit-profile/sidebar","views/user/edit-profile/main","modules/me"],function(e,t,n,i){return function(){var o=new i;o.setDefaults(),e.setViews({"#block_sidebar":new t({model:o}),"#block_content":new n({model:o})}).render()}});